!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="9ab35f50-2f52-4c88-b307-0768b7f19dad",e._sentryDebugIdIdentifier="sentry-dbid-9ab35f50-2f52-4c88-b307-0768b7f19dad")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5750],{10585:(e,t,s)=>{s.d(t,{A:()=>r});var a=s(80263),n=s(55866);let r=e=>{let{resourceText:t,isFullPage:s=!1}=e,r=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(n.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",t]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return s?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(r,{})})}):(0,a.jsx)(r,{})}},16826:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(23983).A)("Ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]])},34048:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(23983).A)("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},42159:(e,t,s)=>{s.d(t,{D:()=>o});var a=s(56947),n=s(40807),r=s(57525);async function l(e,t){let{projectRef:s,type:a,name:r,limit:l=10}=e;if(void 0===s)throw Error("projectRef is required for getContent");let{data:o,error:i}=await (0,n.Jt)("/platform/projects/{ref}/content",{params:{path:{ref:s},query:{type:a,name:r,limit:l.toString()}},signal:t});return i&&(0,n.H4)(i),{cursor:o.cursor,content:o.data}}let o=function(e){let{projectRef:t,type:s,name:n,limit:o}=e,{enabled:i=!0,...c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(r.M.list(t,{type:s,name:n,limit:o}),e=>{let{signal:a}=e;return l({projectRef:t,type:s,name:n,limit:o},a)},{enabled:i&&void 0!==t,...c})}},44016:(e,t,s)=>{s.d(t,{u:()=>i});var a=s(56947),n=s(40807),r=s(64036),l=s(61642);async function o(e,t){let{projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:a,error:r}=await (0,n.Jt)("/platform/projects/{ref}/analytics/warehouse/collections",{params:{path:{ref:s}},signal:t});return r&&(0,n.H4)(r),a}let i=function(e){let{projectRef:t}=e,{enabled:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{enabled:!0};return(0,a.I)(l.P.warehouseCollections(t),e=>{let{signal:s}=e;return o({projectRef:t},s)},{enabled:s&&!!t&&r.pe})}},61298:(e,t,s)=>{s.d(t,{A:()=>a});let a=(0,s(23983).A)("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]])},61642:(e,t,s)=>{s.d(t,{P:()=>a});let a={warehouseQuery:(e,t)=>["projects",e,"warehouse","query",t],warehouseTenant:e=>["projects",e,"warehouse","tenant"],warehouseCollections:e=>["projects",e,"warehouse","collections"],warehouseCollectionsCreate:e=>["projects",e,"warehouse","collections","create"],warehouseEndpoints:e=>["projects",e,"warehouse","endpoints"],warehouseBackends:e=>["projects",e,"warehouse","backends"],warehouseAccessTokens:e=>["projects",e,"warehouse","access-tokens"],functionsInvStats:(e,t)=>{let{interval:s,functionId:a}=t;return["projects",e,"functions-inv-stats",{interval:s,functionId:a}]},functionsReqStats:(e,t)=>{let{interval:s,functionId:a}=t;return["projects",e,"functions-req-stats",{interval:s,functionId:a}]},functionsResourceUsage:(e,t)=>{let{interval:s,functionId:a}=t;return["projects",e,"functions-resource-usage",{interval:s,functionId:a}]},orgDailyComputeStats:(e,t)=>{let{startDate:s,endDate:a,projectRef:r}=t;return["organizations",e,"daily-stats-compute",{startDate:n(s),endDate:n(a),projectRef:r}]},orgDailyStats:(e,t)=>{let{metric:s,startDate:a,endDate:r,interval:l,projectRef:o}=t;return["organizations",e,"daily-stats",{metric:s,startDate:n(a),endDate:n(r),interval:l,projectRef:o}]},infraMonitoring:(e,t)=>{let{attribute:s,startDate:a,endDate:n,interval:r,databaseIdentifier:l}=t;return["projects",e,"infra-monitoring",{attribute:s,startDate:a,endDate:n,interval:r,databaseIdentifier:l}]},usageApiCounts:(e,t)=>["projects",e,"usage.api-counts",t],usageApiRequestsCount:e=>["projects",e,"usage.api-requests-count"]};function n(e){return e?e.split("T")[0]:e}},64540:(e,t,s)=>{s.d(t,{A:()=>d});var a=s(80263),n=s(53239),r=s(82758),l=s(51859),o=s(71126),i=s(10406);let c=(0,n.forwardRef)((e,t)=>{let{title:s,description:c,size:d="small",visible:u,onCancel:m,onConfirm:p,loading:h,cancelLabel:x="Cancel",confirmLabel:g="Submit",confirmLabelLoading:y,alert:f,children:j,variant:v="default",disabled:b,...C}=e,[S,w]=(0,n.useState)(void 0!==h&&h);return(0,n.useEffect)(()=>{u&&void 0===h&&w(!1)},[u]),(0,n.useEffect)(()=>{void 0!==h&&w(h)},[h]),(0,a.jsx)(r.lG,{open:u,...C,onOpenChange:()=>{u&&m()},children:(0,a.jsxs)(r.Cf,{ref:t,className:"p-0 gap-0 pb-5 !block",size:d,children:[(0,a.jsxs)(r.c7,{className:(0,l.cn)("border-b"),padding:"small",children:[(0,a.jsx)(r.L3,{children:s}),c&&(0,a.jsx)(r.rr,{children:c})]}),f&&(0,a.jsx)(i.Z,{type:v,label:f.title,description:f.description,className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0",...null==f?void 0:f.base}),j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.OO,{padding:"small",children:j}),(0,a.jsx)(r.pf,{})]}),(0,a.jsxs)("div",{className:"flex gap-2 px-5 pt-5",children:[(0,a.jsx)(o.$,{size:"medium",block:!0,type:"default",disabled:S,onClick:()=>m(),children:x}),(0,a.jsx)(o.$,{block:!0,size:"medium",type:"destructive"===v?"danger":"warning"===v?"warning":"primary",htmlType:"submit",loading:S,disabled:S||b,onClick:e=>{e.preventDefault(),e.stopPropagation(),p(),void 0===h&&w(!0)},className:"truncate",children:g})]})]})})});c.displayName="ConfirmationModal";let d=c},64978:(e,t,s)=>{s.d(t,{$:()=>c});var a=s(32144),n=s(80251),r=s(73969),l=s(40807),o=s(57525);async function i(e,t){let{projectRef:s,ids:a}=e,{data:n,error:r}=await (0,l.yH)("/platform/projects/{ref}/content",{headers:{Version:"2"},params:{path:{ref:s},query:{ids:a}},signal:t});return r&&(0,l.H4)(r),n.map(e=>e.id)}let c=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=(0,a.jE)();return(0,n.n)(e=>i(e),{async onSuccess(t,s,a){let{projectRef:n}=s;await l.invalidateQueries(o.M.allContentLists(n)),await (null==e?void 0:e(t,s,a))},async onError(e,s,a){void 0===t?r.oR.error("Failed to delete contents: ".concat(e.message)):t(e,s,a)},...s})}},66586:(e,t,s)=>{s.d(t,{A:()=>i});var a=s(80263),n=s(53239),r=s(64938),l=s(3891);function o(e,t){if(!t.error)return delete e[t.key],e;if(t)return{...e,[t.key]:t.error};throw Error()}function i(e){let{validate:t,...s}=e,[i,c]=(0,n.useReducer)(o,null),d=(0,r.Wx)({validateOnBlur:!0,...s,validationSchema:s.validationSchema,initialValues:s.initialValues,onSubmit:s.onSubmit,validate:t||function(){return i}});return(0,a.jsx)("form",{id:s.id,name:s.name,onSubmit:d.handleSubmit,className:s.className,style:s.style,method:"POST","data-sentry-component":"Form","data-sentry-source-file":"Form.tsx",children:(0,a.jsx)(l.h,{values:d.values,errors:d.errors,formContextOnChange:d.handleChange,handleBlur:d.handleBlur,touched:d.touched,fieldLevelValidation:function(e,t){c({key:e,error:t})},"data-sentry-element":"FormContextProvider","data-sentry-source-file":"Form.tsx",children:s.children({errors:d.errors,touched:d.touched,isSubmitting:d.isSubmitting,isValidating:d.isValidating,submitCount:d.submitCount,initialValues:d.initialValues,values:d.values,handleReset:d.handleReset,resetForm:d.resetForm,setFieldValue:d.setFieldValue})})})}},71263:(e,t,s)=>{s.d(t,{A:()=>b});var a=s(80263),n=s(47504),r=s(53239),l=s(73969),o=s(19898),i=s(64978),c=s(85586),d=s(74115),u=s(64540),m=s(67920),p=s(66586),h=s(16988),x=s(71126);let g=e=>{let{visible:t,onCancel:s,onSubmit:n,initialValues:r}=e;return(0,a.jsx)(m.A,{visible:t,onCancel:s,hideFooter:!0,header:"Update saved query",size:"medium","data-sentry-element":"Modal","data-sentry-component":"UpdateSavedQueryModal","data-sentry-source-file":"Logs.UpdateSavedQueryModal.tsx",children:(0,a.jsx)(p.A,{onReset:s,validateOnBlur:!0,initialValues:r,validate:function(e){let t={};return e.name||(t.name="Required"),t},onSubmit:n,"data-sentry-element":"Form","data-sentry-source-file":"Logs.UpdateSavedQueryModal.tsx",children:e=>{let{isSubmitting:t}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.A.Content,{children:(0,a.jsx)(h.A,{label:"Name",id:"name",name:"name"})}),(0,a.jsx)(m.A.Content,{children:(0,a.jsx)(h.A.TextArea,{label:"Description",id:"description",placeholder:"Describe query",size:"medium",textAreaClassName:"resize-none"})}),(0,a.jsx)(m.A.Separator,{}),(0,a.jsxs)(m.A.Content,{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)(x.$,{htmlType:"reset",type:"default",onClick:s,disabled:t,children:"Cancel"}),(0,a.jsx)(x.$,{htmlType:"submit",loading:t,disabled:t,children:"Save query"})]})]})}})})};var y=s(15576),f=s(28097),j=s(57210),v=s(92511);let b=e=>{let{item:t}=e,s=(0,n.useRouter)(),{ref:m}=(0,o.g)(),[p,h]=(0,r.useState)(!1),[x,b]=(0,r.useState)(!1),{mutate:C}=(0,i.$)({onSuccess:()=>{h(!1),l.oR.success("Successfully deleted query")},onError:e=>{l.oR.error("Failed to delete saved query: ".concat(e.message))}}),{mutate:S}=(0,c.v)({onSuccess:()=>{b(!1),l.oR.success("Successfully updated query")},onError:e=>{l.oR.error("Failed to update query: ".concat(e.message))}}),w=async()=>{if(!m||"string"!=typeof m)return console.error("Invalid project reference");C({projectRef:m,ids:[t.id]})},k=async e=>{let{name:s,description:a}=e;if(!m||"string"!=typeof m)return console.error("Invalid project reference");S({projectRef:m,payload:{...t,name:s,description:a||void 0,type:"log_sql",visibility:"user"}})},A=s.query.queryId===t.id;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.T,{label:t.name,icon:(0,a.jsx)(j.mx,{size:"15"}),href:"/project/".concat(m,"/logs/explorer?queryId=").concat(encodeURIComponent(t.id),"&q=").concat(encodeURIComponent(t.content.sql)),isActive:A,dropdownItems:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(d._2,{onClick:()=>b(!0),children:[(0,a.jsx)(y.A,{size:14,className:"mr-2"}),"Edit query"]}),(0,a.jsx)(d.mB,{}),(0,a.jsxs)(d._2,{onClick:()=>{h(!0)},children:[(0,a.jsx)(f.A,{size:14,className:"mr-2"}),"Delete query"]})]}),"data-sentry-element":"LogsSidebarItem","data-sentry-source-file":"Logs.SavedQueriesItem.tsx"}),(0,a.jsx)(u.A,{variant:"destructive",visible:p,confirmLabel:"Delete query",title:"Confirm to delete saved query",onCancel:()=>{h(!1)},onConfirm:w,"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"Logs.SavedQueriesItem.tsx",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to delete ",t.name,"?"]})}),(0,a.jsx)(g,{visible:x,initialValues:{name:t.name,description:t.description},onCancel:()=>{b(!1)},onSubmit:e=>{k(e)},"data-sentry-element":"UpdateSavedQueryModal","data-sentry-source-file":"Logs.SavedQueriesItem.tsx"})]})}},77525:(e,t,s)=>{s.d(t,{c:()=>n});var a=s(34969);function n(){let e=(0,a.a)();return e?{plan:null==e?void 0:e.plan,usageBillingEnabled:null==e?void 0:e.usage_billing_enabled,isLoading:!1,isSuccess:!0}:{plan:null,usageBillingEnabled:null,isLoading:!0,isSuccess:!1}}},85750:(e,t,s)=>{s.d(t,{A:()=>em});var a=s(80263),n=s(60045),r=s(47504),l=s(53239),o=s(19898),i=s(10585),c=s(77227),d=s(95319),u=s(80207),m=s(30651),p=s(66915),h=s(66345),x=s(61298),g=s(59153),y=s.n(g),f=s(73969),j=s(32144),v=s(80251),b=s(40807),C=s(61642);async function S(e){let{projectRef:t,name:s,retention_days:a}=e,{data:n,error:r}=await (0,b.bE)("/platform/projects/{ref}/analytics/warehouse/collections",{params:{path:{ref:t}},body:{name:s,retention_days:a}});return r&&(0,b.H4)(r),n}let w=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,j.jE)();return(0,v.n)(e=>{var t;let s=null==(t=a.getQueryData(C.P.warehouseCollections(e.projectRef)))?void 0:t.map(e=>e.name);if(null==s?void 0:s.includes(e.name))throw Error("Collection with the name ".concat(e.name," already exists"));return S(e)},{async onSuccess(t,s,n){let{projectRef:r}=s;await a.invalidateQueries(C.P.warehouseCollections(r)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?f.oR.error("Failed to create collection: ".concat(e.message)):t(e,s,a)},...s})};var k=s(67920),A=s(32981),N=s(87494),L=s(39353),_=s(57980),M=s(24794),F=s(71126),R=s(84377),I=s(77525),V=s(10406),E=s(34969);let q=e=>{let{initialValues:t,onSubmit:s,isLoading:n,onCancelClick:l}=e,{plan:o,isLoading:i}=(0,I.c)(),c=(0,r.useRouter)(),d=(0,E.a)(),u=i?1:(null==o?void 0:o.id)==="free"?3:90,m=L.z.object({name:L.z.string().min(1),retention_days:L.z.coerce.number().min(1).max(u).multipleOf(1).positive().int()}),p=(0,N.mN)({resolver:(0,A.u)(m),defaultValues:{name:(null==t?void 0:t.name)||"",retention_days:(null==t?void 0:t.retention_days)||u}}),h=p.handleSubmit(s),x=e=>1===e?"1 day":"".concat(e," days"),g=e=>!e||e<1?(0,a.jsxs)(a.Fragment,{children:["Your plan allows for a maximum of ",x(u),"."]}):(0,a.jsxs)(a.Fragment,{children:["Your logs will be removed after ",x(e),". ",(0,a.jsx)("br",{}),"Your plan allows for a maximum of ",x(u),"."]});return(0,a.jsx)(_.lV,{...p,"data-sentry-element":"Form_Shadcn_","data-sentry-component":"CollectionForm","data-sentry-source-file":"CollectionForm.tsx",children:(0,a.jsxs)("form",{onSubmit:h,children:[(0,a.jsxs)(k.A.Content,{className:"space-y-3","data-sentry-element":"unknown","data-sentry-source-file":"CollectionForm.tsx",children:[(0,a.jsx)(_.zB,{control:p.control,name:"name",render:e=>{let{field:t}=e;return(0,a.jsx)(R.M,{label:"Collection name",layout:"horizontal",children:(0,a.jsx)(_.MJ,{children:(0,a.jsx)(M.p,{autoFocus:!0,placeholder:"Events",...t})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CollectionForm.tsx"}),(0,a.jsx)(_.zB,{control:p.control,name:"retention_days",render:e=>{let{field:t}=e;return(0,a.jsx)(R.M,{label:"Retention",layout:"horizontal",description:g(Number(t.value)),children:(0,a.jsx)(_.MJ,{children:(0,a.jsxs)("div",{className:"relative flex items-center gap-2",children:[(0,a.jsx)(M.p,{type:"number",...t}),(0,a.jsx)("span",{className:"absolute right-3 text-foreground-lighter text-sm pointer-events-none",children:"days"})]})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CollectionForm.tsx"})]}),(null==o?void 0:o.id)==="free"&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.A.Separator,{}),(0,a.jsx)(V.Z,{className:"border-none bg-transparent",type:"default",title:"Upgrade your plan to increase retention",description:(0,a.jsxs)("div",{children:["Upgrade to the pro plan to increase retention to 90 days.",(0,a.jsx)(F.$,{className:"mt-2",type:"primary",onClick:()=>c.push("/org/".concat(null==d?void 0:d.slug,"/billing?panel=subscriptionPlan&source=dataWarehouseIncreaseRetention")),children:"Upgrade plan"})]})})]}),(0,a.jsx)(_.C5,{"data-sentry-element":"FormMessage_Shadcn_","data-sentry-source-file":"CollectionForm.tsx"}),(0,a.jsxs)(k.A.Content,{className:"py-4 border-t flex items-center justify-end gap-2","data-sentry-element":"unknown","data-sentry-source-file":"CollectionForm.tsx",children:[(0,a.jsx)(F.$,{size:"tiny",type:"default",onClick:l,"data-sentry-element":"Button","data-sentry-source-file":"CollectionForm.tsx",children:"Cancel"}),(0,a.jsx)(F.$,{size:"tiny",loading:n,disabled:n,htmlType:"submit","data-sentry-element":"Button","data-sentry-source-file":"CollectionForm.tsx",children:"Create collection"})]})]})})},z=e=>{let{open:t,onOpenChange:s}=e,n=(0,r.useRouter)(),{ref:l}=(0,o.g)(),{mutate:i,isLoading:c}=w({onSuccess:e=>{s(!1),f.oR.success("Collection created successfully"),n.push("/project/".concat(l,"/logs/collections/").concat(e.token))},onError:e=>{f.oR.error(e.message)}});return(0,a.jsx)(k.A,{size:"medium",onCancel:()=>s(!1),header:"Create collection",visible:t,hideFooter:!0,"data-sentry-element":"Modal","data-sentry-component":"CreateWarehouseCollectionModal","data-sentry-source-file":"CreateWarehouseCollection.tsx",children:(0,a.jsx)(q,{onCancelClick:()=>s(!1),isLoading:c,onSubmit:e=>{l&&i({projectRef:l,name:e.name,retention_days:e.retention_days})},"data-sentry-element":"CollectionForm","data-sentry-source-file":"CreateWarehouseCollection.tsx"})})};var T=s(34048),D=s(15576),P=s(28097);async function Q(e){let{projectRef:t,collectionToken:s}=e,{data:a,error:n}=await (0,b.yH)("/platform/projects/{ref}/analytics/warehouse/collections/{token}",{params:{path:{ref:t,token:s}}});return n&&(0,b.H4)(n),a}let B=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,j.jE)();return(0,v.n)(e=>Q(e),{async onSuccess(t,s,n){let{projectRef:r}=s;await a.invalidateQueries(C.P.warehouseCollections(r)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?f.oR.error("Failed to delete collection: ".concat(e.message)):t(e,s,a)},...s})};async function $(e,t){let{projectRef:s,collectionToken:a}=e,{data:n,error:r}=await (0,b.F6)("/platform/projects/{ref}/analytics/warehouse/collections/{token}",{params:{path:{ref:s,token:a}},body:t});return r&&(0,b.H4)(r),n}let O=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,j.jE)();return(0,v.n)(e=>$({projectRef:e.projectRef,collectionToken:e.collectionToken},{name:e.name,retention_days:e.retention_days}),{async onSuccess(t,s,n){let{projectRef:r}=s;await a.invalidateQueries(C.P.warehouseCollections(r)),await (null==e?void 0:e(t,s,n))},async onError(e,s,a){void 0===t?f.oR.error("Failed to update collection: ".concat(e.message)):t(e,s,a)},...s})};var U=s(16632),H=s(74115),W=s(64540),Y=s(92511);let Z=e=>{let{item:t}=e,s=(0,r.useRouter)(),{ref:i,collectionToken:d}=(0,o.g)(),u=i||"default",[m,p]=(0,l.useState)(!1),[h,x]=(0,l.useState)(!1),g=(0,c.SE)(n.aG.ANALYTICS_WRITE,"logflare"),y=O({onSuccess:()=>{f.oR.success("Collection updated successfully"),p(!1)}}),j=B({onSuccess:()=>{t.token===d&&s.push("/project/".concat(u,"/logs/explorer")),x(!1),f.oR.success("Collection deleted successfully")}}),v=y.isLoading||j.isLoading;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Y.T,{isActive:t.token===d,label:t.name,icon:(0,a.jsx)(T.A,{size:"14",className:"text-foreground-light"}),href:"/project/".concat(u,"/logs/collections/").concat(t.token),dropdownItems:(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(U.m_,{children:[(0,a.jsx)(U.k$,{asChild:!0,children:(0,a.jsxs)(H._2,{disabled:!g,onClick:e=>{e.preventDefault(),p(!0)},children:[(0,a.jsx)(D.A,{className:"mr-2",size:14}),(0,a.jsx)("div",{children:"Update collection"})]})}),!g&&(0,a.jsx)(U.ZI,{side:"right",children:"You need additional permissions to update collections"})]}),(0,a.jsx)(H.mB,{}),(0,a.jsxs)(U.m_,{children:[(0,a.jsx)(U.k$,{asChild:!0,children:(0,a.jsxs)(H._2,{disabled:!g,onClick:e=>{e.preventDefault(),x(!0)},children:[(0,a.jsx)(P.A,{className:"mr-2",size:14}),(0,a.jsx)("div",{children:"Delete collection"})]})}),!g&&(0,a.jsx)(U.ZI,{side:"right",children:"You need additional permissions to delete collections"})]})]}),"data-sentry-element":"LogsSidebarItem","data-sentry-source-file":"WarehouseMenuItem.tsx"}),(0,a.jsx)(k.A,{size:"medium",visible:m,onCancel:()=>p(!1),hideFooter:!0,header:'Update collection "'.concat(t.name,'"'),"data-sentry-element":"Modal","data-sentry-source-file":"WarehouseMenuItem.tsx",children:(0,a.jsx)(q,{onCancelClick:()=>p(!1),isLoading:v,initialValues:{name:t.name,retention_days:t.retention_days},onSubmit:e=>{let{name:s,retention_days:a}=e;y.mutate({projectRef:u,collectionToken:t.token,name:s,retention_days:a})},"data-sentry-element":"CollectionForm","data-sentry-source-file":"WarehouseMenuItem.tsx"})}),(0,a.jsx)(W.A,{variant:"destructive",visible:h,onCancel:()=>x(!1),confirmLabel:"Delete collection",title:'Delete collection "'.concat(t.name,'"'),size:"small",onConfirm:()=>{j.mutate({projectRef:u,collectionToken:t.token})},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"WarehouseMenuItem.tsx",children:(0,a.jsxs)("p",{className:"text-sm text-foreground-light",children:["All data in this collection will be deleted.",(0,a.jsx)("br",{}),(0,a.jsx)("div",{className:"mt-2",children:"This action cannot be undone."})]})})]})};var G=s(71263),J=s(44016),K=s(56947),X=s(64036);async function ee(e,t){let{projectRef:s}=e;if(!s)throw Error("projectRef is required");let{data:a,error:n}=await (0,b.Jt)("/platform/projects/{ref}/analytics/warehouse/tenant",{params:{path:{ref:s}},signal:t});return n&&(0,b.H4)(n),a}let et=function(e){let{projectRef:t}=e,{enabled:s=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,K.I)(C.P.warehouseTenant(t),e=>{let{signal:s}=e;return ee({projectRef:t},s)},{enabled:s&&!!t&&X.pe,staleTime:1/0,cacheTime:72e5,refetchOnMount:!1,refetchInterval:!1,...a})};var es=s(42159),ea=s(38944),en=s(74725),er=s(71390),el=s(22979),eo=s(82937),ei=s(49655);let ec=e=>{let{className:t}=e;return(0,a.jsx)("svg",{stroke:"currentColor",fill:"currentColor",strokeWidth:"0",viewBox:"0 0 24 24",height:"15px",width:"15px",className:t,xmlns:"http://www.w3.org/2000/svg","data-sentry-element":"svg","data-sentry-component":"SupaIcon","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:(0,a.jsx)("path",{d:"M10.9997 2.59833V13.9694H3.90013C3.23055 13.9694 2.83063 13.1846 3.25654 12.6326L10.9997 2.59833ZM12.9997 8.03061V2.33296C12.9997 0.521514 10.7034 -0.291434 9.58194 1.16185L1.67316 11.4108C0.246185 13.26 1.54768 15.9694 3.90013 15.9694H10.9997V21.6671C10.9997 23.4785 13.296 24.2915 14.4175 22.8382L22.3262 12.5892C23.7532 10.74 22.4517 8.03061 20.0993 8.03061H12.9997ZM12.9997 10.0306H20.0993C20.7688 10.0306 21.1688 10.8155 20.7429 11.3674L12.9997 21.4017V10.0306Z","data-sentry-element":"path","data-sentry-source-file":"LogsSidebarMenuV2.tsx"})})};function ed(e){let{children:t,title:s,defaultOpen:n}=e;return(0,a.jsxs)(er.Nt,{defaultOpen:n,"data-sentry-element":"Collapsible_Shadcn_","data-sentry-component":"SidebarCollapsible","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:[(0,a.jsxs)(er.R6,{className:"flex items-center gap-x-2 px-4 [&[data-state=open]>svg]:!rotate-90 pb-2","data-sentry-element":"CollapsibleTrigger_Shadcn_","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:[(0,a.jsx)(p.A,{size:16,className:"text-foreground-light transition-transform duration-200","data-sentry-element":"ChevronRight","data-sentry-source-file":"LogsSidebarMenuV2.tsx"}),(0,a.jsx)("span",{className:"text-foreground-light font-mono text-sm uppercase",children:s})]}),(0,a.jsx)(er.Ke,{"data-sentry-element":"CollapsibleContent_Shadcn_","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:t})]})}function eu(){var e;let t=(0,r.useRouter)(),{ref:s}=(0,o.g)(),i=(0,en._)("warehouse"),[d,u]=(0,l.useState)(""),[m,p]=(0,l.useState)(!1),g=(0,c.SE)(n.aG.ANALYTICS_WRITE,"logflare"),{data:f}=et({projectRef:s}),{projectAuthAll:j,projectStorageAll:v,realtimeAll:b}=(0,ea.x)(["project_storage:all","project_auth:all","realtime:all"]),{data:C,isLoading:S}=(0,J.u)({projectRef:s},{enabled:o.pe&&i&&!!f}),{plan:w,isLoading:k}=(0,I.c)(),A=!k&&(null==w?void 0:w.id)==="free",{data:N,isLoading:L}=(0,es.D)({projectRef:s,type:"log_sql"}),_=[...null!=(e=null==N?void 0:N.content)?e:[]].filter(e=>"log_sql"===e.type).sort((e,t)=>e.name.localeCompare(t.name));function M(e){return t.asPath.includes(e)}let R=[{name:"API Gateway",key:"edge-logs",url:"/project/".concat(s,"/logs/edge-logs"),items:[]},{name:"Postgres",key:"postgres-logs",url:"/project/".concat(s,"/logs/postgres-logs"),items:[]},{name:"PostgREST",key:"postgrest-logs",url:"/project/".concat(s,"/logs/postgrest-logs"),items:[]},o.pe?{name:A?"Pooler":"Shared Pooler",key:"pooler-logs",url:"/project/".concat(s,"/logs/pooler-logs"),items:[]}:null,!A&&o.pe?{name:"Dedicated Pooler",key:"dedicated-pooler-logs",url:"/project/".concat(s,"/logs/dedicated-pooler-logs"),items:[]}:null,j?{name:"Auth",key:"auth-logs",url:"/project/".concat(s,"/logs/auth-logs"),items:[]}:null,v?{name:"Storage",key:"storage-logs",url:"/project/".concat(s,"/logs/storage-logs"),items:[]}:null,b?{name:"Realtime",key:"realtime-logs",url:"/project/".concat(s,"/logs/realtime-logs"),items:[]}:null,{name:"Edge Functions",key:"edge-functions-logs",url:"/project/".concat(s,"/logs/edge-functions-logs"),items:[]},{name:"Cron",key:"pg_cron",url:"/project/".concat(s,"/logs/pgcron-logs"),items:[]}].filter(e=>null!==e),V=o.pe?[{name:"Postgres Version Upgrade",key:"pg-upgrade-logs",url:"/project/".concat(s,"/logs/pg-upgrade-logs"),items:[]}]:[],E=R.filter(e=>null==e?void 0:e.name.toLowerCase().includes(d.toLowerCase())),q=V.filter(e=>null==e?void 0:e.name.toLowerCase().includes(d.toLowerCase())),T=null==C?void 0:C.filter(e=>e.name.toLowerCase().includes(d.toLowerCase()));return(0,a.jsxs)("div",{className:"pb-12 relative","data-sentry-component":"LogsSidebarMenuV2","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:[(0,a.jsxs)("div",{className:"flex gap-2 p-4 items-center sticky top-0 bg-background-200 z-[1]",children:[(0,a.jsx)(eo.a0,{className:"w-full p-0 gap-0","data-sentry-element":"InnerSideBarFilters","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:(0,a.jsx)(eo.RK,{name:"search-collections",placeholder:"Search collections...","aria-labelledby":"Search collections",value:d,onChange:e=>u(e.target.value),"data-sentry-element":"InnerSideBarFilterSearchInput","data-sentry-source-file":"LogsSidebarMenuV2.tsx"})}),i?(0,a.jsxs)(H.rI,{children:[(0,a.jsx)(H.ty,{asChild:!0,children:(0,a.jsx)(F.$,{type:"default",icon:(0,a.jsx)(h.A,{className:"text-foreground"}),className:"w-[26px]"})}),(0,a.jsxs)(H.SQ,{align:"end",className:"w-48",children:[(0,a.jsx)(H._2,{className:"gap-x-2",asChild:!0,children:(0,a.jsxs)(y(),{href:"/project/".concat(s,"/logs/explorer"),children:[(0,a.jsx)(x.A,{size:14}),"Create query"]})}),(0,a.jsxs)(U.m_,{children:[(0,a.jsx)(U.k$,{asChild:!0,children:(0,a.jsx)(H._2,{className:"gap-x-2",asChild:!0,children:(0,a.jsxs)("button",{onClick:()=>p(!0),className:"w-full flex items-center text-xs px-2 py-1",disabled:!g,children:[(0,a.jsx)(h.A,{size:14}),"Create collection"]})})}),!g&&(0,a.jsx)(U.ZI,{children:"You need additional permissions to create a collection"})]})]})]}):(0,a.jsx)(F.$,{type:"default",icon:(0,a.jsx)(h.A,{className:"text-foreground"}),className:"w-[26px]",onClick:()=>t.push("/project/".concat(s,"/logs/explorer"))}),(0,a.jsx)(z,{open:m,onOpenChange:p,"data-sentry-element":"CreateWarehouseCollectionModal","data-sentry-source-file":"LogsSidebarMenuV2.tsx"})]}),(0,a.jsx)("div",{className:"px-2",children:(0,a.jsx)(eo.ue,{title:"Templates",isActive:M("/project/".concat(s,"/logs/explorer/templates")),href:"/project/".concat(s,"/logs/explorer/templates"),"data-sentry-element":"InnerSideMenuItem","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:"Templates"})}),(0,a.jsx)(el.w,{className:"my-4","data-sentry-element":"Separator","data-sentry-source-file":"LogsSidebarMenuV2.tsx"}),(0,a.jsxs)(ed,{title:"Collections",defaultOpen:!0,"data-sentry-element":"SidebarCollapsible","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:[E.map(e=>{let t=M(e.url);return(0,a.jsx)(Y.T,{isActive:t,href:e.url,icon:(0,a.jsx)(ec,{className:"text-foreground-light"}),label:e.name},e.key)}),S&&i?(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(ei.y,{})}):(null==T?void 0:T.length)?(0,a.jsx)("div",{children:T.map(e=>(0,a.jsx)(Z,{item:e},e.token))}):null]}),V.length>0&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(el.w,{className:"my-4"}),(0,a.jsx)(ed,{title:"Database operations",defaultOpen:!0,children:q.map(e=>(0,a.jsx)(Y.T,{isActive:M(e.url),href:e.url,icon:(0,a.jsx)(ec,{className:"text-foreground-light"}),label:e.name},e.key))})]}),(0,a.jsx)(el.w,{className:"my-4","data-sentry-element":"Separator","data-sentry-source-file":"LogsSidebarMenuV2.tsx"}),(0,a.jsxs)(ed,{title:"Queries",defaultOpen:!0,"data-sentry-element":"SidebarCollapsible","data-sentry-source-file":"LogsSidebarMenuV2.tsx",children:[L&&(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)(ei.y,{})}),0===_.length&&(0,a.jsx)(eo.Q5,{className:"mx-4",title:"No queries created yet",description:"Create and save your queries to use them in the explorer",actions:(0,a.jsx)(F.$,{asChild:!0,type:"default",children:(0,a.jsx)(y(),{href:"/project/".concat(s,"/logs/explorer"),children:"Create query"})})}),_.map(e=>(0,a.jsx)(G.A,{item:e},e.id))]})]})}let em=(0,u.r)(e=>{let{title:t,children:s}=e,{isLoading:u,can:p}=(0,c.hl)(n.aG.ANALYTICS_READ,"logflare"),h=(0,r.useRouter)(),[x,g]=(0,d.U)(o.rS.LAST_VISITED_LOGS_PAGE,h.pathname.split("/logs/")[1]||"");if((0,l.useEffect)(()=>{if(h.pathname.includes("/logs/")){let e=h.pathname.split("/logs/")[1];e&&g(e)}},[h,g]),!p){if(u)return(0,a.jsx)(m.A,{isLoading:!0});if(!u&&!p)return(0,a.jsx)(m.A,{children:(0,a.jsx)(i.A,{isFullPage:!0,resourceText:"access your project's logs"})})}return(0,a.jsx)(m.A,{title:t,product:"Logs & Analytics",productMenu:(0,a.jsx)(eu,{}),"data-sentry-element":"ProjectLayout","data-sentry-component":"LogsLayout","data-sentry-source-file":"LogsLayout.tsx",children:s})})},92511:(e,t,s)=>{s.d(t,{T:()=>d});var a=s(80263),n=s(16826),r=s(59153),l=s.n(r),o=s(51859),i=s(74115),c=s(71126);function d(e){let{label:t,icon:s,dropdownItems:r,href:d,isActive:u,onClick:m}=e;return(0,a.jsxs)("div",{className:(0,o.cn)({"bg-foreground-lighter/10":u},"relative flex [&:has([data-state=open])]:bg-foreground-lighter/10 [&:has([data-state=open])]:text-foreground hover:text-foreground hover:bg-foreground-lighter/10 transition-all text-foreground-light group"),"data-sentry-component":"LogsSidebarItem","data-sentry-source-file":"SidebarItem.tsx",children:[(0,a.jsxs)(l(),{onClick:m,href:d,className:"h-7 flex-1 text-sm px-4 flex items-center gap-2 truncate","data-sentry-element":"Link","data-sentry-source-file":"SidebarItem.tsx",children:[(0,a.jsx)("span",{children:s}),(0,a.jsx)("span",{className:"truncate",children:t})]}),r&&(0,a.jsxs)(i.rI,{children:[(0,a.jsx)(i.ty,{asChild:!0,onClick:e=>{e.preventDefault()},children:(0,a.jsx)(c.$,{type:"text",title:"Actions",className:"space-x-0 h-7 px-1.5 opacity-0 group-hover:opacity-100 !bg-transparent data-[state=open]:opacity-100",icon:(0,a.jsx)(n.A,{size:14}),children:(0,a.jsx)("div",{className:"sr-only",children:"Actions"})})}),(0,a.jsx)(i.SQ,{className:"w-48",align:"end",children:r})]})]})}}}]);