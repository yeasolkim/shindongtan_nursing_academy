!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},s=(new e.Error).stack;s&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[s]="ece0b6b1-6104-4147-849d-5433f1225f4b",e._sentryDebugIdIdentifier="sentry-dbid-ece0b6b1-6104-4147-849d-5433f1225f4b")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3821,8426],{964:(e,s,t)=>{"use strict";t.r(s),t.d(s,{InspectorPage:()=>e4,default:()=>e3});var a=t(80263),n=t(60045),l=t(19898),r=t(53239),i=t(64652),o=t(3020),c=t(1230),d=t(41370),x=t(34969),m=t(32981),u=t(62659),h=t(87494),p=t(39353),f=t(23992),g=t(95793),y=t(71126),j=t(57980),b=t(24794),v=t(91378);let N=p.Ik({channel:p.Yj(),isPrivate:p.zM()}),w=e=>{let{config:s,onChangeConfig:t}=e,[n,o]=(0,r.useState)(!1),{ref:c}=(0,l.g)(),d=(0,x.a)(),{mutate:p}=(0,i.h)(),w=(0,h.mN)({mode:"onBlur",reValidateMode:"onBlur",resolver:(0,m.u)(N),defaultValues:{channel:"",isPrivate:!1}}),C=()=>{var e;o(!1),p({action:"realtime_inspector_listen_channel_clicked",groups:{project:null!=c?c:"Unknown",organization:null!=(e=null==d?void 0:d.slug)?e:"Unknown"}}),t({...s,channelName:w.getValues("channel"),isChannelPrivate:w.getValues("isPrivate"),enabled:!0})};return(0,a.jsxs)(g.AM,{open:n,onOpenChange:e=>{!0===e&&w.setValue("channel",s.channelName),o(e)},"data-sentry-element":"Popover_Shadcn_","data-sentry-component":"ChooseChannelPopover","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(g.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"index.tsx",children:(0,a.jsx)(y.$,{className:"rounded-r-none",type:"default",size:"tiny",iconRight:(0,a.jsx)(u.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:(0,a.jsx)("p",{className:"max-w-[120px] truncate",title:s.channelName.length>0?s.channelName:"",children:s.channelName.length>0?"Channel: ".concat(s.channelName):"Join a channel"})})}),(0,a.jsx)(g.hl,{portal:!0,className:"p-0 w-[320px]",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"index.tsx",children:(0,a.jsx)("div",{className:"p-4 flex flex-col text-sm",children:0===s.channelName.length?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(j.lV,{...w,children:(0,a.jsxs)("form",{id:"realtime-channel",onSubmit:w.handleSubmit(()=>C()),className:"flex flex-col gap-y-4",children:[(0,a.jsx)(j.zB,{name:"channel",control:w.control,render:e=>{let{field:s}=e;return(0,a.jsxs)(j.eI,{className:"flex flex-col gap-y-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-y-1",children:[(0,a.jsx)("label",{className:"text-foreground text-xs",children:"Name of channel"}),(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsx)(j.MJ,{children:(0,a.jsx)(b.p,{...s,autoComplete:"off",className:"rounded-r-none text-xs px-2.5 py-1 h-auto",placeholder:"Enter a channel name"})}),(0,a.jsx)(y.$,{type:"primary",className:"rounded-l-none",disabled:0===w.getValues().channel.length,onClick:()=>C(),children:"Listen to channel"})]})]}),(0,a.jsxs)(j.Rr,{className:"text-xs text-foreground-lighter",children:["The channel you initialize with the Supabase Realtime client. Learn more in"," ",(0,a.jsx)("a",{target:"_blank",rel:"noreferrer",className:"underline hover:text-foreground transition",href:"https://supabase.com/docs/guides/realtime/concepts#channels",children:"our docs"})]})]})}}),(0,a.jsx)(j.zB,{control:w.control,name:"isPrivate",render:e=>{let{field:s}=e;return(0,a.jsxs)(j.eI,{className:"",children:[(0,a.jsxs)("div",{className:"flex flex-row items-center gap-x-2",children:[(0,a.jsx)(j.MJ,{children:(0,a.jsx)(v.d,{checked:s.value,onCheckedChange:s.onChange,disabled:s.disabled})}),(0,a.jsx)(j.lR,{className:"text-xs",children:"Is channel private?"})]}),(0,a.jsx)(j.Rr,{className:"text-xs text-foreground-lighter mt-2",children:"If the channel is marked as private, it will use RLS policies to filter messages."})]})}},"isPrivate"),(0,a.jsx)(f.A,{abbrev:!1,className:"w-min",href:"https://supabase.com/docs/guides/realtime/authorization"})]})})}):(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,a.jsxs)("p",{className:"text-foreground text-xs",children:["Currently joined"," ",(0,a.jsx)("span",{className:s.isChannelPrivate?"text-brand":"text-warning",children:s.isChannelPrivate?"private":"public"})," ","channel:"]}),(0,a.jsx)("p",{className:"text-xs border border-scale-600  py-0.5 px-1 rounded-md bg-surface-200",children:s.channelName})]}),(0,a.jsx)("p",{className:"text-xs text-foreground-lighter mt-2",children:"If you leave this channel, all of the messages populated on this page will disappear"}),(0,a.jsx)(y.$,{type:"default",onClick:()=>t({...s,channelName:"",enabled:!1}),children:"Leave channel"})]})})})]})};var C=t(75080),k=t(59153),S=t.n(k),_=t(51859),M=t(65863),A=t(16865);let R=(0,r.createContext)({contextSize:"small",className:""}),T=function(e){let{className:s,size:t,type:n="Mail",color:l,strokeWidth:r,fill:i,stroke:o,background:c,src:d,icon:x,...m}=e,u=(0,A.A)("icon");return(0,a.jsx)(R.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"IconBase","data-sentry-source-file":"IconBase.tsx",children:e=>{let{contextSize:n,className:h}=e,p={tiny:14,small:18,medium:20,large:20,xlarge:24,xxlarge:30,xxxlarge:42},f=p.large,g=21;n&&(g=n?"string"==typeof n?p[n]:n:f),t&&(g=t?"string"==typeof t?p[t]:t:f);let y=!l&&!i&&!o,j=["sbui-icon",s];h&&j.push(h);let b=d?(0,a.jsx)("div",{className:"relative",style:{width:g+"px",height:g+"px"},children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",color:y?"currentColor":l,fill:y?"none":i||"none",stroke:y?"currentColor":o,className:(0,_.cn)(j),width:"100%",height:"100%",strokeWidth:null!=r?r:void 0,...m,children:d})}):(0,a.jsx)(x,{color:y?"currentColor":l,stroke:y?"currentColor":o,className:(0,_.cn)(j),strokeWidth:r,size:g,fill:y?"none":i||"none",...m,"data-sentry-element":"FeatherIcon","data-sentry-component":"IconComponent","data-sentry-source-file":"IconBase.tsx"});return c?(0,a.jsx)("div",{className:u.container,children:b}):b}})},z=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("path",{stroke:"currentColor",strokeLinejoin:"round",strokeMiterlimit:10,d:"m23.149 23.499 3.424 7.83a.5.5 0 0 0 .942-.074l.74-2.868a.5.5 0 0 1 .364-.36l3.039-.756a.5.5 0 0 0 .08-.943l-7.93-3.487a.5.5 0 0 0-.66.658Z","data-sentry-element":"path","data-sentry-source-file":"IconPresence.tsx"}),(0,a.jsx)("path",{stroke:"currentColor",strokeLinejoin:"round",strokeMiterlimit:10,d:"M24.544 32.746h-5.623a3 3 0 0 1-3-3V18.5a3 3 0 0 1 3-3h11.247a3 3 0 0 1 3 3v5.623",opacity:.45,"data-sentry-element":"path","data-sentry-source-file":"IconPresence.tsx"})]}),P=function(e){return(0,a.jsx)(T,{src:(0,a.jsx)(z,{}),viewBox:"12.5 12 24 24",...e,"data-sentry-element":"IconBase","data-sentry-component":"IconPresence","data-sentry-source-file":"IconPresence.tsx"})};var I=t(10482);let E=()=>(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("path",{id:"Ellipse 146",d:"M17.3154 6.70312C18.6968 8.06227 19.5532 9.95249 19.5532 12.0426C19.5532 14.1326 18.6968 16.0229 17.3154 17.382M6.79102 6.70312C5.40966 8.06227 4.55322 9.95249 4.55322 12.0426C4.55322 14.1326 5.40966 16.0229 6.79102 17.382",stroke:"currentColor",strokeMiterlimit:"10",strokeLinejoin:"bevel",opacity:.45,"data-sentry-element":"path","data-sentry-source-file":"IconBroadcast.tsx"}),(0,a.jsx)("ellipse",{id:"Ellipse 144",cx:"12.0532",cy:"12.0428",rx:"3.00928",ry:"3.00666",stroke:"currentColor",strokeMiterlimit:"10",strokeLinejoin:"bevel","data-sentry-element":"ellipse","data-sentry-source-file":"IconBroadcast.tsx"}),(0,a.jsx)("path",{id:"Vector 96",d:"M12.0747 15.0488L12.0747 23.9996",stroke:"currentColor",strokeMiterlimit:"10",strokeLinejoin:"bevel","data-sentry-element":"path","data-sentry-source-file":"IconBroadcast.tsx"})]}),L=function(e){return(0,a.jsx)(T,{src:(0,a.jsx)(E,{}),viewBox:"0 0 24 24",...e,"data-sentry-element":"IconBase","data-sentry-component":"IconBroadcast","data-sentry-source-file":"IconBroadcast.tsx"})},B=()=>(0,a.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:25,height:24,fill:"none","data-sentry-element":"svg","data-sentry-component":"SvgComponent","data-sentry-source-file":"IconDatabaseChanges.tsx",children:[(0,a.jsx)("path",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"bevel",strokeMiterlimit:10,d:"M20.307 12a7.807 7.807 0 0 1-7.807 7.808M4.693 12A7.807 7.807 0 0 1 12.5 4.193",opacity:.45,"data-sentry-element":"path","data-sentry-source-file":"IconDatabaseChanges.tsx"}),(0,a.jsx)("circle",{cx:17.512,cy:6.971,r:3.723,stroke:"currentColor",strokeLinejoin:"bevel",strokeMiterlimit:10,"data-sentry-element":"circle","data-sentry-source-file":"IconDatabaseChanges.tsx"}),(0,a.jsx)("path",{stroke:"currentColor",strokeLinejoin:"bevel",strokeMiterlimit:10,d:"m10.11 13.287 2.137 3.703-2.138 3.703H5.833L3.695 16.99l2.138-3.703h4.276Z","data-sentry-element":"path","data-sentry-source-file":"IconDatabaseChanges.tsx"})]}),F=function(e){return(0,a.jsx)(T,{src:(0,a.jsx)(B,{}),viewBox:"0 0 25 24",...e,"data-sentry-element":"IconBase","data-sentry-component":"IconDatabaseChanges","data-sentry-source-file":"IconDatabaseChanges.tsx"})};var D=t(16988),O=t(64540),$=t(4487);let W=e=>{let{value:s,onChange:t}=e;return(0,a.jsxs)("div",{className:"flex flex-row gap-4 items-center","data-sentry-component":"FilterSchema","data-sentry-source-file":"FilterSchema.tsx",children:[(0,a.jsx)("p",{className:"w-[60px] flex justify-end text-sm",children:"WHERE"}),(0,a.jsx)($.A,{disabled:!0,supportSelectAll:!0,size:"small",selectedSchemaName:s,onSelectSchema:t,className:"rounded-l-none [&>button>span>div]:py-0 w-64","data-sentry-element":"SchemaSelector","data-sentry-source-file":"FilterSchema.tsx"})]})};var H=t(36141),U=t(70324),G=t(67585),J=t(97872),V=t(69636),Y=t(77796),K=t.n(Y),X=t(51194),Z=t(58324),q=t(44679);let Q=e=>{let{className:s,size:t="tiny",showError:n=!0,selectedSchemaName:l,selectedTableName:i,onSelectTable:o}=e,[c,d]=(0,r.useState)(!1),[x,m]=(0,r.useState)(!1),{project:u}=(0,J.Om)(),[h,p]=(0,r.useState)(""),{data:f,isLoading:j,isSuccess:b,isError:v,error:N,refetch:w}=(0,V.kD)({projectRef:null==u?void 0:u.ref,search:h,connectionString:null==u?void 0:u.connectionString,schemas:[l]});(0,r.useEffect)(()=>{!x&&b&&m(!0)},[x,b]),(0,r.useEffect)(()=>{c||""===h||p("")},[c,h]);let C=K()(p),k=((null==f?void 0:f.pages[0].data.entities)?[...null==f?void 0:f.pages[0].data.entities]:[]).sort((e,s)=>e.name>s.name?0:-1);return(0,a.jsx)("div",{className:s,"data-sentry-component":"TableSelector","data-sentry-source-file":"TableSelector.tsx",children:(0,a.jsxs)(g.AM,{open:c,onOpenChange:d,modal:!1,"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"TableSelector.tsx",children:[(0,a.jsx)(g.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"TableSelector.tsx",children:(0,a.jsx)(y.$,{size:t,type:"outline",disabled:j,className:"w-full [&>span]:w-full ".concat("small"===t?"py-1.5":""),icon:j?(0,a.jsx)(X.A,{className:"animate-spin",size:12}):null,iconRight:(0,a.jsx)(Z.A,{className:"text-foreground-light rotate-90",strokeWidth:2,size:12}),"data-sentry-element":"Button","data-sentry-source-file":"TableSelector.tsx",children:x?(0,a.jsxs)("div",{className:"w-full flex space-x-3",children:[(0,a.jsx)("p",{className:"text-xs text-light",children:"table"}),(0,a.jsx)("p",{className:"text-xs",children:"*"===i?"All tables":i})]}):(0,a.jsx)("p",{className:"flex text-xs text-light",children:"Loading tables..."})})}),(0,a.jsx)(g.hl,{className:"p-0 w-64",side:"bottom",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"TableSelector.tsx",children:(0,a.jsxs)(H.uB,{"data-sentry-element":"Command_Shadcn_","data-sentry-source-file":"TableSelector.tsx",children:[(0,a.jsx)(H.G7,{placeholder:"Find table...",onValueChange:e=>C(e),"data-sentry-element":"CommandInput_Shadcn_","data-sentry-source-file":"TableSelector.tsx"}),(0,a.jsxs)(H.oI,{"data-sentry-element":"CommandList_Shadcn_","data-sentry-source-file":"TableSelector.tsx",children:[j&&(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2 px-3 py-2",children:[(0,a.jsx)(X.A,{className:"animate-spin",size:12}),(0,a.jsx)("p",{className:"flex text-xs text-light",children:"Loading tables..."})]}),n&&v&&(0,a.jsxs)(U.Fc,{variant:"warning",className:"!px-3 !py-3 !border-0 rounded-none",children:[(0,a.jsx)(U.XL,{className:"text-xs text-amber-900",children:"Failed to load tables"}),(0,a.jsxs)(U.TN,{className:"text-xs mb-2",children:["Error: ",null==N?void 0:N.message]}),(0,a.jsx)(y.$,{type:"default",size:"tiny",onClick:()=>w(),children:"Reload tables"})]}),b&&(0,a.jsx)(a.Fragment,{children:(0,a.jsx)(H.L$,{forceMount:!0,children:(0,a.jsxs)(G.FK,{className:(k||[]).length>7?"h-[210px]":"",children:[(0,a.jsx)(H.xL,{children:"No tables found"}),!h&&(0,a.jsxs)(H.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{o("*",void 0),d(!1)},onClick:()=>{o("*",void 0),d(!1)},children:[(0,a.jsx)("span",{children:"All tables"}),"*"===l&&(0,a.jsx)(q.A,{className:"text-brand",strokeWidth:2})]},"all-tables"),null==k?void 0:k.map(e=>(0,a.jsxs)(H.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{o(e.name,e.id),d(!1)},onClick:()=>{o(e.name,e.id),d(!1)},children:[(0,a.jsx)("span",{children:e.name}),l===e.name&&(0,a.jsx)(q.A,{className:"text-brand",strokeWidth:2})]},e.id))]})})})]})]})})]})})},ee=e=>{let{value:s,schema:t,onChange:n}=e;return(0,a.jsxs)("div",{className:"flex flex-row gap-4 items-center","data-sentry-component":"FilterTable","data-sentry-source-file":"FilterTable.tsx",children:[(0,a.jsx)("p",{className:"w-[60px] flex justify-end text-sm",children:"AND"}),(0,a.jsx)(Q,{selectedSchemaName:t,selectedTableName:s,onSelectTable:n,className:"w-64",size:"small","data-sentry-element":"TableSelector","data-sentry-source-file":"FilterTable.tsx"})]})},es=e=>{let{config:s,onChangeConfig:t}=e,[n,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[m,u]=(0,r.useState)(s),{ref:h}=(0,l.g)(),p=(0,x.a)(),{mutate:f}=(0,i.h)(),j="*"!==s.table;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(g.AM,{open:n,onOpenChange:e=>{!0===e&&u(s),o(e)},"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(g.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"index.tsx",children:(0,a.jsx)(y.$,{icon:(0,a.jsx)(C.A,{size:"16"}),type:j?"primary":"dashed",className:(0,_.cn)("rounded-full px-1.5 text-xs",j?"!py-0.5":"!py-1"),size:"small","data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("span",{className:"mr-1",children:"Filtered by "}),(0,a.jsxs)(M.E,{variant:"brand",children:["table: ",s.table]})]}):(0,a.jsx)("span",{className:"mr-1",children:"Filter messages"})})}),(0,a.jsxs)(g.hl,{className:"p-0 w-[365px]",align:"start","data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)("div",{className:"border-b border-overlay text-xs px-4 py-3 text-foreground",children:"Listen to event types"}),(0,a.jsxs)("div",{className:"py-3 px-4 border-b border-overlay",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,a.jsxs)("div",{className:"flex gap-2.5 items-center",children:[(0,a.jsx)(P,{size:"xlarge",className:"bg-foreground rounded text-background-muted","data-sentry-element":"IconPresence","data-sentry-source-file":"index.tsx"}),(0,a.jsx)("label",{htmlFor:"toggle-presence",className:"text-sm",children:"Presence"})]}),(0,a.jsx)(I.A,{id:"toggle-presence",size:"tiny",checked:m.enablePresence,onChange:()=>u({...m,enablePresence:!m.enablePresence}),"data-sentry-element":"Toggle","data-sentry-source-file":"index.tsx"})]}),(0,a.jsx)("p",{className:"text-xs text-foreground-light pt-1",children:"Store and synchronize user state consistently across clients"})]}),(0,a.jsxs)("div",{className:"py-3 px-4 border-b border-overlay",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-2.5 items-center",children:[(0,a.jsx)(L,{size:"xlarge",className:"bg-foreground rounded text-background-muted","data-sentry-element":"IconBroadcast","data-sentry-source-file":"index.tsx"}),(0,a.jsx)("label",{htmlFor:"toggle-broadcast",className:"text-sm",children:"Broadcast"})]}),(0,a.jsx)(I.A,{id:"toggle-broadcast",size:"tiny",checked:m.enableBroadcast,onChange:()=>u({...m,enableBroadcast:!m.enableBroadcast}),"data-sentry-element":"Toggle","data-sentry-source-file":"index.tsx"})]}),(0,a.jsx)("p",{className:"text-xs  text-foreground-light pt-1",children:"Send any data to any client subscribed to the same channel"})]}),(0,a.jsxs)("div",{className:"py-3 px-4 border-b border-overlay",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex gap-2.5 items-center",children:[(0,a.jsx)(F,{size:"xlarge",className:"bg-foreground rounded text-background-muted","data-sentry-element":"IconDatabaseChanges","data-sentry-source-file":"index.tsx"}),(0,a.jsx)("label",{htmlFor:"toggle-db-changes",className:"text-sm",children:"Database changes"})]}),(0,a.jsx)(I.A,{id:"toggle-db-changes",size:"tiny",checked:m.enableDbChanges,onChange:()=>u({...m,enableDbChanges:!m.enableDbChanges}),"data-sentry-element":"Toggle","data-sentry-source-file":"index.tsx"})]}),(0,a.jsx)("p",{className:"text-xs text-foreground-light pt-1",children:"Listen for Database inserts, updates, deletes and more"})]}),m.enableDbChanges&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"border-b border-overlay text-xs px-4 py-3 text-foreground",children:"Filter messages from database changes"}),(0,a.jsxs)("div",{className:"flex border-b border-overlay p-4 gap-y-2 flex-col",children:[(0,a.jsx)(W,{value:m.schema,onChange:e=>u({...m,schema:e,table:"*"})}),(0,a.jsx)(ee,{value:m.table,schema:m.schema,onChange:e=>u({...m,table:e})})]}),(0,a.jsxs)("div",{className:"border-b border-overlay p-4 flex flex-col gap-2",children:[(0,a.jsxs)("div",{className:"flex flex-row gap-4 items-center",children:[(0,a.jsx)("p",{className:"w-[60px] flex justify-end text-sm",children:"AND"}),(0,a.jsx)(D.A,{size:"tiny",className:"flex-grow",placeholder:"body=eq.hey",value:m.filter,onChange:e=>u({...m,filter:e.target.value})})]}),(0,a.jsxs)("p",{className:"text-xs text-foreground-light pl-[80px]",children:["Learn more about realtime filtering in"," ",(0,a.jsx)(S(),{className:"underline",target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/realtime/postgres-changes#available-filters",children:"our docs"})]})]})]}),(0,a.jsxs)("div",{className:"px-4 py-2 gap-2 flex justify-end",children:[(0,a.jsx)(y.$,{type:"default",onClick:()=>o(!1),"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Cancel"}),(0,a.jsx)(y.$,{onClick:()=>d(!0),"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Apply"})]})]})]}),(0,a.jsx)(O.A,{title:"Previously found messages will be lost",variant:"destructive",confirmLabel:"Confirm",size:"small",visible:c,onCancel:()=>d(!1),onConfirm:()=>{var e;f({action:"realtime_inspector_filters_applied",groups:{project:null!=h?h:"Unknown",organization:null!=(e=null==p?void 0:p.slug)?e:"Unknown"}}),t(m),d(!1),o(!1)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"index.tsx",children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"The realtime inspector will clear currently collected messages and start listening for new messages matching the updated filters."})})]})};var et=t(73969),ea=t(36389),en=t(98453),el=t(16599),er=t(64036),ei=t(81979),eo=t(32036);let ec=e=>{let{config:s,onChangeConfig:t}=e,n=(0,eo.RY)(),{data:o}=(0,el.Gm)({projectRef:s.projectRef}),{anonKey:c,serviceKey:d}=(0,el.d6)(o),{data:m}=(0,en.y)({projectRef:s.projectRef},{enabled:er.pe}),u=null==m?void 0:m.jwt_secret,{ref:h}=(0,l.g)(),p=(0,x.a)(),{mutate:f}=(0,i.h)(),g=(0,r.useRef)(!1);return(0,r.useEffect)(()=>{if(g.current){var e;f({action:"realtime_inspector_database_role_updated",groups:{project:null!=h?h:"Unknown",organization:null!=(e=null==p?void 0:p.slug)?e:"Unknown"}})}g.current=!0},[n.role]),(0,r.useEffect)(()=>{(async()=>{let e,a=null;void 0!==s.projectRef&&void 0!==u&&void 0!==n.role&&"postgrest"===n.role.type?(e=null==c?void 0:c.api_key,await (0,ei._p)(s.projectRef,u,n.role).then(e=>a=e).catch(e=>et.oR.error("Failed to get JWT for role: ".concat(e.message)))):e=null==d?void 0:d.api_key,e&&t({...s,token:e,bearer:a})})()},[n.role,c,d]),(0,a.jsx)(ea.g,{align:"start",variant:"connected-on-both","data-sentry-element":"RoleImpersonationPopover","data-sentry-component":"RealtimeTokensPopover","data-sentry-source-file":"index.tsx"})},ed=e=>{let{config:s,onChangeConfig:t}=e,{mutate:n}=(0,i.h)(),{ref:r}=(0,l.g)(),m=(0,x.a)();return(0,a.jsxs)("div",{className:"flex flex-row h-14 gap-2.5 items-center px-4","data-sentry-component":"Header","data-sentry-source-file":"Header.tsx",children:[(0,a.jsxs)("div",{className:"flex flex-row",children:[(0,a.jsx)(w,{config:s,onChangeConfig:t,"data-sentry-element":"ChooseChannelPopover","data-sentry-source-file":"Header.tsx"}),(0,a.jsx)(ec,{config:s,onChangeConfig:t,"data-sentry-element":"RealtimeTokensPopover","data-sentry-source-file":"Header.tsx"}),(0,a.jsx)(d.G,{size:"tiny",type:s.enabled?"warning":"primary",className:"rounded-l-none border-l-0",disabled:0===s.channelName.length,icon:s.enabled?(0,a.jsx)(o.A,{size:"16"}):(0,a.jsx)(c.A,{size:"16"}),onClick:()=>{if(t({...s,enabled:!s.enabled}),!s.enabled){var e;n({action:"realtime_inspector_listen_channel_clicked",groups:{project:null!=r?r:"Unknown",organization:null!=(e=null==m?void 0:m.slug)?e:"Unknown"}})}},tooltip:{content:{side:"bottom",text:0===s.channelName.length?"You need to join a channel first":void 0}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"Header.tsx",children:s.enabled?"Stop listening":"Start listening"})]}),(0,a.jsx)(es,{config:s,onChangeConfig:t,"data-sentry-element":"RealtimeFilterPopover","data-sentry-source-file":"Header.tsx"})]})};var ex=t(84305),em=t.n(ex),eu=t(77877),eh=t(8945),ep=t(58849),ef=t(24560),eg=t(46036),ey=t(62763),ej=t(14430),eb=t(53434),ev=t.n(eb);let eN=e=>ev().unix(Number(e)/1e3).toISOString(),ew=e=>{let{children:s}=e;return(0,a.jsx)("div",{className:"flex h-full w-full items-center gap-4","data-sentry-component":"RowLayout","data-sentry-source-file":"MessagesFormatters.tsx",children:s})},eC=e=>{let{value:s,hideCopy:t=!1}=e;return(0,a.jsx)(ek,{label:"Timestamp",value:eN(s),hideCopy:t,"data-sentry-element":"SelectionDetailedRow","data-sentry-component":"SelectionDetailedTimestampRow","data-sentry-source-file":"MessagesFormatters.tsx"})},ek=e=>{let{label:s,value:t,valueRender:n,hideCopy:l=!1}=e;return(0,a.jsxs)("div",{className:"grid grid-cols-12 group","data-sentry-component":"SelectionDetailedRow","data-sentry-source-file":"MessagesFormatters.tsx",children:[(0,a.jsx)("span",{className:"text-scale-900 text-sm col-span-4 whitespace-pre-wrap",children:s}),(0,a.jsx)("span",{className:"text-scale-1200 text-sm col-span-6 whitespace-pre-wrap break-all",children:null!=n?n:t}),!l&&(0,a.jsx)(ej.A,{text:t,className:"group-hover:opacity-100 opacity-0 my-auto transition col-span-2  h-4 w-4 px-0 py-0",type:"text",title:"Copy to clipboard"})]})},eS=()=>(0,a.jsx)("div",{className:"h-px w-full bg-panel-border-interior-light [[data-theme*=dark]_&]:bg-panel-border-interior-dark","data-sentry-component":"LogsDivider","data-sentry-source-file":"SelectedRealtimeMessagePanel.tsx"}),e_=e=>{let{log:s}=e;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"px-8",children:[(0,a.jsx)("span",{className:"col-span-4 text-sm text-scale-900",children:"Message"}),(0,a.jsx)("p",{className:"text-wrap mt-2 overflow-x-auto whitespace-pre-wrap font-mono text-xs text-scale-1200",children:s.message})]}),(0,a.jsx)(eS,{"data-sentry-element":"LogsDivider","data-sentry-source-file":"SelectedRealtimeMessagePanel.tsx"}),(0,a.jsx)("div",{className:"px-8 space-y-2",children:(0,a.jsx)(eC,{hideCopy:!0,value:s.timestamp,"data-sentry-element":"SelectionDetailedTimestampRow","data-sentry-source-file":"SelectedRealtimeMessagePanel.tsx"})}),(0,a.jsx)(eS,{"data-sentry-element":"LogsDivider","data-sentry-source-file":"SelectedRealtimeMessagePanel.tsx"}),(0,a.jsxs)("div",{className:"px-8",children:[(0,a.jsx)("h3",{className:"mb-4 text-sm text-foreground-lighter",children:"Metadata"}),(0,a.jsx)("pre",{className:"syntax-highlight overflow-x-auto text-sm",children:(0,a.jsx)("div",{className:"text-wrap",dangerouslySetInnerHTML:{__html:s.metadata?function(e){let s=JSON.stringify(e,null,2);return(s=s.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")).replace(/("(\\u[a-zA-Z0-9]{4}|\\[^u]|[^\\"])*"(\s*:)?|\b(true|false|null)\b|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)/g,function(e){var s="number text-tomato-900";return/^"/.test(e)?s=/:$/.test(e)?"key text-scale-1200":"string text-brand-600":/true|false/.test(e)?s="boolean text-blue-900":/null/.test(e)&&(s="null text-amber-1100"),'<span class="'+s+'">'+e+"</span>"}).split("\n").map(e=>'<span class="line text-xs">'.concat(e,"</span>")).join("\n")}(s.metadata):""}})})]})]})},eM=e=>{let{log:s,onClose:t}=e,n=(0,r.useMemo)(()=>JSON.stringify(s,null,2),[s]),{ref:o}=(0,l.g)(),c=(0,x.a)(),{mutate:d}=(0,i.h)();return(0,a.jsxs)("div",{className:(0,_.cn)("relative flex h-full flex-grow flex-col border-l border-t-2 overflow-y-scroll bg-200"),"data-sentry-component":"MessageSelection","data-sentry-source-file":"MessageSelection.tsx",children:[(0,a.jsx)("div",{className:(0,_.cn)("absolute flex h-full w-full flex-col items-center justify-center gap-2 bg-200 text-center opacity-0 transition-all",s?"z-0 opacity-0":"z-10 opacity-100"),children:(0,a.jsxs)("div",{className:(0,_.cn)("flex w-full max-w-sm scale-95 flex-col items-center justify-center gap-6 text-center opacity-0 transition-all delay-300 duration-500",s?"mt-0 scale-95 opacity-0":"mt-8 scale-100 opacity-100"),children:[(0,a.jsxs)("div",{className:"relative flex h-4 w-32 items-center rounded border border-default px-2",children:[(0,a.jsx)("div",{className:"h-0.5 w-2/3 rounded-full bg-overlay-hover"}),(0,a.jsx)("div",{className:"absolute right-1 -bottom-4",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1","data-sentry-element":"svg","data-sentry-source-file":"MessageSelection.tsx",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122","data-sentry-element":"path","data-sentry-source-file":"MessageSelection.tsx"})})})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsx)("h3",{className:"text-sm text-foreground",children:"Select a message"}),(0,a.jsx)("p",{className:"text-xs text-foreground-lighter",children:"Click on a message on the left to view details."})]})]})}),(0,a.jsxs)("div",{className:"relative h-px flex-grow",children:[(0,a.jsxs)("div",{className:"pt-4 flex flex-col gap-4",children:[(0,a.jsxs)("div",{className:"px-4 flex flex-row justify-between items-center",children:[(0,a.jsx)("div",{className:"transition",children:(0,a.jsx)(ej.A,{text:n,type:"default",title:"Copy log to clipboard",onClick:()=>{var e;d({action:"realtime_inspector_copy_message_clicked",groups:{project:null!=o?o:"Unknown",organization:null!=(e=null==c?void 0:c.slug)?e:"Unknown"}})},"data-sentry-element":"CopyButton","data-sentry-source-file":"MessageSelection.tsx"})}),(0,a.jsx)(y.$,{type:"text",className:"cursor-pointer transition hover:text-scale-1200 h-8 w-8 px-0 py-0 flex items-center justify-center",onClick:t,"data-sentry-element":"Button","data-sentry-source-file":"MessageSelection.tsx",children:(0,a.jsx)(ey.A,{size:14,strokeWidth:2,className:"text-scale-900","data-sentry-element":"X","data-sentry-source-file":"MessageSelection.tsx"})})]}),(0,a.jsx)("div",{className:"h-px w-full bg-scale-600 rounded"})]}),(0,a.jsx)("div",{className:"flex flex-col space-y-6 py-4",children:s&&(0,a.jsx)(e_,{log:s})})]})]})},eA=()=>(0,a.jsxs)("div",{className:"border bg-studio border-border rounded-md justify-start items-center flex flex-col w-10/12 relative","data-sentry-component":"NoChannelEmptyState","data-sentry-source-file":"NoChannelEmptyState.tsx",children:[(0,a.jsx)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex border-b rounded-t-md",children:(0,a.jsxs)("div",{className:"grow flex-col flex gap-y-1",children:[(0,a.jsx)("p",{className:"text-foreground",children:"Join a channel to start listening to messages"}),(0,a.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Channels are the building blocks of realtime where clients can bi-directionally send and receive messages in."})]})}),(0,a.jsxs)("div",{className:(0,_.cn)("w-full px-5 py-4 items-center gap-4 inline-flex"),children:[(0,a.jsxs)("div",{className:"grow flex-col flex",children:[(0,a.jsx)("p",{className:"text-foreground",children:"Not sure what to do?"}),(0,a.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Browse our documentation"})]}),(0,a.jsx)(f.A,{href:"https://supabase.com/docs/guides/realtime","data-sentry-element":"DocsButton","data-sentry-source-file":"NoChannelEmptyState.tsx"})]})]});var eR=t(74438);let eT={PRESENCE:(0,a.jsx)(P,{size:"xlarge"}),BROADCAST:(0,a.jsx)(L,{size:"xlarge"}),POSTGRES:(0,a.jsx)(F,{size:"xlarge"}),SYSTEM:(0,a.jsx)(eR.A,{size:"20",strokeWidth:1})},ez=[{name:"timestamp-with-truncated-text",key:"main-column",renderCell:e=>{let s=e.row.message;return(0,a.jsxs)(ew,{children:[(0,a.jsx)("div",{className:(0,_.cn)("flex justify-center items-center min-w-[24px]",eP(e.row)?"text-warning-600":"text-green-900"),children:eT[s]}),(0,a.jsx)("span",{className:(0,_.cn)("font-mono",eP(e.row)?"!text-warning-600":""),children:new Date(e.row.timestamp).toISOString()}),(0,a.jsx)("span",{className:(0,_.cn)("truncate font-mono",eP(e.row)?"!text-warning-600":""),children:JSON.stringify(e.row.metadata)})]})}}],eP=e=>{var s;return"SYSTEM"===e.message&&(null==(s=e.metadata)?void 0:s.status)==="error"},eI=e=>{let{enabled:s,hasChannelSet:t,showSendMessage:n}=e,{ref:r}=(0,l.g)();return(0,a.jsx)("div",{className:"w-full max-w-md flex items-center flex-col","data-sentry-component":"NoResultAlert","data-sentry-source-file":"MessagesTable.tsx",children:t?(0,a.jsxs)(a.Fragment,{children:[s&&(0,a.jsx)("p",{className:"text-foreground",children:"No Realtime messages found"}),(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Realtime message logs will be shown here"}),(0,a.jsxs)("div",{className:"mt-4 border bg-surface-100 border-border rounded-md justify-start items-center flex flex-col w-full",children:[(0,a.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex border-b",children:[(0,a.jsx)(L,{size:"xlarge",className:"text-background bg-foreground rounded w-6"}),(0,a.jsxs)("div",{className:"grow flex-col flex",children:[(0,a.jsx)("p",{className:"text-foreground",children:"Create a Broadcast message"}),(0,a.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Send a message in the channel"})]}),(0,a.jsx)(y.$,{type:"default",onClick:n,children:"Broadcast a message"})]}),(0,a.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex border-b",children:[(0,a.jsx)(P,{size:"xlarge",className:"text-background bg-foreground rounded w-6"}),(0,a.jsxs)("div",{className:"grow flex-col flex",children:[(0,a.jsx)("p",{className:"text-foreground",children:"Join from another browser tab"}),(0,a.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Send messages between multiple clients"})]}),(0,a.jsx)(S(),{href:"/project/".concat(r,"/realtime/inspector"),target:"_blank",rel:"noreferrer",children:(0,a.jsx)(y.$,{type:"default",iconRight:(0,a.jsx)(eu.A,{}),children:"Open inspector"})})]}),(0,a.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex border-b",children:[(0,a.jsx)(F,{size:"xlarge",className:"text-background bg-foreground rounded w-6"}),(0,a.jsxs)("div",{className:"grow flex-col flex",children:[(0,a.jsx)("p",{className:"text-foreground",children:"Listen to a table for changes"}),(0,a.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Tables must have realtime enabled"})]}),(0,a.jsx)(S(),{href:"/project/".concat(r,"/database/publications"),target:"_blank",rel:"noreferrer",children:(0,a.jsx)(y.$,{type:"default",iconRight:(0,a.jsx)(eu.A,{}),children:"Publications settings"})})]}),(0,a.jsxs)("div",{className:"w-full px-5 py-4 items-center gap-4 inline-flex rounded-b-md bg-studio",children:[(0,a.jsxs)("div",{className:"grow flex-col flex",children:[(0,a.jsx)("p",{className:"text-foreground",children:"Not sure what to do?"}),(0,a.jsx)("p",{className:"text-foreground-lighter text-xs",children:"Browse our documentation"})]}),(0,a.jsx)(f.A,{href:"https://supabase.com/docs/guides/realtime"})]})]})]}):(0,a.jsx)(eA,{})})},eE=e=>{let{enabled:s,hasChannelSet:t,data:n=[],showSendMessage:o}=e,[c,d]=(0,r.useState)(null),m=JSON.stringify(n),{ref:u}=(0,l.g)(),h=(0,x.a)(),{mutate:p}=(0,i.h)();return((0,r.useEffect)(()=>{n&&(n.find(e=>e.id===(null==c?void 0:c.id))||d(null))},[m]),n)?(0,a.jsx)(a.Fragment,{children:(0,a.jsxs)("section",{className:"flex w-full flex-col",style:{maxHeight:"calc(100vh - 42px - 3rem)"},children:[(0,a.jsx)(eg.A,{active:s,"data-sentry-element":"ShimmerLine","data-sentry-source-file":"MessagesTable.tsx"}),(0,a.jsxs)("div",{className:(0,_.cn)("flex h-full flex-row",s?"border-brand-400":null),children:[(0,a.jsxs)("div",{className:"flex flex-grow flex-col",children:[s&&(0,a.jsxs)("div",{className:"w-full h-9 px-4 bg-surface-100 border-b items-center inline-flex justify-between text-foreground-light",children:[(0,a.jsxs)("div",{className:"inline-flex gap-2.5 text-xs",children:[(0,a.jsx)(eh.A,{size:"16",className:"animate-spin"}),(0,a.jsx)("div",{children:"Listening"}),(0,a.jsx)("div",{children:"•"}),(0,a.jsx)("div",{children:n.length>0?n.length>=100?"Found a large number of messages, showing only the latest 100...":"Found ".concat(n.length," messages..."):"No message found yet..."})]}),(0,a.jsx)(y.$,{type:"default",onClick:o,icon:(0,a.jsx)(ep.A,{strokeWidth:1.5}),children:(0,a.jsx)("span",{children:"Broadcast a message"})})]}),(0,a.jsx)(ef.Ay,{className:"data-grid--simple-logs h-full border-b-0",rowHeight:40,headerRowHeight:0,columns:ez,rowClass:e=>(0,_.cn)(["font-mono tracking-tight",em()(e,c)?"bg-scale-800 rdg-row--focused":"bg-200 hover:bg-scale-300 cursor-pointer",eP(e)&&"!bg-warning-300"]),rows:n,rowKeyGetter:e=>e.id,renderers:{renderRow(e,s){let{row:t}=s;return(0,a.jsx)(ef.fI,{...s,isRowSelected:!1,selectedCellIdx:void 0,onClick:()=>{var e;p({action:"realtime_inspector_message_clicked",groups:{project:null!=u?u:"Unknown",organization:null!=(e=null==h?void 0:h.slug)?e:"Unknown"}}),d(t)}},e)},noRowsFallback:(0,a.jsx)("div",{className:"mx-auto flex h-full w-full items-center justify-center space-y-12 py-4 transition-all delay-200 duration-500",children:(0,a.jsx)(eI,{enabled:s,hasChannelSet:t,showSendMessage:o})})},"data-sentry-element":"DataGrid","data-sentry-source-file":"MessagesTable.tsx"})]}),(0,a.jsx)("div",{className:"flex w-1/2 flex-col",children:(0,a.jsx)(eM,{onClose:()=>d(null),log:c,"data-sentry-element":"MessageSelection","data-sentry-source-file":"MessagesTable.tsx"})})]})]})}):null};var eL=t(94326),eB=t(49443),eF=t(67920);let eD={message:"Test message",payload:'{ "message": "Hello World" }'},eO=e=>{let{visible:s,onSelectCancel:t,onSelectConfirm:n}=e,[l,i]=(0,r.useState)(),[o,c]=(0,r.useState)(eD);return(0,r.useEffect)(()=>{s&&(i(void 0),c(eD))},[s]),(0,a.jsx)(eF.A,{size:"medium",alignFooter:"right",header:"Broadcast a message to all clients",visible:s,loading:!1,onCancel:t,onConfirm:()=>{let e=(0,eB.Bl)(o.payload);void 0===e?i("Please provide a valid JSON"):n({...o,payload:e})},"data-sentry-element":"Modal","data-sentry-component":"SendMessageModal","data-sentry-source-file":"SendMessageModal.tsx",children:(0,a.jsxs)(eF.A.Content,{className:"flex flex-col gap-y-4","data-sentry-element":"unknown","data-sentry-source-file":"SendMessageModal.tsx",children:[(0,a.jsx)(D.A,{label:"Message name",size:"small",className:"flex-grow",value:o.message,onChange:e=>c({...o,message:e.target.value}),"data-sentry-element":"Input","data-sentry-source-file":"SendMessageModal.tsx"}),(0,a.jsxs)("div",{className:"flex flex-col gap-y-2",children:[(0,a.jsx)("p",{className:"text-sm text-scale-1100",children:"Message payload"}),(0,a.jsx)(eL.A,{id:"message-payload",language:"json",className:"!mb-0 h-32 overflow-hidden rounded border",onInputChange:e=>c({...o,payload:null!=e?e:"{}"}),options:{wordWrap:"off",contextmenu:!1},value:o.payload,"data-sentry-element":"CodeEditor","data-sentry-source-file":"SendMessageModal.tsx"}),void 0!==l&&(0,a.jsx)("p",{className:"text-sm text-red-900",children:l})]})]})})};var e$=t(35209),eW=t(70048),eH=t(84513),eU=t.n(eH),eG=t(14506),eJ=t.n(eG),eV=t(87288),eY=t.n(eV),eK=t(47328);function eX(e,s){return"clear"===s.type?eK.Oj:eY()(eJ()([{id:(0,eB.gZ)(),timestamp:new Date().getTime(),message:s.payload.messageType,metadata:s.payload.metadata},...e],e=>-e.timestamp),100)}let eZ=(e,s)=>{var t,a,n;let{enabled:l,channelName:i,projectRef:o,logLevel:c,token:d,schema:x,table:m,isChannelPrivate:u,filter:h,bearer:p,enablePresence:f,enableDbChanges:g,enableBroadcast:y}=e,{data:j}=(0,el.Gm)({projectRef:o}),b=null!=(n=null==j||null==(t=j.app_config)?void 0:t.protocol)?n:"https",v=null==j||null==(a=j.app_config)?void 0:a.endpoint,N=j?"".concat(b,"://").concat(v):"https://".concat(o,".supabase.co"),w="".concat(N,"/realtime/v1").replace(/^http/i,"ws"),[C,k]=(0,r.useReducer)(eX,[]),S=(e,s)=>{k({type:"add",payload:{messageType:e,metadata:s}})},[_,M]=(0,r.useState)(),[A,R]=(0,r.useState)(),T=(0,eo.RY)();return(0,r.useEffect)(()=>{if(!l)return;let e=eU()(eW.HU,{params:{log_level:c}}),s={headers:eW.bn.headers,...e,params:{apikey:d,...e.params}},t=new e$.d1(w,s);return p&&t.setAuth(p),M(t),()=>{t.disconnect(),M(void 0)}},[l,p,N,c,d]),(0,r.useEffect)(()=>{if(!_)return;k({type:"clear"});let t=null==_?void 0:_.channel(i,{config:{broadcast:{self:!0},private:u}});if(t.on("system",{},e=>{S("SYSTEM",e)}),y&&t.on("broadcast",{event:"*"},e=>S("BROADCAST",e)),f&&t.on("presence",{event:"*"},e=>{S("PRESENCE",e)}),g){let e={event:"*",schema:x,table:m,filter:void 0};""!==h&&(e.filter=h),t.on("postgres_changes",e,e=>{let s=performance.now()+performance.timeOrigin,t=Date.parse(e.commit_timestamp);S("POSTGRES",{...e,latency:s-t})})}return t.subscribe(async a=>{if("SUBSCRIBED"===a){var n;let e=null==(n=T.role)?void 0:n.role;if(f){let s=(void 0===e?"service_role_":"anon"===e?"anon_role_":"authenticated"===e?"authenticated_role_":"user_name_")+Math.floor(100*Math.random());t.send({type:"presence",event:"TRACK",payload:{name:s,t:performance.now()}})}}else"CHANNEL_ERROR"===a&&(et.oR.error("Failed to connect to the channel ".concat(i,": This may be due to restrictive RLS policies. Check your role and try again.")),t.unsubscribe(),R(void 0),s({...e,channelName:"",enabled:!1}))}),R(t),()=>{t.unsubscribe(),R(void 0)}},[_,i,y,g,f,h,N,x,m]),{logData:C,sendMessage:(0,r.useCallback)(async(e,s,t)=>{A?"error"===await A.send({type:"broadcast",event:e,payload:s})?et.oR.error("Failed to broadcast message"):(et.oR.success("Successfully broadcasted message"),t()):et.oR.error("Failed to broadcast message: channel has not been set")},[A])}},eq=()=>{let{ref:e}=(0,l.g)(),s=(0,x.a)(),[t,n]=(0,r.useState)(!1),[o,c]=(0,r.useState)({enabled:!1,projectRef:e,channelName:"",logLevel:"info",token:"",schema:"public",table:"*",isChannelPrivate:!1,filter:void 0,bearer:null,enablePresence:!0,enableDbChanges:!0,enableBroadcast:!0}),{mutate:d}=(0,i.h)(),{logData:m,sendMessage:u}=eZ(o,c);return(0,a.jsxs)("div",{className:"flex flex-col grow h-full","data-sentry-component":"RealtimeInspector","data-sentry-source-file":"index.tsx",children:[(0,a.jsx)(ed,{config:o,onChangeConfig:c,"data-sentry-element":"Header","data-sentry-source-file":"index.tsx"}),(0,a.jsx)("div",{className:"relative flex flex-col grow",children:(0,a.jsx)("div",{className:"flex grow",children:(0,a.jsx)(eE,{hasChannelSet:o.channelName.length>0,enabled:o.enabled,data:m,showSendMessage:()=>n(!0),"data-sentry-element":"MessagesTable","data-sentry-source-file":"index.tsx"})})}),(0,a.jsx)(eO,{visible:t,onSelectCancel:()=>n(!1),onSelectConfirm:t=>{var a;d({action:"realtime_inspector_broadcast_sent",groups:{project:null!=e?e:"Unknown",organization:null!=(a=null==s?void 0:s.slug)?a:"Unknown"}}),u(t.message,t.payload,()=>n(!1))},"data-sentry-element":"SendMessageModal","data-sentry-source-file":"index.tsx"})]})};var eQ=t(61963),e0=t(1053),e1=t(10585),e2=t(77227);let e4=()=>(0,e2.SE)(n.aG.READ,"service_api_keys")?(0,a.jsx)(eq,{"data-sentry-element":"RealtimeInspector","data-sentry-component":"InspectorPage","data-sentry-source-file":"inspector.tsx"}):(0,a.jsx)(e1.A,{isFullPage:!0,resourceText:"access your project's realtime functionalities"});e4.getLayout=e=>(0,a.jsx)(e0.A,{children:(0,a.jsx)(eQ.A,{title:"Realtime Inspector",children:e})});let e3=e4},4487:(e,s,t)=>{"use strict";t.d(s,{A:()=>y});var a=t(80263),n=t(60045),l=t(27452),r=t(44679),i=t(66345),o=t(53239),c=t(97872),d=t(788),x=t(77227),m=t(71126),u=t(25171),h=t(70324),p=t(95793),f=t(36141),g=t(67585);let y=e=>{let{className:s,disabled:t=!1,size:y="tiny",showError:j=!0,selectedSchemaName:b,supportSelectAll:v=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:C,portal:k=!0}=e,[S,_]=(0,o.useState)(!1),M=(0,x.SE)(n.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:A}=(0,c.Om)(),{data:R,isLoading:T,isSuccess:z,isError:P,error:I,refetch:E}=(0,d.w$)({projectRef:null==A?void 0:A.ref,connectionString:null==A?void 0:A.connectionString}),L=(R||[]).filter(e=>!N.includes(e.name)).sort((e,s)=>e.name.localeCompare(s.name));return(0,a.jsxs)("div",{className:s,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[T&&(0,a.jsx)(m.$,{type:"default",className:"w-full [&>span]:w-full",size:y,disabled:!0,children:(0,a.jsx)(u.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),j&&P&&(0,a.jsxs)(h.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,a.jsx)(h.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,a.jsxs)(h.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==I?void 0:I.message]}),(0,a.jsx)(m.$,{type:"default",size:"tiny",onClick:()=>E(),children:"Reload schemas"})]}),z&&(0,a.jsxs)(p.AM,{open:S,onOpenChange:_,modal:!1,children:[(0,a.jsx)(p.Wv,{asChild:!0,children:(0,a.jsx)(m.$,{size:y,disabled:t,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,a.jsx)(l.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:b?(0,a.jsxs)("div",{className:"w-full flex gap-1",children:[(0,a.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,a.jsx)("p",{className:"text-foreground",children:"*"===b?"All schemas":b})]}):(0,a.jsx)("div",{className:"w-full flex gap-1",children:(0,a.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schema…"})})})}),(0,a.jsx)(p.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:k,sameWidthAsTrigger:!0,children:(0,a.jsxs)(f.uB,{children:[(0,a.jsx)(f.G7,{placeholder:"Find schema..."}),(0,a.jsxs)(f.oI,{children:[(0,a.jsx)(f.xL,{children:"No schemas found"}),(0,a.jsx)(f.L$,{children:(0,a.jsxs)(g.FK,{className:(L||[]).length>7?"h-[210px]":"",children:[v&&(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),_(!1)},onClick:()=>{w("*"),_(!1)},children:[(0,a.jsx)("span",{children:"All schemas"}),"*"===b&&(0,a.jsx)(r.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==L?void 0:L.map(e=>(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),_(!1)},onClick:()=>{w(e.name),_(!1)},children:[(0,a.jsx)("span",{children:e.name}),b===e.name&&(0,a.jsx)(r.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==C&&M&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.fx,{}),(0,a.jsx)(f.L$,{children:(0,a.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{C(),_(!1)},onClick:()=>{C(),_(!1)},children:[(0,a.jsx)(i.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},10093:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[ref]/realtime/inspector",function(){return t(964)}])},10585:(e,s,t)=>{"use strict";t.d(s,{A:()=>l});var a=t(80263),n=t(55866);let l=e=>{let{resourceText:s,isFullPage:t=!1}=e,l=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(n.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",s]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return t?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(l,{})})}):(0,a.jsx)(l,{})}},12484:(e,s,t)=>{"use strict";t.d(s,{A:()=>c});var a=t(80263),n=t(59153),l=t.n(n),r=t(38220),i=t(65863),o=t(71126);let c=e=>{let{name:s="",isActive:t,isExternal:n,icon:c,rightIcon:d,url:x="",target:m="_self",onClick:u,textClassName:h="",hoverText:p="",label:f}=e,g=(0,a.jsx)(r.Ay.Item,{icon:c,rounded:!0,active:t,onClick:u,children:(0,a.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,a.jsxs)("div",{title:p||("string"==typeof s?s:""),className:"flex items-center gap-2 truncate w-full "+h,children:[(0,a.jsxs)("span",{className:"truncate",children:[s," "]}),void 0!==f&&(0,a.jsx)(i.E,{variant:"warning",className:"py-0 px-1.5 capitalize",children:f})]}),d&&(0,a.jsx)("div",{children:d})]})});return x?n?(0,a.jsx)(o.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,a.jsx)(l(),{href:x,target:"_blank",rel:"noreferrer",children:s})}):(0,a.jsx)(l(),{href:x,className:"block",target:m,children:g}):g}},38220:(e,s,t)=>{"use strict";t.d(s,{Ay:()=>m});var a=t(80263),n=t(53239),l=t(16865),r=t(51859);function i(e){let{children:s,className:t,tag:n="div",style:l}=e;return(0,a.jsx)("".concat(n),{style:l,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:s})}i.Title=function(e){let{className:s,level:t=1,children:n,style:l}=e;return(0,a.jsx)("h".concat(t),{style:l,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:n})},i.Text=function(e){let{className:s,children:t,style:n,type:l,disabled:r,mark:i,code:o,keyboard:c,underline:d,strikethrough:x,strong:m,small:u}=e;return o?(0,a.jsx)("code",{style:n,children:t}):i?(0,a.jsx)("mark",{style:n,children:t}):c?(0,a.jsx)("kbd",{style:n,children:t}):m?(0,a.jsx)("strong",{style:n,children:t}):(0,a.jsx)("span",{style:n,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:t})},i.Link=function(e){let{children:s,target:t="_blank",href:n,className:l,onClick:r,style:i}=e;return(0,a.jsx)("a",{onClick:r,href:n,target:t,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:s})};let o=(0,n.createContext)({type:"text"}),c=e=>{let{type:s}=e;return(0,a.jsx)(o.Provider,{value:{type:s},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},d=()=>{let e=(0,n.useContext)(o);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function x(e){let{children:s,className:t,ulClassName:n,style:l,type:r="text"}=e;return(0,a.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:t,style:l,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(c,{type:r,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("ul",{className:n,children:s})})})}x.Item=function(e){let{children:s,icon:t,active:n,rounded:i,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:x=!1,style:m}=e,u=(0,l.A)("menu"),{type:h}=d(),p=[u.item.base];p.push(u.item.variants[h].base),n?p.push(u.item.variants[h].active):p.push(u.item.variants[h].normal);let f=[u.item.content.base];n?f.push(u.item.content.active):f.push(u.item.content.normal);let g=[u.item.icon.base];return n?g.push(u.item.icon.active):g.push(u.item.icon.normal),(0,a.jsxs)("li",{role:"menuitem",className:(0,r.cn)("outline-none",p),style:m,onClick:o,"aria-current":n?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[t&&(0,a.jsx)("div",{className:"".concat(g.join(" ")," min-w-fit"),children:t}),(0,a.jsx)("span",{className:f.join(" "),children:s})]})},x.Group=function(e){let{children:s,icon:t,title:n}=e,r=(0,l.A)("menu"),{type:i}=d();return(0,a.jsxs)("div",{className:[r.group.base,r.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[t&&(0,a.jsx)("span",{className:r.group.icon,children:t}),(0,a.jsx)("span",{className:r.group.content,children:n}),s]})},x.Misc=function(e){let{children:s}=e;return(0,a.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)(i.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,a.jsx)("span",{children:s})})})};let m=x},39071:(e,s,t)=>{"use strict";t.d(s,{l:()=>i});var a=t(80263),n=t(38220),l=t(65863),r=t(12484);let i=e=>{let{page:s,menu:t}=e;return(0,a.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,a.jsx)(n.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:t.map((e,i)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"my-6 space-y-8",children:(0,a.jsxs)("div",{className:"mx-3",children:[(0,a.jsx)(n.Ay.Group,{title:e.title?(0,a.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,a.jsx)("span",{children:e.title}),e.isPreview&&(0,a.jsx)(l.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,a.jsx)("div",{children:e.items.map(e=>{let t=e.pages?e.pages.includes(null!=s?s:""):s===e.key;return(0,a.jsx)(r.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:t,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),i!==t.length-1&&(0,a.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},61963:(e,s,t)=>{"use strict";t.d(s,{A:()=>m});var a=t(80263),n=t(47504),l=t(39071),r=t(68875),i=t(80207),o=t(74725),c=t(30651),d=t(64036);let x=(e,s)=>{var t;let a=null!=(t=null==e?void 0:e.ref)?t:"default",{enableRealtimeSettings:n}=s||{};return[{title:"Tools",items:[{name:"Inspector",key:"inspector",url:"/project/".concat(a,"/realtime/inspector"),items:[]}]},{title:"Configuration",items:[{name:"Policies",key:"policies",url:"/project/".concat(a,"/realtime/policies"),items:[]},...d.pe&&n?[{name:"Settings",key:"settings",url:"/project/".concat(a,"/realtime/settings"),items:[]}]:[]]}]},m=(0,i.r)(e=>{let{title:s,children:t}=e,i=(0,r.KT)(),d=(0,o._)("enableRealtimeSettings"),m=(0,n.useRouter)().pathname.split("/")[4];return(0,a.jsx)(c.A,{title:s,product:"Realtime",productMenu:(0,a.jsx)(l.l,{page:m,menu:x(i,{enableRealtimeSettings:d})}),"data-sentry-element":"ProjectLayout","data-sentry-component":"RealtimeLayout","data-sentry-source-file":"RealtimeLayout.tsx",children:t})})},64540:(e,s,t)=>{"use strict";t.d(s,{A:()=>d});var a=t(80263),n=t(53239),l=t(82758),r=t(51859),i=t(71126),o=t(10406);let c=(0,n.forwardRef)((e,s)=>{let{title:t,description:c,size:d="small",visible:x,onCancel:m,onConfirm:u,loading:h,cancelLabel:p="Cancel",confirmLabel:f="Submit",confirmLabelLoading:g,alert:y,children:j,variant:b="default",disabled:v,...N}=e,[w,C]=(0,n.useState)(void 0!==h&&h);return(0,n.useEffect)(()=>{x&&void 0===h&&C(!1)},[x]),(0,n.useEffect)(()=>{void 0!==h&&C(h)},[h]),(0,a.jsx)(l.lG,{open:x,...N,onOpenChange:()=>{x&&m()},children:(0,a.jsxs)(l.Cf,{ref:s,className:"p-0 gap-0 pb-5 !block",size:d,children:[(0,a.jsxs)(l.c7,{className:(0,r.cn)("border-b"),padding:"small",children:[(0,a.jsx)(l.L3,{children:t}),c&&(0,a.jsx)(l.rr,{children:c})]}),y&&(0,a.jsx)(o.Z,{type:b,label:y.title,description:y.description,className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0",...null==y?void 0:y.base}),j&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.OO,{padding:"small",children:j}),(0,a.jsx)(l.pf,{})]}),(0,a.jsxs)("div",{className:"flex gap-2 px-5 pt-5",children:[(0,a.jsx)(i.$,{size:"medium",block:!0,type:"default",disabled:w,onClick:()=>m(),children:p}),(0,a.jsx)(i.$,{block:!0,size:"medium",type:"destructive"===b?"danger":"warning"===b?"warning":"primary",htmlType:"submit",loading:w,disabled:w||v,onClick:e=>{e.preventDefault(),e.stopPropagation(),u(),void 0===h&&C(!0)},className:"truncate",children:f})]})]})})});c.displayName="ConfirmationModal";let d=c}},e=>{var s=s=>e(e.s=s);e.O(0,[89,2180,2147,726,735,9353,7176,3730,2056,6110,9844,9025,1501,8316,5297,4387,4100,445,2981,4181,556,4560,7795,698,6538,6692,4036,7872,5874,49,2174,971,9063,9124,651,4452,6389,6593,636,8792],()=>s(10093)),_N_E=e.O()}]);