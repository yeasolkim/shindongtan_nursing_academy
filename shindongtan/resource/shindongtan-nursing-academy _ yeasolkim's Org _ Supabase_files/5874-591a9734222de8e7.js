!function(){try{var n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},e=(new n.Error).stack;e&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[e]="c85a889c-a08b-4693-8491-a8726632a08d",n._sentryDebugIdIdentifier="sentry-dbid-c85a889c-a08b-4693-8491-a8726632a08d")}catch(n){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5874],{227:(n,e,t)=>{t.d(e,{X:()=>i});var a=t(72101),o=t(22548);class i{filter(n,e,t){return this.filters.push({column:n,operator:e,value:t}),this}match(n){return Object.entries(n).map(n=>{let[e,t]=n;this.filters.push({column:e,operator:"=",value:t})}),this}order(n,e){let t=!(arguments.length>2)||void 0===arguments[2]||arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.sorts.push({table:n,column:e,ascending:t,nullsFirst:a}),this}range(n,e){return this._getQueryModifier().range(n,e)}toSql(n){return this._getQueryModifier().toSql(n)}_getQueryModifier(){return new o.Y(this.table,this.action,{actionValue:this.actionValue,actionOptions:this.actionOptions,filters:this.filters,sorts:this.sorts})}constructor(n,e,t,o){(0,a._)(this,"table",void 0),(0,a._)(this,"action",void 0),(0,a._)(this,"actionValue",void 0),(0,a._)(this,"actionOptions",void 0),(0,a._)(this,"filters",void 0),(0,a._)(this,"sorts",void 0),this.table=n,this.action=e,this.actionValue=t,this.actionOptions=o,this.filters=[],this.sorts=[]}}},17613:(n,e,t)=>{t.r(e),t.d(e,{Query:()=>a.X,QueryAction:()=>c.x,QueryFilter:()=>i.X,QueryModifier:()=>r.Y,countQuery:()=>o.Mh,deleteQuery:()=>o.yN,insertQuery:()=>o.Go,selectQuery:()=>o.Z1,truncateQuery:()=>o.TV,updateQuery:()=>o.oR});var a=t(44741),o=t(46762),i=t(227),c=t(26243),r=t(22548)},22548:(n,e,t)=>{t.d(e,{Y:()=>i});var a=t(72101),o=t(46762);class i{range(n,e){return this.pagination={offset:n,limit:e-n+1},this}toSql(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{isCTE:!1,isFinal:!0};try{var e;let{actionValue:t,actionOptions:a,filters:i,sorts:c}=null!=(e=this.options)?e:{};switch(this.action){case"count":return(0,o.Mh)(this.table,{filters:i});case"delete":return(0,o.yN)(this.table,i,{returning:null==a?void 0:a.returning,enumArrayColumns:null==a?void 0:a.enumArrayColumns});case"insert":return(0,o.Go)(this.table,t,{returning:null==a?void 0:a.returning,enumArrayColumns:null==a?void 0:a.enumArrayColumns});case"select":return(0,o.Z1)(this.table,t,{filters:i,pagination:this.pagination,sorts:c},n.isFinal,n.isCTE);case"update":return(0,o.oR)(this.table,t,{filters:i,returning:null==a?void 0:a.returning,enumArrayColumns:null==a?void 0:a.enumArrayColumns});case"truncate":return(0,o.TV)(this.table,{cascade:null==a?void 0:a.cascade});default:return""}}catch(n){throw n}}constructor(n,e,t){(0,a._)(this,"table",void 0),(0,a._)(this,"action",void 0),(0,a._)(this,"options",void 0),(0,a._)(this,"pagination",void 0),this.table=n,this.action=e,this.options=t}}},26243:(n,e,t)=>{t.d(e,{x:()=>i});var a=t(72101),o=t(227);class i{count(){return new o.X(this.table,"count")}delete(n){return new o.X(this.table,"delete",void 0,n)}insert(n,e){return new o.X(this.table,"insert",n,e)}select(n){return new o.X(this.table,"select",n)}update(n,e){return new o.X(this.table,"update",n,e)}truncate(n){return new o.X(this.table,"truncate",void 0,n)}constructor(n){(0,a._)(this,"table",void 0),this.table=n}}},44741:(n,e,t)=>{t.d(e,{X:()=>o});var a=t(26243);class o{from(n,e){return new a.x({name:n,schema:null!=e?e:"public"})}}},45874:(n,e,t)=>{t.d(e,{A:()=>nF});var a={};t.r(a),t.d(a,{create:()=>w,list:()=>R,remove:()=>I,retrieve:()=>L,update:()=>C});var o={};t.r(o),t.d(o,{create:()=>P,list:()=>F,pgFunctionArrayZod:()=>U,pgFunctionCreateZod:()=>q,pgFunctionDeleteZod:()=>G,pgFunctionOptionalZod:()=>M,pgFunctionUpdateZod:()=>H,pgFunctionZod:()=>j,remove:()=>Y,retrieve:()=>k,update:()=>$});var i=t(48596);let c='\n-- Can\'t use pg_authid here since some managed Postgres providers don\'t expose it\n-- https://github.com/supabase/postgres-meta/issues/212\n\nselect\n  r.oid as id,\n  rolname as name,\n  rolsuper as "isSuperuser",\n  rolcreatedb as "canCreateDb",\n  rolcreaterole as "canCreateRole",\n  rolinherit as "inheritRole",\n  rolcanlogin as "canLogin",\n  rolreplication as "isReplicationRole",\n  rolbypassrls as "canBypassRls",\n  (\n    select\n      count(*)\n    from\n      pg_stat_activity\n    where\n      r.rolname = pg_stat_activity.usename\n  ) as "activeConnections",\n  case when rolconnlimit = -1 then current_setting(\'max_connections\') :: int8\n       else rolconnlimit\n  end as "connectionLimit",\n  rolvaliduntil as "validUntil",\n  coalesce(r_config.role_configs, \'{}\') as config\nfrom\n  pg_roles r\n  left join (\n    select\n      oid,\n      jsonb_object_agg(param, value) filter (where param is not null) as role_configs\n    from\n      (\n        select\n          oid,\n          (string_to_array(unnest(rolconfig), \'=\'))[1] as param,\n          (string_to_array(unnest(rolconfig), \'=\'))[2] as value\n        from\n          pg_roles\n      ) as _\n    group by\n      oid\n  ) r_config on r_config.oid = r.oid\n';var r=t(39353);let l=r.z.object({id:r.z.number(),name:r.z.string(),isSuperuser:r.z.boolean(),canCreateDb:r.z.boolean(),canCreateRole:r.z.boolean(),inheritRole:r.z.boolean(),canLogin:r.z.boolean(),isReplicationRole:r.z.boolean(),canBypassRls:r.z.boolean(),activeConnections:r.z.number(),connectionLimit:r.z.number(),validUntil:r.z.union([r.z.string(),r.z.null()]),config:r.z.record(r.z.string(),r.z.string())}),s=r.z.array(l),d=r.z.optional(l);function u(n){if("id"in n&&n.id)return"".concat((0,i.bD)("id")," = ").concat((0,i.eu)(n.id));if("name"in n&&n.name)return"".concat((0,i.bD)("name")," = ").concat((0,i.eu)(n.name));throw Error("Must provide either id or name")}let m=["information_schema","pg_catalog","pg_toast"],p=(n,e)=>"\nCOALESCE(\n  (\n    SELECT\n      array_agg(row_to_json(".concat(n,")) FILTER (WHERE ").concat(e,")\n    FROM\n      ").concat(n,"\n  ),\n  '{}'\n) AS ").concat(n);function g(n,e,t){return(t&&(e=t.concat(null!=e?e:[])),null==n?void 0:n.length)?"IN (".concat(n.map(i.eu).join(","),")"):(null==e?void 0:e.length)?"NOT IN (".concat(e.map(i.eu).join(","),")"):""}let _="\n-- Adapted from information_schema.columns\n\nSELECT\n  c.oid :: int8 AS table_id,\n  nc.nspname AS schema,\n  c.relname AS table,\n  (c.oid || '.' || a.attnum) AS id,\n  a.attnum AS ordinal_position,\n  a.attname AS name,\n  CASE\n    WHEN a.atthasdef THEN pg_get_expr(ad.adbin, ad.adrelid)\n    ELSE NULL\n  END AS default_value,\n  CASE\n    WHEN t.typtype = 'd' THEN CASE\n      WHEN bt.typelem <> 0 :: oid\n      AND bt.typlen = -1 THEN 'ARRAY'\n      WHEN nbt.nspname = 'pg_catalog' THEN format_type(t.typbasetype, NULL)\n      ELSE 'USER-DEFINED'\n    END\n    ELSE CASE\n      WHEN t.typelem <> 0 :: oid\n      AND t.typlen = -1 THEN 'ARRAY'\n      WHEN nt.nspname = 'pg_catalog' THEN format_type(a.atttypid, NULL)\n      ELSE 'USER-DEFINED'\n    END\n  END AS data_type,\n  COALESCE(bt.typname, t.typname) AS format,\n  a.attidentity IN ('a', 'd') AS is_identity,\n  CASE\n    a.attidentity\n    WHEN 'a' THEN 'ALWAYS'\n    WHEN 'd' THEN 'BY DEFAULT'\n    ELSE NULL\n  END AS identity_generation,\n  a.attgenerated IN ('s') AS is_generated,\n  NOT (\n    a.attnotnull\n    OR t.typtype = 'd' AND t.typnotnull\n  ) AS is_nullable,\n  (\n    c.relkind IN ('r', 'p')\n    OR c.relkind IN ('v', 'f') AND pg_column_is_updatable(c.oid, a.attnum, FALSE)\n  ) AS is_updatable,\n  uniques.table_id IS NOT NULL AS is_unique,\n  check_constraints.definition AS \"check\",\n  array_to_json(\n    array(\n      SELECT\n        enumlabel\n      FROM\n        pg_catalog.pg_enum enums\n      WHERE\n        enums.enumtypid = coalesce(bt.oid, t.oid)\n        OR enums.enumtypid = coalesce(bt.typelem, t.typelem)\n      ORDER BY\n        enums.enumsortorder\n    )\n  ) AS enums,\n  col_description(c.oid, a.attnum) AS comment\nFROM\n  pg_attribute a\n  LEFT JOIN pg_attrdef ad ON a.attrelid = ad.adrelid\n  AND a.attnum = ad.adnum\n  JOIN (\n    pg_class c\n    JOIN pg_namespace nc ON c.relnamespace = nc.oid\n  ) ON a.attrelid = c.oid\n  JOIN (\n    pg_type t\n    JOIN pg_namespace nt ON t.typnamespace = nt.oid\n  ) ON a.atttypid = t.oid\n  LEFT JOIN (\n    pg_type bt\n    JOIN pg_namespace nbt ON bt.typnamespace = nbt.oid\n  ) ON t.typtype = 'd'\n  AND t.typbasetype = bt.oid\n  LEFT JOIN (\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position\n    FROM pg_catalog.pg_constraint\n    WHERE contype = 'u' AND cardinality(conkey) = 1\n  ) AS uniques ON uniques.table_id = c.oid AND uniques.ordinal_position = a.attnum\n  LEFT JOIN (\n    -- We only select the first column check\n    SELECT DISTINCT ON (table_id, ordinal_position)\n      conrelid AS table_id,\n      conkey[1] AS ordinal_position,\n      substring(\n        pg_get_constraintdef(pg_constraint.oid, true),\n        8,\n        length(pg_get_constraintdef(pg_constraint.oid, true)) - 8\n      ) AS \"definition\"\n    FROM pg_constraint\n    WHERE contype = 'c' AND cardinality(conkey) = 1\n    ORDER BY table_id, ordinal_position, oid asc\n  ) AS check_constraints ON check_constraints.table_id = c.oid AND check_constraints.ordinal_position = a.attnum\nWHERE\n  NOT pg_is_other_temp_schema(nc.oid)\n  AND a.attnum > 0\n  AND NOT a.attisdropped\n  AND (c.relkind IN ('r', 'v', 'm', 'f', 'p'))\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_column_privilege(\n      c.oid,\n      a.attnum,\n      'SELECT, INSERT, UPDATE, REFERENCES'\n    )\n  )\n",b=r.z.object({id:r.z.string(),table_id:r.z.number(),schema:r.z.string(),table:r.z.string(),name:r.z.string(),ordinal_position:r.z.number(),data_type:r.z.string(),format:r.z.string(),is_identity:r.z.boolean(),identity_generation:r.z.string().nullable(),is_generated:r.z.boolean(),is_nullable:r.z.boolean(),is_updatable:r.z.boolean(),is_unique:r.z.boolean(),check:r.z.string().nullable(),default_value:r.z.any().nullable(),enums:r.z.array(r.z.string()),comment:r.z.string().nullable()}),E=r.z.array(b),f=r.z.optional(b),h=n=>n.endsWith("[]")?"".concat((0,i.bD)(n.slice(0,-2)),"[]"):n.includes(".")?n:(0,i.bD)(n),A="\n-- Adapted from information_schema.schemata\n\nselect\n  n.oid as id,\n  n.nspname as name,\n  u.rolname as owner\nfrom\n  pg_namespace n,\n  pg_roles u\nwhere\n  n.nspowner = u.oid\n  and (\n    pg_has_role(n.nspowner, 'USAGE')\n    or has_schema_privilege(n.oid, 'CREATE, USAGE')\n  )\n  and not pg_catalog.starts_with(n.nspname, 'pg_temp_')\n  and not pg_catalog.starts_with(n.nspname, 'pg_toast_temp_')\n",z=r.z.object({id:r.z.number(),name:r.z.string(),owner:r.z.string()}),N=r.z.array(z),T=r.z.optional(z),y=r.z.object({table_id:r.z.number(),name:r.z.string(),schema:r.z.string(),table_name:r.z.string()}),v=r.z.object({id:r.z.number(),constraint_name:r.z.string(),source_schema:r.z.string(),source_table_name:r.z.string(),source_column_name:r.z.string(),target_table_schema:r.z.string(),target_table_name:r.z.string(),target_column_name:r.z.string()}),S=r.z.object({id:r.z.number(),schema:r.z.string(),name:r.z.string(),rls_enabled:r.z.boolean(),rls_forced:r.z.boolean(),replica_identity:r.z.enum(["DEFAULT","INDEX","FULL","NOTHING"]),bytes:r.z.number(),size:r.z.string(),live_rows_estimate:r.z.number(),dead_rows_estimate:r.z.number(),comment:r.z.string().nullable(),primary_keys:r.z.array(y),relationships:r.z.array(v),columns:E.optional()}),D=r.z.array(S);function R(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o,includeColumns:i=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=O({includeColumns:i}),r=g(e,t,n?void 0:m);return r&&(c+=" where schema ".concat(r)),a&&(c+=" limit ".concat(a)),o&&(c+=" offset ".concat(o)),{sql:c,zod:D}}function L(n){let e=function(n){if("id"in n&&n.id)return"".concat((0,i.bD)("id")," = ").concat((0,i.eu)(n.id));if("name"in n&&n.name&&n.schema)return"".concat((0,i.bD)("name")," = ").concat((0,i.eu)(n.name)," and ").concat((0,i.bD)("schema")," = ").concat((0,i.eu)(n.schema));throw Error("Must provide either id or name and schema")}(n);return{sql:"".concat(O({includeColumns:!0})," where ").concat(e,";"),zod:S}}function I(n){let{cascade:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{sql:"DROP TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.name)," ").concat(e?"CASCADE":"RESTRICT",";")}}let O=n=>{let{includeColumns:e}=n;return"\n  with tables as (".concat("\nSELECT\n  c.oid :: int8 AS id,\n  nc.nspname AS schema,\n  c.relname AS name,\n  c.relrowsecurity AS rls_enabled,\n  c.relforcerowsecurity AS rls_forced,\n  CASE\n    WHEN c.relreplident = 'd' THEN 'DEFAULT'\n    WHEN c.relreplident = 'i' THEN 'INDEX'\n    WHEN c.relreplident = 'f' THEN 'FULL'\n    ELSE 'NOTHING'\n  END AS replica_identity,\n  pg_total_relation_size(format('%I.%I', nc.nspname, c.relname)) :: int8 AS bytes,\n  pg_size_pretty(\n    pg_total_relation_size(format('%I.%I', nc.nspname, c.relname))\n  ) AS size,\n  pg_stat_get_live_tuples(c.oid) AS live_rows_estimate,\n  pg_stat_get_dead_tuples(c.oid) AS dead_rows_estimate,\n  obj_description(c.oid) AS comment,\n  coalesce(pk.primary_keys, '[]') as primary_keys,\n  coalesce(\n    jsonb_agg(relationships) filter (where relationships is not null),\n    '[]'\n  ) as relationships\nFROM\n  pg_namespace nc\n  JOIN pg_class c ON nc.oid = c.relnamespace\n  left join (\n    select\n      table_id,\n      jsonb_agg(_pk.*) as primary_keys\n    from (\n      select\n        n.nspname as schema,\n        c.relname as table_name,\n        a.attname as name,\n        c.oid :: int8 as table_id\n      from\n        pg_index i,\n        pg_class c,\n        pg_attribute a,\n        pg_namespace n\n      where\n        i.indrelid = c.oid\n        and c.relnamespace = n.oid\n        and a.attrelid = c.oid\n        and a.attnum = any (i.indkey)\n        and i.indisprimary\n    ) as _pk\n    group by table_id\n  ) as pk\n  on pk.table_id = c.oid\n  left join (\n    select\n      c.oid :: int8 as id,\n      c.conname as constraint_name,\n      nsa.nspname as source_schema,\n      csa.relname as source_table_name,\n      sa.attname as source_column_name,\n      nta.nspname as target_table_schema,\n      cta.relname as target_table_name,\n      ta.attname as target_column_name\n    from\n      pg_constraint c\n    join (\n      pg_attribute sa\n      join pg_class csa on sa.attrelid = csa.oid\n      join pg_namespace nsa on csa.relnamespace = nsa.oid\n    ) on sa.attrelid = c.conrelid and sa.attnum = any (c.conkey)\n    join (\n      pg_attribute ta\n      join pg_class cta on ta.attrelid = cta.oid\n      join pg_namespace nta on cta.relnamespace = nta.oid\n    ) on ta.attrelid = c.confrelid and ta.attnum = any (c.confkey)\n    where\n      c.contype = 'f'\n  ) as relationships\n  on (relationships.source_schema = nc.nspname and relationships.source_table_name = c.relname)\n  or (relationships.target_table_schema = nc.nspname and relationships.target_table_name = c.relname)\nWHERE\n  c.relkind IN ('r', 'p')\n  AND NOT pg_is_other_temp_schema(nc.oid)\n  AND (\n    pg_has_role(c.relowner, 'USAGE')\n    OR has_table_privilege(\n      c.oid,\n      'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n    )\n    OR has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n  )\ngroup by\n  c.oid,\n  c.relname,\n  c.relrowsecurity,\n  c.relforcerowsecurity,\n  c.relreplident,\n  nc.nspname,\n  pk.primary_keys\n",")\n  ").concat(e?", columns as (".concat(_,")"):"","\n  select\n    *\n    ").concat(e?", ".concat(p("columns","columns.table_id = tables.id")):"","\n  from tables")};function w(n){let{name:e,schema:t="public",comment:a}=n,o="CREATE TABLE ".concat((0,i.bD)(t),".").concat((0,i.bD)(e)," ();"),c=void 0===a?"":"COMMENT ON TABLE ".concat((0,i.bD)(t),".").concat((0,i.bD)(e)," IS ").concat((0,i.eu)(a),";");return{sql:"BEGIN; ".concat(o," ").concat(c," COMMIT;")}}function C(n,e){let{name:t,schema:a,rls_enabled:o,rls_forced:c,replica_identity:r,replica_identity_index:l,primary_keys:s,comment:d}=e,u="ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.name)),m=void 0===a?"":"".concat(u," SET SCHEMA ").concat((0,i.bD)(a),";"),p="";if(void 0!==t&&t!==n.name){let e=void 0===a?n.schema:a;p="ALTER TABLE ".concat((0,i.bD)(e),".").concat((0,i.bD)(n.name)," RENAME TO ").concat((0,i.bD)(t),";")}let g="";void 0!==o&&(g=o?"".concat(u," ENABLE ROW LEVEL SECURITY;"):"".concat(u," DISABLE ROW LEVEL SECURITY;"));let _="";void 0!==c&&(_=c?"".concat(u," FORCE ROW LEVEL SECURITY;"):"".concat(u," NO FORCE ROW LEVEL SECURITY;"));let b="";void 0===r||(b="INDEX"===r?"".concat(u," REPLICA IDENTITY USING INDEX ").concat(l,";"):"".concat(u," REPLICA IDENTITY ").concat(r,";"));let E="";void 0===s||(E+="\nDO $$\nDECLARE\n  r record;\nBEGIN\n  SELECT conname\n    INTO r\n    FROM pg_constraint\n    WHERE contype = 'p' AND conrelid = ".concat((0,i.eu)(n.id),";\n  IF r IS NOT NULL THEN\n    EXECUTE ").concat((0,i.eu)("".concat(u," DROP CONSTRAINT "))," || quote_ident(r.conname);\n  END IF;\nEND\n$$;\n"),0===s.length||(E+="".concat(u," ADD PRIMARY KEY (").concat(s.map(n=>(0,i.bD)(n.name)).join(","),");")));let f=void 0===d?"":"COMMENT ON TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.name)," IS ").concat((0,i.eu)(d),";");return{sql:"\nBEGIN;\n  ".concat(g,"\n  ").concat(_,"\n  ").concat(b,"\n  ").concat(E,"\n  ").concat(f,"\n  ").concat(m,"\n  ").concat(p,"\nCOMMIT;")}}let x="\n-- CTE with sane arg_modes, arg_names, and arg_types.\n-- All three are always of the same length.\n-- All three include all args, including OUT and TABLE args.\nwith functions as (\n  select\n    *,\n    -- proargmodes is null when all arg modes are IN\n    coalesce(\n      p.proargmodes,\n      array_fill('i'::text, array[cardinality(coalesce(p.proallargtypes, p.proargtypes))])\n    ) as arg_modes,\n    -- proargnames is null when all args are unnamed\n    coalesce(\n      p.proargnames,\n      array_fill(''::text, array[cardinality(coalesce(p.proallargtypes, p.proargtypes))])\n    ) as arg_names,\n    -- proallargtypes is null when all arg modes are IN\n    coalesce(p.proallargtypes, p.proargtypes) as arg_types,\n    array_cat(\n      array_fill(false, array[pronargs - pronargdefaults]),\n      array_fill(true, array[pronargdefaults])) as arg_has_defaults\n  from\n    pg_proc as p\n  where\n    p.prokind = 'f'\n)\nselect\n  f.oid as id,\n  n.nspname as schema,\n  f.proname as name,\n  l.lanname as language,\n  case\n    when l.lanname = 'internal' then ''\n    else f.prosrc\n  end as definition,\n  case\n    when l.lanname = 'internal' then f.prosrc\n    else pg_get_functiondef(f.oid)\n  end as complete_statement,\n  coalesce(f_args.args, '[]') as args,\n  pg_get_function_arguments(f.oid) as argument_types,\n  pg_get_function_identity_arguments(f.oid) as identity_argument_types,\n  f.prorettype as return_type_id,\n  pg_get_function_result(f.oid) as return_type,\n  nullif(rt.typrelid, 0) as return_type_relation_id,\n  f.proretset as is_set_returning_function,\n  case\n    when f.provolatile = 'i' then 'IMMUTABLE'\n    when f.provolatile = 's' then 'STABLE'\n    when f.provolatile = 'v' then 'VOLATILE'\n  end as behavior,\n  f.prosecdef as security_definer,\n  f_config.config_params as config_params\nfrom\n  functions f\n  left join pg_namespace n on f.pronamespace = n.oid\n  left join pg_language l on f.prolang = l.oid\n  left join pg_type rt on rt.oid = f.prorettype\n  left join (\n    select\n      oid,\n      jsonb_object_agg(param, value) filter (where param is not null) as config_params\n    from\n      (\n        select\n          oid,\n          (string_to_array(unnest(proconfig), '='))[1] as param,\n          (string_to_array(unnest(proconfig), '='))[2] as value\n        from\n          functions\n      ) as t\n    group by\n      oid\n  ) f_config on f_config.oid = f.oid\n  left join (\n    select\n      oid,\n      jsonb_agg(jsonb_build_object(\n        'mode', t2.mode,\n        'name', name,\n        'type_id', type_id,\n        -- Cast null into false boolean\n        'has_default', COALESCE(has_default, false)\n      )) as args\n    from\n      (\n        select\n          oid,\n          unnest(arg_modes) as mode,\n          unnest(arg_names) as name,\n          -- Coming from: coalesce(p.proallargtypes, p.proargtypes) postgres won't automatically assume\n          -- integer, we need to cast it to be properly parsed\n          unnest(arg_types)::int8 as type_id,\n          unnest(arg_has_defaults) as has_default\n        from\n          functions\n      ) as t1,\n      lateral (\n        select\n          case\n            when t1.mode = 'i' then 'in'\n            when t1.mode = 'o' then 'out'\n            when t1.mode = 'b' then 'inout'\n            when t1.mode = 'v' then 'variadic'\n            else 'table'\n          end as mode\n      ) as t2\n    group by\n      t1.oid\n  ) f_args on f_args.oid = f.oid\n",j=r.z.object({id:r.z.number(),schema:r.z.string(),name:r.z.string(),language:r.z.string(),definition:r.z.string(),complete_statement:r.z.string(),args:r.z.array(r.z.object({mode:r.z.union([r.z.literal("in"),r.z.literal("out"),r.z.literal("inout"),r.z.literal("variadic"),r.z.literal("table")]),name:r.z.string(),type_id:r.z.number(),has_default:r.z.boolean()})),argument_types:r.z.string(),identity_argument_types:r.z.string(),return_type_id:r.z.number(),return_type:r.z.string(),return_type_relation_id:r.z.union([r.z.number(),r.z.null()]),is_set_returning_function:r.z.boolean(),behavior:r.z.union([r.z.literal("IMMUTABLE"),r.z.literal("STABLE"),r.z.literal("VOLATILE")]),security_definer:r.z.boolean(),config_params:r.z.union([r.z.record(r.z.string(),r.z.string()),r.z.null()])}),U=r.z.array(j),M=r.z.optional(j);function F(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i="\n    with f as (\n      ".concat(x,"\n    )\n    select\n      f.*\n    from f\n  "),c=g(e,t,n?void 0:m);return c&&(i+=" where schema ".concat(c)),a&&(i="".concat(i," limit ").concat(a)),o&&(i="".concat(i," offset ").concat(o)),{sql:i,zod:U}}function k(n){let{id:e,name:t,schema:a="public",args:o=[]}=n;if(e)return{sql:"\n      with f as (\n        ".concat(x,"\n      )\n      select\n        f.*\n      from f where id = ").concat((0,i.eu)(e),";"),zod:M};if(t&&a&&o)return{sql:"with f as (\n      ".concat(x,"\n    )\n    select\n      f.*\n    from f join pg_proc as p on id = p.oid where schema = ").concat((0,i.eu)(a)," and name = ").concat((0,i.eu)(t)," and p.proargtypes::text = ").concat(o.length?"(\n          select string_agg(type_oid::text, ' ') from (\n            select (\n              split_args.arr[\n                array_length(\n                  split_args.arr,\n                  1\n                )\n              ]::regtype::oid\n            ) as type_oid from (\n              select string_to_array(\n                unnest(\n                  array[".concat(o.map(i.eu),"]\n                ),\n                ' '\n              ) as arr\n            ) as split_args\n          ) args\n        )"):(0,i.eu)("")),zod:M};throw Error("Must provide either id or name and schema")}let q=r.z.object({name:r.z.string(),definition:r.z.string(),args:r.z.array(r.z.string()).optional(),behavior:r.z.enum(["IMMUTABLE","STABLE","VOLATILE"]).optional(),config_params:r.z.record(r.z.string(),r.z.string()).optional(),schema:r.z.string().optional(),language:r.z.string().optional(),return_type:r.z.string().optional(),security_definer:r.z.boolean().optional()});function B(n){let{name:e,schema:t,args:a,definition:o,return_type:c,language:r,behavior:l,security_definer:s,config_params:d}=n,{replace:u=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"\n    CREATE ".concat(u?"OR REPLACE":""," FUNCTION ").concat((0,i.bD)(t),".").concat((0,i.bD)(e),"(").concat((null==a?void 0:a.join(", "))||"",")\n    RETURNS ").concat(c,"\n    AS ").concat((0,i.eu)(o),"\n    LANGUAGE ").concat(r,"\n    ").concat(l,"\n    CALLED ON NULL INPUT\n    ").concat(s?"SECURITY DEFINER":"SECURITY INVOKER","\n    ").concat(d?Object.entries(d).map(n=>{let[e,t]=n;return"SET ".concat(e," ").concat("FROM CURRENT"===t?"FROM CURRENT":"TO "+('""'===t?"''":t))}).join("\n"):"",";\n  ")}function P(n){let{name:e,schema:t="public",args:a=[],definition:o,return_type:i="void",language:c="sql",behavior:l="VOLATILE",security_definer:s=!1,config_params:d={}}=n;return{sql:B({name:e,schema:t,args:a,definition:o,return_type:i,language:c,behavior:l,security_definer:s,config_params:d}),zod:r.z.void()}}let H=r.z.object({name:r.z.string().optional(),schema:r.z.string().optional(),definition:r.z.string().optional()});function $(n,e){var t;let{name:a,schema:o,definition:c}=e,l=n.argument_types.split(", "),s=n.identity_argument_types,d="string"==typeof c?B({...n,definition:c,args:l,config_params:null!=(t=n.config_params)?t:{}},{replace:!0}):"",u=a&&a!==n.name?"ALTER FUNCTION ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.name),"(").concat(s,") RENAME TO ").concat((0,i.bD)(a),";"):"",m=o&&o!==n.schema?"ALTER FUNCTION ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(a||n.name),"(").concat(s,")  SET SCHEMA ").concat((0,i.bD)(o),";"):"";return{sql:"\n    DO LANGUAGE plpgsql $$\n    BEGIN\n      IF ".concat("string"==typeof c?"TRUE":"FALSE"," THEN\n        ").concat(d,"\n\n        IF (\n          SELECT id\n          FROM (").concat(x,") AS f\n          WHERE f.schema = ").concat((0,i.eu)(n.schema),"\n          AND f.name = ").concat((0,i.eu)(n.name),"\n          AND f.identity_argument_types = ").concat((0,i.eu)(s),"\n        ) != ").concat(n.id," THEN\n          RAISE EXCEPTION 'Cannot find function \"").concat(n.schema,'"."').concat(n.name,'"(').concat(s,")';\n        END IF;\n      END IF;\n\n      ").concat(u,"\n\n      ").concat(m,"\n    END;\n    $$;\n  "),zod:r.z.void()}}let G=r.z.object({cascade:r.z.boolean().default(!1).optional()});function Y(n){let{cascade:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{sql:"DROP FUNCTION ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.name),"\n  (").concat(n.identity_argument_types,")\n  ").concat(e?"CASCADE":"RESTRICT",";"),zod:r.z.void()}}let W="\n-- Despite the name `table_privileges`, this includes other kinds of relations:\n-- views, matviews, etc. \"Relation privileges\" just doesn't roll off the tongue.\n--\n-- For each relation, get its relacl in a jsonb format,\n-- e.g.\n--\n-- '{postgres=arwdDxt/postgres}'\n--\n-- becomes\n--\n-- [\n--   {\n--     \"grantee\": \"postgres\",\n--     \"grantor\": \"postgres\",\n--     \"is_grantable\": false,\n--     \"privilege_type\": \"INSERT\"\n--   },\n--   ...\n-- ]\nselect\n  c.oid as relation_id,\n  nc.nspname as schema,\n  c.relname as name,\n  case\n    when c.relkind = 'r' then 'table'\n    when c.relkind = 'v' then 'view'\n    when c.relkind = 'm' then 'materialized_view'\n    when c.relkind = 'f' then 'foreign_table'\n    when c.relkind = 'p' then 'partitioned_table'\n  end as kind,\n  coalesce(\n    jsonb_agg(\n      jsonb_build_object(\n        'grantor', grantor.rolname,\n        'grantee', grantee.rolname,\n        'privilege_type', _priv.privilege_type,\n        'is_grantable', _priv.is_grantable\n      )\n    ) filter (where _priv is not null),\n    '[]'\n  ) as privileges\nfrom pg_class c\njoin pg_namespace as nc\n  on nc.oid = c.relnamespace\nleft join lateral (\n  select grantor, grantee, privilege_type, is_grantable\n  from aclexplode(coalesce(c.relacl, acldefault('r', c.relowner)))\n) as _priv on true\nleft join pg_roles as grantor\n  on grantor.oid = _priv.grantor\nleft join (\n  select\n    pg_roles.oid,\n    pg_roles.rolname\n  from pg_roles\n  union all\n  select\n    (0)::oid as oid, 'PUBLIC'\n) as grantee (oid, rolname)\n  on grantee.oid = _priv.grantee\nwhere c.relkind in ('r', 'v', 'm', 'f', 'p')\n  and not pg_is_other_temp_schema(c.relnamespace)\n  and (\n    pg_has_role(c.relowner, 'USAGE')\n    or has_table_privilege(\n      c.oid,\n      'SELECT, INSERT, UPDATE, DELETE, TRUNCATE, REFERENCES, TRIGGER'\n      || case when current_setting('server_version_num')::int4 >= 170000 then ', MAINTAIN' else '' end\n    )\n    or has_any_column_privilege(c.oid, 'SELECT, INSERT, UPDATE, REFERENCES')\n  )\ngroup by\n  c.oid,\n  nc.nspname,\n  c.relname,\n  c.relkind\n",J=r.z.object({relation_id:r.z.number(),schema:r.z.string(),name:r.z.string(),kind:r.z.union([r.z.literal("table"),r.z.literal("view"),r.z.literal("materialized_view"),r.z.literal("foreign_table"),r.z.literal("partitioned_table")]),privileges:r.z.array(r.z.object({grantor:r.z.string(),grantee:r.z.string(),privilege_type:r.z.union([r.z.literal("SELECT"),r.z.literal("INSERT"),r.z.literal("UPDATE"),r.z.literal("DELETE"),r.z.literal("TRUNCATE"),r.z.literal("REFERENCES"),r.z.literal("TRIGGER"),r.z.literal("MAINTAIN")]),is_grantable:r.z.boolean()}))}),V=r.z.array(J),X=r.z.optional(J),Q="\nSELECT\n  p.oid :: int8 AS id,\n  p.pubname AS name,\n  p.pubowner::regrole::text AS owner,\n  p.pubinsert AS publish_insert,\n  p.pubupdate AS publish_update,\n  p.pubdelete AS publish_delete,\n  p.pubtruncate AS publish_truncate,\n  CASE\n    WHEN p.puballtables THEN NULL\n    ELSE pr.tables\n  END AS tables\nFROM\n  pg_catalog.pg_publication AS p\n  LEFT JOIN LATERAL (\n    SELECT\n      COALESCE(\n        array_agg(\n          json_build_object(\n            'id',\n            c.oid :: int8,\n            'name',\n            c.relname,\n            'schema',\n            nc.nspname\n          )\n        ),\n        '{}'\n      ) AS tables\n    FROM\n      pg_catalog.pg_publication_rel AS pr\n      JOIN pg_class AS c ON pr.prrelid = c.oid\n      join pg_namespace as nc on c.relnamespace = nc.oid\n    WHERE\n      pr.prpubid = p.oid\n  ) AS pr ON 1 = 1\n",Z=r.z.object({id:r.z.number().optional(),name:r.z.string(),schema:r.z.string()}),K=r.z.object({id:r.z.number(),name:r.z.string(),owner:r.z.string(),publish_insert:r.z.boolean(),publish_update:r.z.boolean(),publish_delete:r.z.boolean(),publish_truncate:r.z.boolean(),tables:r.z.array(Z).nullable()}),nn=r.z.array(K),ne=r.z.optional(K),nt="\nSELECT\n  e.name,\n  n.nspname AS schema,\n  e.default_version,\n  x.extversion AS installed_version,\n  e.comment\nFROM\n  pg_available_extensions() e(name, default_version, comment)\n  LEFT JOIN pg_extension x ON e.name = x.extname\n  LEFT JOIN pg_namespace n ON x.extnamespace = n.oid\n",na=r.z.object({name:r.z.string(),schema:r.z.string().nullable(),default_version:r.z.string(),installed_version:r.z.string().nullable(),comment:r.z.string()}),no=r.z.array(na),ni=r.z.optional(na),nc=r.z.object({name:r.z.string(),setting:r.z.string(),category:r.z.string(),group:r.z.string(),subgroup:r.z.string(),unit:r.z.string().nullable(),short_desc:r.z.string(),extra_desc:r.z.string().nullable(),context:r.z.string(),vartype:r.z.string(),source:r.z.string(),min_val:r.z.string().nullable(),max_val:r.z.string().nullable(),enumvals:r.z.array(r.z.string()).nullable(),boot_val:r.z.string().nullable(),reset_val:r.z.string().nullable(),sourcefile:r.z.string().nullable(),sourceline:r.z.number().nullable(),pending_restart:r.z.boolean()}),nr=r.z.array(nc),nl=r.z.object({id:r.z.number(),schema:r.z.string(),name:r.z.string(),is_populated:r.z.boolean(),comment:r.z.string().nullable(),columns:E.optional()}),ns=r.z.array(nl),nd=r.z.optional(nl),nu=n=>{let{includeColumns:e}=n;return"\nwith materialized_views as (".concat("\nselect\n  c.oid::int8 as id,\n  n.nspname as schema,\n  c.relname as name,\n  c.relispopulated as is_populated,\n  obj_description(c.oid) as comment\nfrom\n  pg_class c\n  join pg_namespace n on n.oid = c.relnamespace\nwhere\n  c.relkind = 'm'\n",")\n  ").concat(e?", columns as (".concat(_,")"):"","\nselect\n  *\n  ").concat(e?", ".concat(p("columns","columns.table_id = materialized_views.id")):"","\nfrom materialized_views")},nm=r.z.object({id:r.z.number(),schema:r.z.string(),name:r.z.string(),comment:r.z.string().nullable(),columns:E.optional()}),np=r.z.array(nm),ng=r.z.optional(nm),n_=n=>{let{includeColumns:e}=n;return"\nwith foreign_tables as (".concat("\nselect\n  c.oid::int8 as id,\n  n.nspname as schema,\n  c.relname as name,\n  obj_description(c.oid) as comment\nfrom\n  pg_class c\n  join pg_namespace n on n.oid = c.relnamespace\nwhere\n  c.relkind = 'f'\n",")\n  ").concat(e?", columns as (".concat(_,")"):"","\nselect\n  *\n  ").concat(e?", ".concat(p("columns","columns.table_id = foreign_tables.id")):"","\nfrom foreign_tables")},nb=r.z.object({id:r.z.number(),schema:r.z.string(),name:r.z.string(),is_updatable:r.z.boolean(),comment:r.z.string().nullable(),columns:E.optional()}),nE=r.z.array(nb),nf=r.z.optional(nb),nh=n=>{let{includeColumns:e}=n;return"\nwith views as (".concat("\nSELECT\n  c.oid :: int8 AS id,\n  n.nspname AS schema,\n  c.relname AS name,\n  (pg_relation_is_updatable(c.oid, false) & 20) = 20 AS is_updatable,\n  obj_description(c.oid) AS comment\nFROM\n  pg_class c\n  JOIN pg_namespace n ON n.oid = c.relnamespace\nWHERE\n  c.relkind = 'v'\n",")\n  ").concat(e?", columns as (".concat(_,")"):"","\nselect\n  *\n  ").concat(e?", ".concat(p("columns","columns.table_id = views.id")):"","\nfrom views")},nA="\nselect\n  pol.oid :: int8 as id,\n  n.nspname as schema,\n  c.relname as table,\n  c.oid :: int8 as table_id,\n  pol.polname as name,\n  case\n    when pol.polpermissive then 'PERMISSIVE'::text\n    else 'RESTRICTIVE'::text\n  end as action,\n  case\n    when pol.polroles = '{0}'::oid[] then array_to_json(string_to_array('public'::text, ''::text)::name[])\n    else array_to_json(array(\n      select pg_roles.rolname\n      from pg_roles\n      where pg_roles.oid = any(pol.polroles)\n      order by pg_roles.rolname\n    ))\n  end as roles,\n  case pol.polcmd\n    when 'r'::\"char\" then 'SELECT'::text\n    when 'a'::\"char\" then 'INSERT'::text\n    when 'w'::\"char\" then 'UPDATE'::text\n    when 'd'::\"char\" then 'DELETE'::text\n    when '*'::\"char\" then 'ALL'::text\n    else null::text\n  end as command,\n  pg_get_expr(pol.polqual, pol.polrelid) as definition,\n  pg_get_expr(pol.polwithcheck, pol.polrelid) as check\nfrom\n  pg_policy pol\n  join pg_class c on c.oid = pol.polrelid\n  left join pg_namespace n on n.oid = c.relnamespace\n",nz=r.z.object({id:r.z.number(),schema:r.z.string(),table:r.z.string(),table_id:r.z.number(),name:r.z.string(),action:r.z.union([r.z.literal("PERMISSIVE"),r.z.literal("RESTRICTIVE")]),roles:r.z.array(r.z.string()),command:r.z.union([r.z.literal("SELECT"),r.z.literal("INSERT"),r.z.literal("UPDATE"),r.z.literal("DELETE"),r.z.literal("ALL")]),definition:r.z.union([r.z.string(),r.z.null()]),check:r.z.union([r.z.string(),r.z.null()])}),nN=r.z.array(nz),nT=r.z.optional(nz),ny="\nSELECT\n  pg_t.oid AS id,\n  pg_t.tgrelid AS table_id,\n  CASE\n    WHEN pg_t.tgenabled = 'D' THEN 'DISABLED'\n    WHEN pg_t.tgenabled = 'O' THEN 'ORIGIN'\n    WHEN pg_t.tgenabled = 'R' THEN 'REPLICA'\n    WHEN pg_t.tgenabled = 'A' THEN 'ALWAYS'\n  END AS enabled_mode,\n  (\n    STRING_TO_ARRAY(\n      ENCODE(pg_t.tgargs, 'escape'), '\\000'\n    )\n  )[:pg_t.tgnargs] AS function_args,\n  is_t.trigger_name AS name,\n  is_t.event_object_table AS table,\n  is_t.event_object_schema AS schema,\n  is_t.action_condition AS condition,\n  is_t.action_orientation AS orientation,\n  is_t.action_timing AS activation,\n  ARRAY_AGG(is_t.event_manipulation)::text[] AS events,\n  pg_p.proname AS function_name,\n  pg_n.nspname AS function_schema\nFROM\n  pg_trigger AS pg_t\nJOIN\n  pg_class AS pg_c\nON pg_t.tgrelid = pg_c.oid\nJOIN information_schema.triggers AS is_t\nON is_t.trigger_name = pg_t.tgname\nAND pg_c.relname = is_t.event_object_table\nAND pg_c.relnamespace = (quote_ident(is_t.event_object_schema))::regnamespace\nJOIN pg_proc AS pg_p\nON pg_t.tgfoid = pg_p.oid\nJOIN pg_namespace AS pg_n\nON pg_p.pronamespace = pg_n.oid\nGROUP BY\n  pg_t.oid,\n  pg_t.tgrelid,\n  pg_t.tgenabled,\n  pg_t.tgargs,\n  pg_t.tgnargs,\n  is_t.trigger_name,\n  is_t.event_object_table,\n  is_t.event_object_schema,\n  is_t.action_condition,\n  is_t.action_orientation,\n  is_t.action_timing,\n  pg_p.proname,\n  pg_n.nspname\n",nv=r.z.object({id:r.z.number(),table_id:r.z.number(),enabled_mode:r.z.enum(["DISABLED","ORIGIN","REPLICA","ALWAYS"]),function_args:r.z.array(r.z.string()),name:r.z.string(),table:r.z.string(),schema:r.z.string(),condition:r.z.string().nullable(),orientation:r.z.string(),activation:r.z.string(),events:r.z.array(r.z.string()),function_name:r.z.string(),function_schema:r.z.string()}),nS=r.z.array(nv),nD=r.z.optional(nv);r.z.object({name:r.z.string(),schema:r.z.string().optional().default("public"),table:r.z.string(),function_schema:r.z.string().optional().default("public"),function_name:r.z.string(),function_args:r.z.array(r.z.string()).optional(),activation:r.z.enum(["BEFORE","AFTER","INSTEAD OF"]),events:r.z.array(r.z.string()),orientation:r.z.enum(["ROW","STATEMENT"]).optional(),condition:r.z.string().optional()}),r.z.object({name:r.z.string().optional(),enabled_mode:r.z.enum(["ORIGIN","REPLICA","ALWAYS","DISABLED"]).optional()});let nR=r.z.object({id:r.z.number(),name:r.z.string(),schema:r.z.string(),format:r.z.string(),enums:r.z.array(r.z.string()),attributes:r.z.array(r.z.object({name:r.z.string(),type_id:r.z.number()})),comment:r.z.string().nullable()}),nL=r.z.array(nR),nI=r.z.object({version:r.z.string(),version_number:r.z.number(),active_connections:r.z.number(),max_connections:r.z.number()}),nO="\n  SELECT\n    idx.indexrelid::int8 AS id,\n    idx.indrelid::int8 AS table_id,\n    n.nspname AS schema,\n    idx.indnatts AS number_of_attributes,\n    idx.indnkeyatts AS number_of_key_attributes,\n    idx.indisunique AS is_unique,\n    idx.indisprimary AS is_primary,\n    idx.indisexclusion AS is_exclusion,\n    idx.indimmediate AS is_immediate,\n    idx.indisclustered AS is_clustered,\n    idx.indisvalid AS is_valid,\n    idx.indcheckxmin AS check_xmin,\n    idx.indisready AS is_ready,\n    idx.indislive AS is_live,\n    idx.indisreplident AS is_replica_identity,\n    idx.indkey::smallint[] AS key_attributes,\n    idx.indcollation::integer[] AS collation,\n    idx.indclass::integer[] AS class,\n    idx.indoption::smallint[] AS options,\n    idx.indpred AS index_predicate,\n    obj_description(idx.indexrelid, 'pg_class') AS comment,\n    ix.indexdef as index_definition,\n    am.amname AS access_method,\n    jsonb_agg(\n      jsonb_build_object(\n        'attribute_number', a.attnum,\n        'attribute_name', a.attname,\n        'data_type', format_type(a.atttypid, a.atttypmod)\n      )\n      ORDER BY a.attnum\n    ) AS index_attributes\n  FROM\n    pg_index idx\n    JOIN pg_class c ON c.oid = idx.indexrelid\n    JOIN pg_namespace n ON c.relnamespace = n.oid\n    JOIN pg_am am ON c.relam = am.oid\n    JOIN pg_attribute a ON a.attrelid = c.oid AND a.attnum = ANY(idx.indkey)\n    JOIN pg_indexes ix ON c.relname = ix.indexname\n  GROUP BY\n    idx.indexrelid, idx.indrelid, n.nspname, idx.indnatts, idx.indnkeyatts, idx.indisunique, \n    idx.indisprimary, idx.indisexclusion, idx.indimmediate, idx.indisclustered, idx.indisvalid, \n    idx.indcheckxmin, idx.indisready, idx.indislive, idx.indisreplident, idx.indkey, \n    idx.indcollation, idx.indclass, idx.indoption, idx.indexprs, idx.indpred, ix.indexdef, am.amname\n",nw=r.z.object({id:r.z.number(),table_id:r.z.number(),schema:r.z.string(),number_of_attributes:r.z.number(),number_of_key_attributes:r.z.number(),is_unique:r.z.boolean(),is_primary:r.z.boolean(),is_exclusion:r.z.boolean(),is_immediate:r.z.boolean(),is_clustered:r.z.boolean(),is_valid:r.z.boolean(),check_xmin:r.z.boolean(),is_ready:r.z.boolean(),is_live:r.z.boolean(),is_replica_identity:r.z.boolean(),key_attributes:r.z.array(r.z.number()),collation:r.z.array(r.z.number()),class:r.z.array(r.z.number()),options:r.z.array(r.z.number()),index_predicate:r.z.string().nullable(),comment:r.z.string().nullable(),index_definition:r.z.string(),access_method:r.z.string(),index_attributes:r.z.array(r.z.object({attribute_number:r.z.number(),attribute_name:r.z.string(),data_type:r.z.string()}))}),nC=r.z.array(nw),nx=r.z.optional(nw),nj=r.z.object({grantor:r.z.string(),grantee:r.z.string(),privilege_type:r.z.union([r.z.literal("SELECT"),r.z.literal("INSERT"),r.z.literal("UPDATE"),r.z.literal("REFERENCES")]),is_grantable:r.z.boolean()}),nU=r.z.object({column_id:r.z.string(),relation_schema:r.z.string(),relation_name:r.z.string(),column_name:r.z.string(),privileges:r.z.array(nj)}),nM=r.z.array(nU);r.z.object({columnId:r.z.string(),grantee:r.z.string(),privilegeType:r.z.union([r.z.literal("ALL"),r.z.literal("SELECT"),r.z.literal("INSERT"),r.z.literal("UPDATE"),r.z.literal("REFERENCES")]),isGrantable:r.z.boolean().optional()});let nF={roles:{list:function(){let{includeDefaultRoles:n=!1,limit:e,offset:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a="\nwith\n  roles as (".concat(c,")\nselect\n  *\nfrom\n  roles\nwhere\n  true\n");return n||(a+=" and not pg_catalog.starts_with(name, 'pg_')"),e&&(a+=" limit ".concat(e)),t&&(a+=" offset ".concat(t)),{sql:a,zod:s}},retrieve:function(n){return{sql:"with roles as (".concat(c,") select * from roles where ").concat(u(n),";"),zod:d}},create:function(n){let{name:e,isSuperuser:t=!1,canCreateDb:a=!1,canCreateRole:o=!1,inheritRole:c=!0,canLogin:r=!1,isReplicationRole:l=!1,canBypassRls:s=!1,connectionLimit:d=-1,password:u,validUntil:m,memberOf:p=[],members:g=[],admins:_=[],config:b={}}=n;return{sql:"\ncreate role ".concat((0,i.bD)(e),"\n  ").concat(t?"superuser":"","\n  ").concat(a?"createdb":"","\n  ").concat(o?"createrole":"","\n  ").concat(c?"":"noinherit","\n  ").concat(r?"login":"","\n  ").concat(l?"replication":"","\n  ").concat(s?"bypassrls":"","\n  connection limit ").concat(d,"\n  ").concat(void 0===u?"":"password ".concat((0,i.eu)(u)),"\n  ").concat(void 0===m?"":"valid until ".concat((0,i.eu)(m)),"\n  ").concat(0===p.length?"":"in role ".concat(p.map(i.bD).join(",")),"\n  ").concat(0===g.length?"":"role ".concat(g.map(i.bD).join(",")),"\n  ").concat(0===_.length?"":"admin ".concat(_.map(i.bD).join(",")),"\n  ;\n").concat(Object.entries(b).map(n=>{let[t,a]=n;return"alter role ".concat((0,i.bD)(e)," set ").concat((0,i.bD)(t)," = ").concat((0,i.eu)(a),";")}).join("\n"),"\n")}},update:function(n,e){let{name:t,isSuperuser:a,canCreateDb:o,canCreateRole:r,inheritRole:l,canLogin:s,isReplicationRole:d,canBypassRls:m,connectionLimit:p,password:g,validUntil:_}=e;return{sql:"\ndo $$\ndeclare\n  old record;\nbegin\n  with roles as (".concat(c,")\n  select * into old from roles where ").concat(u(n),";\n  if old is null then\n    raise exception 'Cannot find role with id %', id;\n  end if;\n\n  execute(format('alter role %I\n    ").concat(void 0===a?"":a?"superuser":"nosuperuser","\n    ").concat(void 0===o?"":o?"createdb":"nocreatedb","\n    ").concat(void 0===r?"":r?"createrole":"nocreaterole","\n    ").concat(void 0===l?"":l?"inherit":"noinherit","\n    ").concat(void 0===s?"":s?"login":"nologin","\n    ").concat(void 0===d?"":d?"replication":"noreplication","\n    ").concat(void 0===m?"":m?"bypassrls":"nobypassrls","\n    ").concat(void 0===p?"":"connection limit ".concat(p),"\n    ").concat(void 0===g?"":"password ".concat((0,i.eu)(g)),"\n    ").concat(void 0===_?"":"valid until %L","\n  ', old.name").concat(void 0===_?"":", ".concat((0,i.eu)(_)),"));\n\n  ").concat(void 0===t?"":"\n  -- Using the same name in the rename clause gives an error, so only do it if the new name is different.\n  if ".concat((0,i.eu)(t)," != old.name then\n    execute(format('alter role %I rename to %I;', old.name, ").concat((0,i.eu)(t),"));\n  end if;\n  "),"\nend\n$$;\n")}},remove:function(n){let{ifExists:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{sql:"\ndo $$\ndeclare\n  old record;\nbegin\n  with roles as (".concat(c,")\n  select * into old from roles where ").concat(u(n),";\n  if old is null then\n    raise exception 'Cannot find role with id %', id;\n  end if;\n\n  execute(format('drop role ").concat(e?"if exists":""," %I;', old.name));\nend\n$$;\n")}},zod:l},columns:{list:function(){let{tableId:n,includeSystemSchemas:e=!1,includedSchemas:t,excludedSchemas:a,limit:o,offset:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r="\nwith\n  columns as (".concat(_,")\nselect\n  *\nfrom\n  columns\nwhere\n true\n"),l=g(t,a,e?void 0:m);return l&&(r+=" and schema ".concat(l)),void 0!==n&&(r+=" and table_id = ".concat((0,i.eu)(n)," ")),o&&(r="".concat(r," limit ").concat(o)),c&&(r="".concat(r," offset ").concat(c)),{sql:r,zod:E}},retrieve:function(n){return{sql:"WITH columns AS (".concat(_,") SELECT * FROM columns WHERE ").concat(function(n){if("id"in n&&n.id)return"".concat((0,i.bD)("id")," = ").concat((0,i.eu)(n.id));if("name"in n&&n.name&&n.schema&&n.table)return"schema = ".concat((0,i.eu)(n.schema)," AND ").concat((0,i.bD)("table")," = ").concat((0,i.eu)(n.table)," AND name = ").concat((0,i.eu)(n.name));throw Error("Must provide either id or schema, name and table")}(n),";"),zod:f}},create:function(n){let{schema:e,table:t,name:a,type:o,default_value:c,default_value_format:r="literal",is_identity:l=!1,identity_generation:s="BY DEFAULT",is_nullable:d,is_primary_key:u=!1,is_unique:m=!1,comment:p,check:g}=n,_="";if(l){if(void 0!==c)throw Error("Columns cannot both be identity and have a default value");_="GENERATED ".concat(s," AS IDENTITY")}else void 0===c||(_="expression"===r?"DEFAULT ".concat(c):"DEFAULT ".concat((0,i.eu)(c)));let b="";void 0!==d&&(b=d?"NULL":"NOT NULL");let E=void 0===p?"":"COMMENT ON COLUMN ".concat((0,i.bD)(e),".").concat((0,i.bD)(t),".").concat((0,i.bD)(a)," IS ").concat((0,i.eu)(p));return{sql:"\nBEGIN;\n  ALTER TABLE ".concat((0,i.bD)(e),".").concat((0,i.bD)(t)," ADD COLUMN ").concat((0,i.bD)(a)," ").concat(h(o),"\n    ").concat(_,"\n    ").concat(b,"\n    ").concat(u?"PRIMARY KEY":"","\n    ").concat(m?"UNIQUE":"","\n    ").concat(void 0===g?"":"CHECK (".concat(g,")"),";\n  ").concat(E,";\nCOMMIT;")}},update:function(n,e){let t,a,{name:o,type:c,drop_default:r=!1,default_value:l,default_value_format:s="literal",is_identity:d,identity_generation:u="BY DEFAULT",is_nullable:m,is_unique:p,comment:g,check:_}=e,b=void 0===o||o===n.name?"":"ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," RENAME COLUMN ").concat((0,i.bD)(n.name)," TO ").concat((0,i.bD)(o),";"),E=void 0===c?"":"ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," ALTER COLUMN ").concat((0,i.bD)(n.name)," SET DATA TYPE ").concat(h(c)," USING ").concat((0,i.bD)(n.name),"::").concat(h(c),";");if(r)t="ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," ALTER COLUMN ").concat((0,i.bD)(n.name)," DROP DEFAULT;");else if(void 0===l)t="";else{let e="expression"===s?l:(0,i.eu)(l);t="ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," ALTER COLUMN ").concat((0,i.bD)(n.name)," SET DEFAULT ").concat(e,";")}let f="ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," ALTER COLUMN ").concat((0,i.bD)(n.name));!1===d?f+=" DROP IDENTITY IF EXISTS;":!0===n.is_identity?void 0===u?f="":f+=" SET GENERATED ".concat(u,";"):void 0===d?f="":f+=" ADD GENERATED ".concat(u," AS IDENTITY;"),a=void 0===m?"":m?"ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," ALTER COLUMN ").concat((0,i.bD)(n.name)," DROP NOT NULL;"):"ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," ALTER COLUMN ").concat((0,i.bD)(n.name)," SET NOT NULL;");let A="";!0===n.is_unique&&!1===p?A="\nDO $$\nDECLARE\n  r record;\nBEGIN\n  FOR r IN\n    SELECT conname FROM pg_constraint WHERE\n      contype = 'u'\n      AND cardinality(conkey) = 1\n      AND conrelid = ".concat((0,i.eu)(n.table_id),"\n      AND conkey[1] = ").concat((0,i.eu)(n.ordinal_position),"\n  LOOP\n    EXECUTE ").concat((0,i.eu)("ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," DROP CONSTRAINT "))," || quote_ident(r.conname);\n  END LOOP;\nEND\n$$;\n"):!1===n.is_unique&&!0===p&&(A="ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," ADD UNIQUE (").concat((0,i.bD)(n.name),");"));let z=void 0===g?"":"COMMENT ON COLUMN ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table),".").concat((0,i.bD)(n.name)," IS ").concat((0,i.eu)(g),";"),N=void 0===_?"":"\nDO $$\nDECLARE\n  v_conname name;\n  v_conkey int2[];\nBEGIN\n  SELECT conname into v_conname FROM pg_constraint WHERE\n    contype = 'c'\n    AND cardinality(conkey) = 1\n    AND conrelid = ".concat((0,i.eu)(n.table_id),"\n    AND conkey[1] = ").concat((0,i.eu)(n.ordinal_position),"\n    ORDER BY oid asc\n    LIMIT 1;\n\n  IF v_conname IS NOT NULL THEN\n    EXECUTE format('ALTER TABLE ").concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," DROP CONSTRAINT %I', v_conname);\n  END IF;\n\n  ").concat(null!==_?"\n  ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," ADD CONSTRAINT ").concat((0,i.bD)("".concat(n.table,"_").concat(n.name,"_check"))," CHECK (").concat(_,");\n\n  SELECT conkey into v_conkey FROM pg_constraint WHERE conname = ").concat((0,i.eu)("".concat(n.table,"_").concat(n.name,"_check")),";\n\n  ASSERT v_conkey IS NOT NULL, 'error creating column constraint: check condition must refer to this column';\n  ASSERT cardinality(v_conkey) = 1, 'error creating column constraint: check condition cannot refer to multiple columns';\n  ASSERT v_conkey[1] = ").concat((0,i.eu)(n.ordinal_position),", 'error creating column constraint: check condition cannot refer to other columns';\n"):"","\nEND\n$$;\n");return{sql:"\nBEGIN;\n  ".concat(a,"\n  ").concat(E,"\n  ").concat(t,"\n  ").concat(f,"\n  ").concat(A,"\n  ").concat(z,"\n  ").concat(N,"\n  ").concat(b,"\nCOMMIT;")}},remove:function(n){let{cascade:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{sql:"ALTER TABLE ".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)," DROP COLUMN ").concat((0,i.bD)(n.name)," ").concat(e?"CASCADE":"RESTRICT",";")}},zod:b},schemas:{list:function(){let{includeSystemSchemas:n=!1,limit:e,offset:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=A;return n||(a="".concat(a," and not (n.nspname in (").concat(m.map(i.eu).join(","),"))")),e&&(a="".concat(a," limit ").concat(e)),t&&(a="".concat(a," offset ").concat(t)),{sql:a,zod:N}},retrieve:function(n){let{id:e,name:t}=n;return e?{sql:"".concat(A," and n.oid = ").concat((0,i.eu)(e),";"),zod:T}:{sql:"".concat(A," and n.nspname = ").concat((0,i.eu)(t),";"),zod:T}},create:function(n){let{name:e,owner:t}=n;return{sql:"create schema ".concat((0,i.bD)(e),"\n  ").concat(void 0===t?"":"authorization ".concat((0,i.bD)(t)),";\n")}},update:function(n,e){let{id:t,name:a}=n,{name:o,owner:c}=e;return{sql:"\ndo $$\ndeclare\n  id oid := ".concat(void 0===t?"".concat((0,i.eu)(a),"::regnamespace"):(0,i.eu)(t),";\n  old record;\n  new_name text := ").concat(void 0===o?null:(0,i.eu)(o),";\n  new_owner text := ").concat(void 0===c?null:(0,i.eu)(c),";\nbegin\n  select * into old from pg_namespace where oid = id;\n  if old is null then\n    raise exception 'Cannot find schema with id %', id;\n  end if;\n\n  if new_owner is not null then\n    execute(format('alter schema %I owner to %I;', old.nspname, new_owner));\n  end if;\n\n  -- Using the same name in the rename clause gives an error, so only do it if the new name is different.\n  if new_name is not null and new_name != old.nspname then\n    execute(format('alter schema %I rename to %I;', old.nspname, new_name));\n  end if;\nend\n$$;\n")}},remove:function(n){let{id:e,name:t}=n,{cascade:a=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{sql:"\ndo $$\ndeclare\n  id oid := ".concat(void 0===e?"".concat((0,i.eu)(t),"::regnamespace"):(0,i.eu)(e),";\n  old record;\n  cascade bool := ").concat((0,i.eu)(a),";\nbegin\n  select * into old from pg_namespace where oid = id;\n  if old is null then\n    raise exception 'Cannot find schema with id %', id;\n  end if;\n\n  execute(format('drop schema %I %s;', old.nspname, case when cascade then 'cascade' else 'restrict' end));\nend\n$$;\n")}},zod:z},tables:a,functions:o,tablePrivileges:{list:function(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i="\nwith table_privileges as (".concat(W,")\nselect *\nfrom table_privileges\n"),c=g(e,t,n?void 0:m);return c&&(i+=" where schema ".concat(c)),a&&(i+=" limit ".concat(a)),o&&(i+=" offset ".concat(o)),{sql:i,zod:V}},retrieve:function(n){let{id:e,name:t,schema:a="public"}=n;return e?{sql:"\nwith table_privileges as (".concat(W,")\nselect *\nfrom table_privileges\nwhere table_privileges.relation_id = ").concat((0,i.eu)(e),";"),zod:X}:{sql:"\nwith table_privileges as (".concat(W,")\nselect *\nfrom table_privileges\nwhere table_privileges.schema = ").concat((0,i.eu)(a),"\n  and table_privileges.name = ").concat((0,i.eu)(t),"\n"),zod:X}},grant:function(n){return{sql:"\ndo $$\nbegin\n".concat(n.map(n=>{let{privilegeType:e,relationId:t,grantee:a,isGrantable:o}=n;return"execute format('grant ".concat(e," on table %s to ").concat("public"===a.toLowerCase()?"public":(0,i.bD)(a)," ").concat(o?"with grant option":"","', ").concat(t,"::regclass);")}).join("\n"),"\nend $$;\n")}},revoke:function(n){return{sql:"\ndo $$\nbegin\n".concat(n.map(n=>{let{privilegeType:e,relationId:t,grantee:a}=n;return"execute format('revoke ".concat(e," on table %s from ").concat("public"===a.toLowerCase()?"public":(0,i.bD)(a),"', ").concat(t,"::regclass);")}).join("\n"),"\nend $$;\n")}},zod:J},publications:{list:function(){let{limit:n,offset:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="with publications as (".concat(Q,") select * from publications");return n&&(t+=" limit ".concat(n)),e&&(t+=" offset ".concat(e)),{sql:t,zod:nn}},retrieve:function(n){return{sql:"with publications as (".concat(Q,") select * from publications where ").concat(function(n){if("id"in n&&n.id)return"".concat((0,i.bD)("id")," = ").concat((0,i.eu)(n.id));if("name"in n&&n.name)return"".concat((0,i.bD)("name")," = ").concat((0,i.eu)(n.name));throw Error("Must provide either id or name")}(n),";"),zod:ne}},create:function(n){let e,{name:t,publish_insert:a=!1,publish_update:o=!1,publish_delete:c=!1,publish_truncate:r=!1,tables:l=null}=n;e=null==l?"FOR ALL TABLES":0===l.length?"":"FOR TABLE ".concat(l.map(n=>{if(!n.includes("."))return(0,i.bD)(n);let[e,...t]=n.split("."),a=t.join(".");return"".concat((0,i.bD)(e),".").concat((0,i.bD)(a))}).join(","));let s=[];return a&&s.push("insert"),o&&s.push("update"),c&&s.push("delete"),r&&s.push("truncate"),{sql:"\nCREATE PUBLICATION ".concat((0,i.bD)(t)," ").concat(e,"\n  WITH (publish = '").concat(s.join(","),"');")}},update:function(n,e){let{name:t,owner:a,publish_insert:o,publish_update:c,publish_delete:r,publish_truncate:l,tables:s}=e;return{sql:"\ndo $$\ndeclare\n  id oid := ".concat((0,i.eu)(n),";\n  old record;\n  new_name text := ").concat(void 0===t?null:(0,i.eu)(t),";\n  new_owner text := ").concat(void 0===a?null:(0,i.eu)(a),";\n  new_publish_insert bool := ").concat(null!=o?o:null,";\n  new_publish_update bool := ").concat(null!=c?c:null,";\n  new_publish_delete bool := ").concat(null!=r?r:null,";\n  new_publish_truncate bool := ").concat(null!=l?l:null,";\n  new_tables text := ").concat(void 0===s?null:(0,i.eu)(null===s?"all tables":s.map(n=>{if(!n.includes("."))return(0,i.bD)(n);let[e,...t]=n.split("."),a=t.join(".");return"".concat((0,i.bD)(e),".").concat((0,i.bD)(a))}).join(",")),";\nbegin\n  select * into old from pg_publication where oid = id;\n  if old is null then\n    raise exception 'Cannot find publication with id %', id;\n  end if;\n\n  if new_tables is null then\n    null;\n  elsif new_tables = 'all tables' then\n    if old.puballtables then\n      null;\n    else\n      -- Need to recreate because going from list of tables <-> all tables with alter is not possible.\n      execute(format('drop publication %1$I; create publication %1$I for all tables;', old.pubname));\n    end if;\n  else\n    if old.puballtables then\n      -- Need to recreate because going from list of tables <-> all tables with alter is not possible.\n      execute(format('drop publication %1$I; create publication %1$I;', old.pubname));\n    elsif exists(select from pg_publication_rel where prpubid = id) then\n      execute(\n        format(\n          'alter publication %I drop table %s',\n          old.pubname,\n          (select string_agg(prrelid::regclass::text, ', ') from pg_publication_rel where prpubid = id)\n        )\n      );\n    end if;\n\n    -- At this point the publication must have no tables.\n\n    if new_tables != '' then\n      execute(format('alter publication %I add table %s', old.pubname, new_tables));\n    end if;\n  end if;\n\n  execute(\n    format(\n      'alter publication %I set (publish = %L);',\n      old.pubname,\n      concat_ws(\n        ', ',\n        case when coalesce(new_publish_insert, old.pubinsert) then 'insert' end,\n        case when coalesce(new_publish_update, old.pubupdate) then 'update' end,\n        case when coalesce(new_publish_delete, old.pubdelete) then 'delete' end,\n        case when coalesce(new_publish_truncate, old.pubtruncate) then 'truncate' end\n      )\n    )\n  );\n\n  execute(format('alter publication %I owner to %I;', old.pubname, coalesce(new_owner, old.pubowner::regrole::name)));\n\n  -- Using the same name in the rename clause gives an error, so only do it if the new name is different.\n  if new_name is not null and new_name != old.pubname then\n    execute(format('alter publication %I rename to %I;', old.pubname, coalesce(new_name, old.pubname)));\n  end if;\n\n  -- We need to retrieve the publication later, so we need a way to uniquely identify which publication this is.\n  -- We can't rely on id because it gets changed if it got recreated.\n  -- We use a temp table to store the unique name - DO blocks can't return a value.\n  create temp table pg_meta_publication_tmp (name) on commit drop as values (coalesce(new_name, old.pubname));\nend $$;\n")}},remove:function(n){return{sql:"DROP PUBLICATION IF EXISTS ".concat((0,i.bD)(n.name),";")}},zod:K},extensions:{list:function(){let{limit:n,offset:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=nt;return n&&(t="".concat(t," LIMIT ").concat(n)),e&&(t="".concat(t," OFFSET ").concat(e)),{sql:t,zod:no}},retrieve:function(n){let{name:e}=n;return{sql:"".concat(nt," WHERE name = ").concat((0,i.eu)(e),";"),zod:ni}},create:function(n){let{name:e,schema:t,version:a,cascade:o=!1}=n;return{sql:"\nCREATE EXTENSION ".concat((0,i.bD)(e),"\n  ").concat(void 0===t?"":"SCHEMA ".concat((0,i.bD)(t)),"\n  ").concat(void 0===a?"":"VERSION ".concat((0,i.eu)(a)),"\n  ").concat(o?"CASCADE":"",";")}},update:function(n,e){let{update:t=!1,version:a,schema:o}=e,c="";t&&(c="ALTER EXTENSION ".concat((0,i.bD)(n)," UPDATE ").concat(void 0===a?"":"TO ".concat((0,i.eu)(a)),";"));let r=void 0===o?"":"ALTER EXTENSION ".concat((0,i.bD)(n)," SET SCHEMA ").concat((0,i.bD)(o),";");return{sql:"BEGIN; ".concat(c," ").concat(r," COMMIT;")}},remove:function(n){let{cascade:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{sql:"DROP EXTENSION ".concat((0,i.bD)(n)," ").concat(e?"CASCADE":"RESTRICT",";")}},zod:na},config:{list:function(){let{limit:n,offset:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t="\nSELECT\n  name,\n  setting,\n  category,\n  TRIM(split_part(category, '/', 1)) AS group,\n  TRIM(split_part(category, '/', 2)) AS subgroup,\n  unit,\n  short_desc,\n  extra_desc,\n  context,\n  vartype,\n  source,\n  min_val,\n  max_val,\n  enumvals,\n  boot_val,\n  reset_val,\n  sourcefile,\n  sourceline,\n  pending_restart\nFROM\n  pg_settings\nORDER BY\n  category,\n  name\n";return n&&(t+=" LIMIT ".concat(n)),e&&(t+=" OFFSET ".concat(e)),{sql:t,zod:nr}},zod:nc},materializedViews:{list:function(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o,includeColumns:i=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=nu({includeColumns:i}),r=g(e,t,n?void 0:m);return r&&(c+=" where schema ".concat(r)),a&&(c+=" limit ".concat(a)),o&&(c+=" offset ".concat(o)),{sql:c,zod:ns}},retrieve:function(n){let e=function(n){if("id"in n&&n.id)return"".concat((0,i.bD)("id")," = ").concat((0,i.eu)(n.id));if("name"in n&&n.name&&n.schema)return"".concat((0,i.bD)("name")," = ").concat((0,i.eu)(n.name)," and ").concat((0,i.bD)("schema")," = ").concat((0,i.eu)(n.schema));throw Error("Must provide either id or name and schema")}(n);return{sql:"".concat(nu({includeColumns:!0})," where ").concat(e,";"),zod:nd}},zod:nl},foreignTables:{list:function(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o,includeColumns:i=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=n_({includeColumns:i}),r=g(e,t,n?void 0:m);return r&&(c+=" where schema ".concat(r)),a&&(c+=" limit ".concat(a)),o&&(c+=" offset ".concat(o)),{sql:c,zod:np}},retrieve:function(n){return{sql:"".concat(n_({includeColumns:!0})," where ").concat(function(n){if("id"in n&&n.id)return"".concat((0,i.bD)("id")," = ").concat((0,i.eu)(n.id));if("name"in n&&n.name&&n.schema)return"".concat((0,i.bD)("name")," = ").concat((0,i.eu)(n.name)," and ").concat((0,i.bD)("schema")," = ").concat((0,i.eu)(n.schema));throw Error("Must provide either id or name and schema")}(n),";"),zod:ng}},zod:nm},views:{list:function(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o,includeColumns:i=!0}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=nh({includeColumns:i}),r=g(e,t,n?void 0:m);return r&&(c+=" where schema ".concat(r)),a&&(c+=" limit ".concat(a)),o&&(c+=" offset ".concat(o)),{sql:c,zod:nE}},retrieve:function(n){let e=function(n){if("id"in n&&n.id)return"".concat((0,i.bD)("id")," = ").concat((0,i.eu)(n.id));if("name"in n&&n.name&&n.schema)return"".concat((0,i.bD)("name")," = ").concat((0,i.eu)(n.name)," and ").concat((0,i.bD)("schema")," = ").concat((0,i.eu)(n.schema));throw Error("Must provide either id or name and schema")}(n);return{sql:"".concat(nh({includeColumns:!0})," where ").concat(e,";"),zod:nf}},zod:nb},policies:{list:function(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i="\n    with policies as (".concat(nA,")\n    select *\n    from policies\n    "),c=g(e,t,n?void 0:m);return c&&(i+="where schema ".concat(c)),a&&(i+=" limit ".concat(a)),o&&(i+=" offset ".concat(o)),{sql:i,zod:nN}},retrieve:function(n){return{sql:"with policies as (".concat(nA,") select * from policies where ").concat(function(n){if("id"in n&&n.id)return"id = ".concat((0,i.eu)(n.id));if("name"in n&&n.name&&n.schema&&n.table)return"name = ".concat((0,i.eu)(n.name)," AND schema = ").concat((0,i.eu)(n.schema)," AND table = ").concat((0,i.eu)(n.table));throw Error("Must provide either id or name, schema and table")}(n),";"),zod:nT}},create:function(n){let{name:e,schema:t="public",table:a,definition:o,check:c,action:r="PERMISSIVE",command:l="ALL",roles:s=["public"]}=n;return{sql:"\ncreate policy ".concat((0,i.bD)(e)," on ").concat((0,i.bD)(t),".").concat((0,i.bD)(a),"\n  as ").concat(r,"\n  for ").concat(l,"\n  to ").concat(s.map(i.bD).join(","),"\n  ").concat(o?"using (".concat(o,")"):"","\n  ").concat(c?"with check (".concat(c,")"):"",";")}},update:function(n,e){let{name:t,definition:a,check:o,roles:c}=e,r="ALTER POLICY ".concat((0,i.bD)(n.name)," ON ").concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)),l=void 0===t?"":"".concat(r," RENAME TO ").concat((0,i.bD)(t),";"),s=void 0===a?"":"".concat(r," USING (").concat(a,");"),d=void 0===o?"":"".concat(r," WITH CHECK (").concat(o,");"),u=void 0===c?"":"".concat(r," TO ").concat(c.map(i.bD).join(","),";");return{sql:"BEGIN; ".concat(s," ").concat(d," ").concat(u," ").concat(l," COMMIT;")}},remove:function(n){return{sql:"DROP POLICY ".concat((0,i.bD)(n.name)," ON ").concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table),";")}},zod:nz},triggers:{list:function(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i="with triggers as (".concat(ny,") select * from triggers"),c=g(e,t,n?void 0:m);return c&&(i+=" where schema ".concat(c)),a&&(i+=" limit ".concat(a)),o&&(i+=" offset ".concat(o)),{sql:i,zod:nS}},retrieve:function(n){let e=function(n){if("id"in n&&n.id)return"".concat((0,i.bD)("id")," = ").concat((0,i.eu)(n.id));if("name"in n&&n.name&&n.table&&n.schema)return"".concat((0,i.bD)("name")," = ").concat((0,i.eu)(n.name)," and ").concat((0,i.bD)("schema")," = ").concat((0,i.eu)(n.schema)," and ").concat((0,i.bD)("table")," = ").concat((0,i.eu)(n.table));throw Error("Must provide either id or name, schema and table")}(n);return{sql:"with triggers as (".concat(ny,") select * from triggers where ").concat(e,";"),zod:nD}},create:function(n){let{name:e,schema:t="public",table:a,function_schema:o="public",function_name:c,function_args:l=[],activation:s,events:d,orientation:u,condition:m}=n,p="".concat((0,i.bD)(t),".").concat((0,i.bD)(a)),g="".concat((0,i.bD)(o),".").concat((0,i.bD)(c)),_=d.join(" or "),b=l.map(i.eu).join(",");return{sql:"create trigger ".concat((0,i.bD)(e)," ").concat(s," ").concat(_," on ").concat(p," ").concat(u?"for each ".concat(u):""," ").concat(m?"when (".concat(m,")"):""," execute function ").concat(g,"(").concat(b,");"),zod:r.z.void()}},update:function(n,e){let t="".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table)),a="";switch(e.enabled_mode){case"ORIGIN":a="alter table ".concat(t," enable trigger ").concat((0,i.bD)(n.name),";");break;case"DISABLED":a="alter table ".concat(t," disable trigger ").concat((0,i.bD)(n.name),";");break;case"REPLICA":case"ALWAYS":a="alter table ".concat(t," enable ").concat(e.enabled_mode," trigger ").concat((0,i.bD)(n.name),";")}let o=e.name&&e.name!==n.name?"alter trigger ".concat((0,i.bD)(n.name)," on ").concat(t," rename to ").concat((0,i.bD)(e.name),";"):"";return{sql:"begin; ".concat(a,"; ").concat(o,"; commit;"),zod:r.z.void()}},remove:function(n){let{cascade:e=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t="".concat((0,i.bD)(n.schema),".").concat((0,i.bD)(n.table));return{sql:"drop trigger ".concat((0,i.bD)(n.name)," on ").concat(t," ").concat(e?"cascade":"",";"),zod:r.z.void()}},zod:nv},types:{list:function(){let{includeArrayTypes:n=!1,includeSystemSchemas:e=!1,includedSchemas:t,excludedSchemas:a,limit:o,offset:i}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c="\nselect\n  t.oid::int8 as id,\n  t.typname as name,\n  n.nspname as schema,\n  format_type (t.oid, null) as format,\n  coalesce(t_enums.enums, '[]') as enums,\n  coalesce(t_attributes.attributes, '[]') as attributes,\n  obj_description (t.oid, 'pg_type') as comment\nfrom\n  pg_type t\n  left join pg_namespace n on n.oid = t.typnamespace\n  left join (\n    select\n      enumtypid,\n      jsonb_agg(enumlabel order by enumsortorder) as enums\n    from\n      pg_enum\n    group by\n      enumtypid\n  ) as t_enums on t_enums.enumtypid = t.oid\n  left join (\n    select\n      oid,\n      jsonb_agg(\n        jsonb_build_object('name', a.attname, 'type_id', a.atttypid::int8)\n        order by a.attnum asc\n      ) as attributes\n    from\n      pg_class c\n      join pg_attribute a on a.attrelid = c.oid\n    where\n      c.relkind = 'c' and not a.attisdropped\n    group by\n      c.oid\n  ) as t_attributes on t_attributes.oid = t.typrelid\nwhere\n  (\n    t.typrelid = 0\n    or (\n      select\n        c.relkind = 'c'\n      from\n        pg_class c\n      where\n        c.oid = t.typrelid\n    )\n  )\n";n||(c+=" and not exists (\n      select from pg_type el\n      where el.oid = t.typelem\n        and el.typarray = t.oid\n    )");let r=g(t,a,e?void 0:m);return r&&(c+=" and n.nspname ".concat(r)),o&&(c+=" limit ".concat(o)),i&&(c+=" offset ".concat(i)),{sql:c,zod:nL}},zod:nR},version:{retrieve:function(){return{sql:"\nselect\n  version(),\n  current_setting('server_version_num')::int8 as version_number,\n  (\n    select\n      count(*) as active_connections\n    from\n      pg_stat_activity\n  ) as active_connections,\n  current_setting('max_connections')::int8 as max_connections\n",zod:nI}},zod:nI},indexes:{list:function(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,limit:a,offset:o}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i="\n    with indexes as (".concat(nO,")\n    select *\n    from indexes\n  "),c=g(e,t,n?void 0:m);return c&&(i+=" where schema ".concat(c)),a&&(i+=" limit ".concat(a)),o&&(i+=" offset ".concat(o)),{sql:i,zod:nC}},retrieve:function(n){let{id:e}=n;return{sql:"\n    with indexes as (".concat(nO,")\n    select *\n    from indexes\n    where id = ").concat((0,i.eu)(e),";\n  "),zod:nx}},zod:nw},columnPrivileges:{list:function(){let{includeSystemSchemas:n=!1,includedSchemas:e,excludedSchemas:t,columnIds:a,limit:o,offset:c}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r="\n  with column_privileges as (".concat("\n-- Lists each column's privileges in the form of:\n--\n-- [\n--   {\n--     \"column_id\": \"12345.1\",\n--     \"relation_schema\": \"public\",\n--     \"relation_name\": \"mytable\",\n--     \"column_name\": \"mycolumn\",\n--     \"privileges\": [\n--       {\n--         \"grantor\": \"postgres\",\n--         \"grantee\": \"myrole\",\n--         \"privilege_type\": \"SELECT\",\n--         \"is_grantable\": false\n--       },\n--       ...\n--     ]\n--   },\n--   ...\n-- ]\n--\n-- Modified from information_schema.column_privileges. We try to be as close as\n-- possible to the view definition, obtained from:\n--\n-- select pg_get_viewdef('information_schema.column_privileges');\n--\n-- The main differences are:\n-- - we include column privileges for materialized views\n--   (reason for exclusion in information_schema.column_privileges:\n--    https://www.postgresql.org/message-id/9136.1502740844%40sss.pgh.pa.us)\n-- - we query a.attrelid and a.attnum to generate column_id\n-- - table_catalog is omitted\n-- - table_schema -> relation_schema, table_name -> relation_name\n--\n-- Column privileges are intertwined with table privileges in that table\n-- privileges override column privileges. E.g. if we do:\n--\n-- grant all on mytable to myrole;\n--\n-- Then myrole is granted privileges for ALL columns. Likewise, if we do:\n--\n-- grant all (id) on mytable to myrole;\n-- revoke all on mytable from myrole;\n--\n-- Then the grant on the id column is revoked.\n--\n-- This is unlike how grants for schemas and tables interact, where you need\n-- privileges for BOTH the schema the table is in AND the table itself in order\n-- to access the table.\n\nselect (x.attrelid || '.' || x.attnum) as column_id,\n       nc.nspname as relation_schema,\n       x.relname as relation_name,\n       x.attname as column_name,\n       coalesce(\n         jsonb_agg(\n           jsonb_build_object(\n             'grantor', u_grantor.rolname,\n             'grantee', grantee.rolname,\n             'privilege_type', x.prtype,\n             'is_grantable', x.grantable\n           )\n         ),\n         '[]'\n       ) as privileges\nfrom\n  (select pr_c.grantor,\n          pr_c.grantee,\n          a.attrelid,\n          a.attnum,\n          a.attname,\n          pr_c.relname,\n          pr_c.relnamespace,\n          pr_c.prtype,\n          pr_c.grantable,\n          pr_c.relowner\n   from\n     (select pg_class.oid,\n             pg_class.relname,\n             pg_class.relnamespace,\n             pg_class.relowner,\n             (aclexplode(coalesce(pg_class.relacl, acldefault('r', pg_class.relowner)))).grantor as grantor,\n             (aclexplode(coalesce(pg_class.relacl, acldefault('r', pg_class.relowner)))).grantee as grantee,\n             (aclexplode(coalesce(pg_class.relacl, acldefault('r', pg_class.relowner)))).privilege_type as privilege_type,\n             (aclexplode(coalesce(pg_class.relacl, acldefault('r', pg_class.relowner)))).is_grantable as is_grantable\n      from pg_class\n      where (pg_class.relkind = any (array['r',\n                                           'v',\n                                           'm',\n                                           'f',\n                                           'p'])) ) pr_c(oid, relname, relnamespace, relowner, grantor, grantee, prtype, grantable),\n                                                    pg_attribute a\n   where ((a.attrelid = pr_c.oid)\n          and (a.attnum > 0)\n          and (not a.attisdropped))\n   union select pr_a.grantor,\n                pr_a.grantee,\n                pr_a.attrelid,\n                pr_a.attnum,\n                pr_a.attname,\n                c.relname,\n                c.relnamespace,\n                pr_a.prtype,\n                pr_a.grantable,\n                c.relowner\n   from\n     (select a.attrelid,\n             a.attnum,\n             a.attname,\n             (aclexplode(coalesce(a.attacl, acldefault('c', cc.relowner)))).grantor as grantor,\n             (aclexplode(coalesce(a.attacl, acldefault('c', cc.relowner)))).grantee as grantee,\n             (aclexplode(coalesce(a.attacl, acldefault('c', cc.relowner)))).privilege_type as privilege_type,\n             (aclexplode(coalesce(a.attacl, acldefault('c', cc.relowner)))).is_grantable as is_grantable\n      from (pg_attribute a\n            join pg_class cc on ((a.attrelid = cc.oid)))\n      where ((a.attnum > 0)\n             and (not a.attisdropped))) pr_a(attrelid, attnum, attname, grantor, grantee, prtype, grantable),\n                                        pg_class c\n   where ((pr_a.attrelid = c.oid)\n          and (c.relkind = any (ARRAY['r',\n                                      'v',\n                                      'm',\n                                      'f',\n                                      'p'])))) x,\n     pg_namespace nc,\n     pg_authid u_grantor,\n  (select pg_authid.oid,\n          pg_authid.rolname\n   from pg_authid\n   union all select (0)::oid as oid,\n                    'PUBLIC') grantee(oid, rolname)\nwhere ((x.relnamespace = nc.oid)\n       and (x.grantee = grantee.oid)\n       and (x.grantor = u_grantor.oid)\n       and (x.prtype = any (ARRAY['INSERT',\n                                  'SELECT',\n                                  'UPDATE',\n                                  'REFERENCES']))\n       and (pg_has_role(u_grantor.oid, 'USAGE')\n            or pg_has_role(grantee.oid, 'USAGE')\n            or (grantee.rolname = 'PUBLIC')))\ngroup by column_id,\n         nc.nspname,\n         x.relname,\n         x.attname\n",")\n  select *\n  from column_privileges\n  "),l=[],s=g(e,t,n?void 0:m);return s&&l.push("relation_schema ".concat(s)),(null==a?void 0:a.length)&&l.push("column_id in (".concat(a.map(i.eu).join(","),")")),l.length>0&&(r+=" where ".concat(l.join(" and "))),o&&(r+=" limit ".concat(o)),c&&(r+=" offset ".concat(c)),{sql:r,zod:nM}},grant:function(n){return{sql:"\ndo $$\ndeclare\n  col record;\nbegin\n".concat(n.map(n=>{let{privilegeType:e,columnId:t,grantee:a,isGrantable:o}=n,[c,r]=t.split(".");return"\nselect *\nfrom pg_attribute a\nwhere a.attrelid = ".concat((0,i.eu)(c),"\n  and a.attnum = ").concat((0,i.eu)(r),"\ninto col;\nexecute format(\n  'grant ").concat(e," (%I) on %s to ").concat("public"===a.toLowerCase()?"public":(0,i.bD)(a)," ").concat(o?"with grant option":"","',\n  col.attname,\n  col.attrelid::regclass\n);")}).join("\n"),"\nend $$;\n")}},revoke:function(n){return{sql:"\ndo $$\ndeclare\n  col record;\nbegin\n".concat(n.map(n=>{let{privilegeType:e,columnId:t,grantee:a}=n,[o,c]=t.split(".");return"\nselect *\nfrom pg_attribute a\nwhere a.attrelid = ".concat((0,i.eu)(o),"\n  and a.attnum = ").concat((0,i.eu)(c),"\ninto col;\nexecute format(\n  'revoke ").concat(e," (%I) on %s from ").concat("public"===a.toLowerCase()?"public":(0,i.bD)(a),"',\n  col.attname,\n  col.attrelid::regclass\n);")}).join("\n"),"\nend $$;\n")}},zod:nU},query:t(17613)}},46762:(n,e,t)=>{t.d(e,{Go:()=>r,Mh:()=>o,TV:()=>i,Z1:()=>l,oR:()=>s,yN:()=>c});var a=t(48596);function o(n,e){let t="select count(*) from ".concat(m(n)),{filters:a}=null!=e?e:{};return a&&(t=d(t,a)),t+";"}function i(n,e){let t="truncate ".concat(m(n)),{cascade:a}=null!=e?e:{};return a&&(t+=" cascade"),t+";"}function c(n,e,t){if(!e||0===e.length)throw Error("no filters for this delete query");let o="delete from ".concat(m(n)),{returning:i,enumArrayColumns:c}=null!=t?t:{};return e&&(o=d(o,e)),i&&(o+=void 0===c||0===c.length?" returning *":" returning *, ".concat(c.map(n=>"".concat((0,a.bD)(n),"::text[]")).join(","))),o+";"}function r(n,e,t){if(!e||0===e.length)throw Error("no value to insert");let{returning:o,enumArrayColumns:i}=null!=t?t:{},c=Object.keys(e[0]).map(n=>(0,a.bD)(n)).join(","),r="";return r=0==c.length?(0,a.GP)("insert into %1$s select from jsonb_populate_recordset(null::%1$s, %2$s)",m(n),(0,a.eu)(JSON.stringify(e))):(0,a.GP)("insert into %1$s (%2$s) select %2$s from jsonb_populate_recordset(null::%1$s, %3$s)",m(n),c,(0,a.eu)(JSON.stringify(e))),o&&(r+=void 0===i||0===i.length?" returning *":" returning *, ".concat(i.map(n=>"".concat((0,a.bD)(n),"::text[]")).join(","))),r+";"}function l(n,e,t){var o;let i=!(arguments.length>3)||void 0===arguments[3]||arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r="";r+="select ".concat(null!=e?e:"*"," from ").concat(c?(o=n,"".concat((0,a.bD)(o.name))):m(n));let{filters:l,pagination:s,sorts:u}=null!=t?t:{};if(l&&(r=d(r,l)),u&&(r=function(n,e){let t=e.filter(n=>n.column);return 0===t.length?n:n+=" order by ".concat(t.map(n=>{let e=n.ascending?"asc":"desc",t=n.nullsFirst?"nulls first":"nulls last";return"".concat((0,a.bD)(n.table),".").concat((0,a.bD)(n.column)," ").concat(e," ").concat(t)}).join(", "))}(r,u)),s){let{limit:n,offset:e}=null!=s?s:{};r+=" limit ".concat((0,a.eu)(n)," offset ").concat((0,a.eu)(e))}return"".concat(r).concat(i?";":"")}function s(n,e,t){let{filters:o,returning:i,enumArrayColumns:c}=null!=t?t:{};if(!o||0===o.length)throw Error("no filters for this update query");let r=Object.keys(e).map(n=>(0,a.bD)(n)).join(","),l=(0,a.GP)("update %1$s set (%2$s) = (select %2$s from json_populate_record(null::%1$s, %3$s))",m(n),r,(0,a.eu)(JSON.stringify(e)));return o&&(l=d(l,o)),i&&(l+=void 0===c||0===c.length?" returning *":" returning *, ".concat(c.map(n=>"".concat((0,a.bD)(n),"::text[]")).join(","))),l+";"}function d(n,e){return 0===e.length?n:n+=" where ".concat(e.map(n=>{switch(n.operator){case"in":var e;let t;return t=Array.isArray((e=n).value)?e.value.map(n=>u(n)):String(e.value).split(",").map(n=>u(n)),"".concat((0,a.bD)(e.column)," ").concat(e.operator," (").concat(t.join(","),")");case"is":var o=n;let i=String(o.value);switch(i){case"null":case"false":case"true":case"not null":return"".concat((0,a.bD)(o.column)," ").concat(o.operator," ").concat(i);default:return"".concat((0,a.bD)(o.column)," ").concat(o.operator," ").concat(u(o.value))}default:return"".concat((0,a.bD)(n.column)," ").concat(n.operator," ").concat(u(n.value))}}).join(" and "))}function u(n){if("string"==typeof n&&!((null==n?void 0:n.startsWith("ARRAY["))&&(null==n?void 0:n.endsWith("]"))))return(0,a.eu)(n);return n}function m(n){return"".concat((0,a.bD)(n.schema),".").concat((0,a.bD)(n.name))}},48596:(n,e,t)=>{t.d(e,{GP:()=>s,bD:()=>r,eu:()=>l});let a=new Set(["AES128","AES256","ALL","ALLOWOVERWRITE","ANALYSE","ANALYZE","AND","ANY","ARRAY","AS","ASC","ASYMMETRIC","AUTHORIZATION","BACKUP","BETWEEN","BINARY","BLANKSASNULL","BOTH","BYTEDICT","CASE","CAST","CHECK","COLLATE","COLUMN","CONSTRAINT","CREATE","CREDENTIALS","CROSS","CURRENT_CATALOG","CURRENT_DATE","CURRENT_ROLE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURRENT_USER_ID","DEFAULT","DEFERRABLE","DEFLATE","DEFRAG","DELTA","DELTA32K","DESC","DISABLE","DISTINCT","DO","ELSE","EMPTYASNULL","ENABLE","ENCODE","ENCRYPT","ENCRYPTION","END","EXCEPT","EXPLICIT","FALSE","FETCH","FOR","FOREIGN","FREEZE","FROM","FULL","GLOBALDICT256","GLOBALDICT64K","GRANT","GROUP","GZIP","HAVING","IDENTITY","IGNORE","ILIKE","IN","INITIALLY","INNER","INTERSECT","INTO","IS","ISNULL","JOIN","LATERAL","LEADING","LEFT","LIKE","LIMIT","LOCALTIME","LOCALTIMESTAMP","LUN","LUNS","LZO","LZOP","MINUS","MOSTLY13","MOSTLY32","MOSTLY8","NATURAL","NEW","NOT","NOTNULL","NULL","NULLS","OFF","OFFLINE","OFFSET","OLD","ON","ONLY","OPEN","OR","ORDER","OUTER","OVERLAPS","PARALLEL","PARTITION","PERCENT","PLACING","PRIMARY","RAW","READRATIO","RECOVER","REFERENCES","REJECTLOG","RESORT","RESTORE","RETURNING","RIGHT","SELECT","SESSION_USER","SIMILAR","SOME","SYMMETRIC","SYSDATE","SYSTEM","TABLE","TAG","TDES","TEXT255","TEXT32K","THEN","TO","TOP","TRAILING","TRUE","TRUNCATECOLUMNS","UNION","UNIQUE","USER","USING","VARIADIC","VERBOSE","WALLET","WHEN","WHERE","WINDOW","WITH","WITHOUT"]),o={ident:"I",literal:"L",string:"s"};function i(n){return n.replace("T"," ").replace("Z","+00")}function c(n,e,t){let a="";for(let[o,i]of(a+=n?" (":"(",e.entries()))a+=(0===o?"":", ")+t(i);return a+")"}function r(n){if(null==n)throw Error("SQL identifier cannot be null or undefined");if(!1===n)return'"f"';if(!0===n)return'"t"';if(n instanceof Date)return'"'.concat(i(n.toISOString()),'"');if(Array.isArray(n)){let e=[];for(let t of n)if(!0===Array.isArray(t))throw TypeError("Nested array to grouped list conversion is not supported for SQL identifier");else e.push(r(t));return e.toString()}else if(n===Object(n))throw Error("SQL identifier cannot be an object");let e=String(n).slice(0);if(!0===/^[_a-z][\d$_a-z]*$/.test(e)&&!1==!!a.has(e.toUpperCase()))return e;let t='"';for(let n of e)t+='"'===n?n+n:n;return t+'"'}function l(n){let e,t="";if(null==n)return"NULL";if("bigint"==typeof n)return BigInt(n).toString();if(n===Number.POSITIVE_INFINITY)return"'Infinity'";if(n===Number.NEGATIVE_INFINITY)return"'-Infinity'";if(Number.isNaN(n))return"'NaN'";if("number"==typeof n)return Number(n).toString();if(!1===n)return"'f'";if(!0===n)return"'t'";if(n instanceof Date)return"'".concat(i(n.toISOString()),"'");if(Array.isArray(n)){let e=[];for(let[t,a]of n.entries())!0===Array.isArray(a)?e.push(c(0!==t,a,l)):e.push(l(a));return e.toString()}n===Object(n)?(e="jsonb",t=JSON.stringify(n)):t=String(n).slice(0);let a=!1,o="'";for(let n of t)"'"===n?o+=n+n:"\\"===n?(o+=n+n,a=!0):o+=n;return o+="'",!0===a&&(o="E".concat(o)),e&&(o+="::".concat(e)),o}function s(n){for(var e=arguments.length,t=Array(e>1?e-1:0),a=1;a<e;a++)t[a-1]=arguments[a];let s=0,d="%(%|(\\d+\\$)?[";d+=o.ident,d+=o.literal,d+=o.string;let u=RegExp(d+="])","g");return n.replace(u,(n,e)=>{if("%"===e)return"%";let a=s,d=e.split("$");if(d.length>1&&(a=Number.parseInt(d[0],10)-1,e=d[1]),a<0)throw Error("specified argument 0 but arguments start at 1");if(a>t.length-1)throw Error("too few arguments");return(s=a+1,e===o.ident)?r(t[a]):e===o.literal?l(t[a]):e===o.string?function n(e){if(null==e)return"";if(!1===e)return"f";if(!0===e)return"t";if(e instanceof Date)return i(e.toISOString());if(Array.isArray(e)){let t=[];for(let[a,o]of e.entries())null!=o&&(!0===Array.isArray(o)?t.push(c(0!==a,o,n)):t.push(n(o)));return t.toString()}return e===Object(e)?JSON.stringify(e):String(e).toString().slice(0)}(t[a]):void 0})}}}]);