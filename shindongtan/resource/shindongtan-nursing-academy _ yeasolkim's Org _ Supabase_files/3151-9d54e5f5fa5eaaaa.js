!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="8887755c-e673-4cff-95bd-b0b34271b780",e._sentryDebugIdIdentifier="sentry-dbid-8887755c-e673-4cff-95bd-b0b34271b780")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3151],{10585:(e,n,t)=>{t.d(n,{A:()=>s});var a=t(80263),r=t(55866);let s=e=>{let{resourceText:n,isFullPage:t=!1}=e,s=()=>(0,a.jsx)("div",{className:"block w-full rounded border border-opacity-20 py-4 px-6 border-overlay bg-surface-200","data-sentry-component":"NoPermissionMessage","data-sentry-source-file":"NoPermission.tsx",children:(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("div",{className:"mt-1",children:(0,a.jsx)(r.A,{size:20,"data-sentry-element":"AlertCircle","data-sentry-source-file":"NoPermission.tsx"})}),(0,a.jsx)("div",{className:"flex w-full items-center justify-between",children:(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("p",{className:"text-sm",children:["You need additional permissions to ",n]}),(0,a.jsx)("div",{children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Contact your organization owner or administrator for assistance."})})]})})]})});return t?(0,a.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,a.jsx)("div",{className:"w-[550px]",children:(0,a.jsx)(s,{})})}):(0,a.jsx)(s,{})}},20565:(e,n,t)=>{t.d(n,{U:()=>et,A:()=>ea});var a=t(80263),r=t(59153),s=t.n(r),i=t(9574),l=t(41615),o=t(40402),c=t(68875),d=t(64036),u=t(70324),m=t(83086),x=t(60045),f=t(53239),p=t(73969),h=t(19898),g=t(75493),b=t(27683),v=t(63720),j=t(10585),y=t(2409),_=t(68215),w=t(77227),N=t(34969),S=t(60753),C=t(32981),k=t(7588),P=t(62659),I=t(6742),R=t(44679),E=t(83408),A=t(87494),L=t(39353),V=t(84478),T=t(37081),z=t(56947),O=t(40807),G=t(20081);async function F(e,n){let{connectionId:t}=e;if(!t)throw Error("connectionId is required");let{data:a,error:r}=await (0,O.Jt)("/platform/integrations/github/branches/{connectionId}",{params:{path:{connectionId:t}},signal:n});return r&&(0,O.H4)(r),a}let B=function(e){let{connectionId:n}=e,{enabled:t=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,z.I)(G.Z.githubBranchesList(n),e=>{let{signal:t}=e;return F({connectionId:n},t)},{enabled:t&&void 0!==n,...a})};var H=t(32144),U=t(80251);async function D(e,n){let{connectionId:t,workdir:a,supabaseChangesOnly:r,branchLimit:s}=e,{data:i,error:l}=await (0,O.F6)("/platform/integrations/github/connections/{connection_id}",{params:{path:{connection_id:String(t)}},signal:n,body:{workdir:a,supabase_changes_only:r,branch_limit:s}});return l&&(0,O.H4)(l),i}let M=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,H.jE)();return(0,U.n)(e=>D(e),{async onSuccess(n,t,r){await Promise.all([a.invalidateQueries(G.Z.githubConnectionsList(t.organizationId))]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?p.oR.error("Failed to update Github connection: ".concat(e.message)):n(e,t,a)},...t})};var Z=t(97380),J=t(95793),$=t(71126),Y=t(51859),Q=t(36141),W=t(57980),X=t(24794),K=t(91378);let q=e=>{var n,t,r,s,i,l,o,d,h,g,b,v,j,y,_,S;let{disabled:z,connection:O}=e,G=(0,N.a)(),F=(0,c.KT)(),[H,U]=(0,f.useState)(!1),D=(0,f.useRef)(null),q=(null==F?void 0:F.is_branch_enabled)===!0||(null==F?void 0:F.parent_project_ref)!==void 0,ee=(0,w.SE)(x.aG.UPDATE,"integrations.github_connections"),{data:en,isLoading:et}=B({connectionId:Number(O.id)},{enabled:q}),{mutate:ea,isLoading:er}=M({onSuccess:()=>p.oR.success("Successfully updated connection settings")}),{mutate:es,isLoading:ei}=(0,V.O)({onSuccess:e=>{p.oR.success("Successfully updated production branch to ".concat(e.git_branch)),U(!1)}}),{data:el}=(0,T.A)({projectRef:null==F?void 0:F.parentRef},{enabled:void 0!==F}),eo=null==el?void 0:el.find(e=>e.is_default),ec=L.Ik({supabaseDirectory:L.Yj().default(null!=(y=null==(t=O.metadata)||null==(n=t.supabaseConfig)?void 0:n.supabaseDirectory)?y:""),supabaseChangesOnly:L.zM().default(null!=(_=null==(s=O.metadata)||null==(r=s.supabaseConfig)?void 0:r.supabaseChangesOnly)&&_),branchLimit:L.Yj().default(String(null!=(S=null==(l=O.metadata)||null==(i=l.supabaseConfig)?void 0:i.branchLimit)?S:50))}),ed=(0,A.mN)({resolver:(0,C.u)(ec),defaultValues:{supabaseDirectory:null==O||null==(d=O.metadata)||null==(o=d.supabaseConfig)?void 0:o.supabaseDirectory,supabaseChangesOnly:null==O||null==(g=O.metadata)||null==(h=g.supabaseConfig)?void 0:h.supabaseChangesOnly,branchLimit:String(null==O||null==(v=O.metadata)||null==(b=v.supabaseConfig)?void 0:b.branchLimit)}});function eu(e){if((null==G?void 0:G.id)===void 0)return console.error("Org ID is required");ea({connectionId:O.id,organizationId:null==G?void 0:G.id,workdir:e.supabaseDirectory,supabaseChangesOnly:e.supabaseChangesOnly,branchLimit:Number(e.branchLimit)})}return(0,a.jsxs)("div",{className:"flex flex-col gap-6 px-6 py-4","data-sentry-component":"GitHubIntegrationConnectionForm","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:[q?(0,a.jsxs)("div",{children:[(0,a.jsx)(Z.J,{className:"text-foreground",children:"Production branch"}),(0,a.jsx)("p",{className:"text-xs text-foreground-light mb-3",children:"All other branches will be treated as Preview branches"}),(0,a.jsxs)(u.Fc,{children:[(0,a.jsx)(u.XL,{className:"text-sm",children:"Changing Git branch for Production Branch coming soon"}),(0,a.jsx)(u.TN,{className:"text-xs",children:"If you wish to change the Git branch that is used for the Production Branch you will need to disable Branching and opt back in."})]}),(0,a.jsxs)(J.AM,{open:H,onOpenChange:U,modal:!1,children:[(0,a.jsx)(J.Wv,{asChild:!0,name:"branch-selector",children:(0,a.jsx)($.$,{disabled:!0,type:"default",size:"medium",ref:D,className:(0,Y.cn)("justify-start w-80 mt-4",(null==eo?void 0:eo.git_branch)===void 0?"text-foreground-light":"text"),icon:(null==eo?void 0:eo.git_branch)&&(0,a.jsx)(k.A,{className:"w-4 h-4 text-warning",strokeWidth:1}),loading:ei||et,iconRight:(0,a.jsx)("span",{className:"grow flex justify-end",children:(0,a.jsx)(P.A,{size:14})}),children:(null==eo?void 0:eo.git_branch)||"Select a branch"})}),(0,a.jsx)(J.hl,{className:"p-0",side:"bottom",align:"start",style:{width:null==(j=D.current)?void 0:j.offsetWidth},children:(0,a.jsxs)(Q.uB,{children:[(0,a.jsx)(Q.G7,{placeholder:"Find branch..."}),(0,a.jsxs)(Q.oI,{children:[(0,a.jsx)(Q.xL,{children:"No branches found"}),(0,a.jsx)(Q.L$,{children:null==en?void 0:en.map(e=>{let n=e.name===(null==eo?void 0:eo.git_branch);return(0,a.jsxs)(Q.h_,{value:e.name.replaceAll('"',""),className:"cursor-pointer w-full flex items-center justify-between",onSelect:()=>{U(!1),function(e){(null==F?void 0:F.parentRef)&&eo&&es({id:eo.id,projectRef:F.parentRef,branchName:e,gitBranch:e})}(e.name)},children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[n?(0,a.jsx)(k.A,{className:"w-4 h-4 text-warning",strokeWidth:1}):(0,a.jsx)(I.A,{className:"w-4 h-4",strokeWidth:1}),e.name]}),e.name===(null==eo?void 0:eo.git_branch)&&(0,a.jsx)(R.A,{})]},e.name)})})]})]})})]})]}):(0,a.jsxs)(u.Fc,{className:"w-full mb-0",variant:"warning",children:[(0,a.jsx)(m.id,{}),(0,a.jsxs)("div",{children:[(0,a.jsx)(u.XL,{className:"text-sm",children:"Branching is not enabled"}),(0,a.jsxs)(u.TN,{className:"text-xs",children:["This integration has no effect without Branching feature being active.",(0,a.jsx)("br",{}),'Make sure to enable it using "Enable branching" button at the top of the page first.']})]})]}),(0,a.jsx)(W.lV,{...ed,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx",children:(0,a.jsxs)("form",{onSubmit:ed.handleSubmit(eu),className:"flex flex-col gap-6",children:[(0,a.jsx)(W.zB,{control:ed.control,name:"branchLimit",render:e=>{var n,t,r,s,i,l;let{field:o}=e;return(0,a.jsxs)(W.eI,{className:"flex flex-col",children:[(0,a.jsx)(W.lR,{className:"!text",children:"Branch limit"}),(0,a.jsx)(W.Rr,{className:"text-xs text-foreground-lighter !mt-0 !mb-1",children:"Total number of branches that can be automatically created for this connection."}),(0,a.jsx)(W.MJ,{className:"flex gap-3 items-center",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(X.p,{...o,className:"w-80",disabled:z||!ee,onKeyPress:e=>{"Escape"===e.key&&ed.reset()},type:"number"}),(0,a.jsx)(E.A,{className:(0,Y.cn)("text-foreground-lighter transition hover:text cursor-pointer","w-4 h-4 absolute right-3 top-3","duration-150",o.value!==String(null==(t=O.metadata)||null==(n=t.supabaseConfig)?void 0:n.branchLimit)?"opacity-100 transition":"opacity-0"),onClick:()=>ed.reset()}),(0,a.jsx)($.$,{loading:er,className:(0,Y.cn)("duration-150 transition",o.value!==String(null==(s=O.metadata)||null==(r=s.supabaseConfig)?void 0:r.branchLimit)?"opacity-100":"opacity-0"),htmlType:"submit",disabled:o.value===String(null==(l=O.metadata)||null==(i=l.supabaseConfig)?void 0:i.branchLimit),children:"Update"})]})})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"}),(0,a.jsx)(W.zB,{control:ed.control,name:"supabaseDirectory",render:e=>{var n,t,r,s,i,l;let{field:o}=e;return(0,a.jsxs)(W.eI,{className:"flex flex-col",children:[(0,a.jsx)(W.lR,{className:"!text",children:"Supabase directory"}),(0,a.jsxs)(W.Rr,{className:"text-xs text-foreground-lighter !mt-0 !mb-1",children:["Path in your repository where ",(0,a.jsx)("code",{children:"supabase"})," directory for this connection lives."]}),(0,a.jsx)(W.MJ,{className:"flex gap-3 items-center",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(X.p,{...o,disabled:z||!ee,className:"w-80",onKeyPress:e=>{"Escape"===e.key&&ed.reset()}}),(0,a.jsx)(E.A,{className:(0,Y.cn)("text-foreground-lighter transition hover:text cursor-pointer","w-4 h-4 absolute right-3 top-3","duration-150",o.value!==(null==(t=O.metadata)||null==(n=t.supabaseConfig)?void 0:n.supabaseDirectory)?"opacity-100 transition":"opacity-0"),onClick:()=>ed.reset()}),(0,a.jsx)($.$,{loading:er,className:(0,Y.cn)("duration-150 transition",o.value!==(null==(s=O.metadata)||null==(r=s.supabaseConfig)?void 0:r.supabaseDirectory)?"opacity-100":"opacity-0"),htmlType:"submit",disabled:""===o.value||o.value===(null==(l=O.metadata)||null==(i=l.supabaseConfig)?void 0:i.supabaseDirectory),children:"Update"})]})})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"}),(0,a.jsx)(W.zB,{control:ed.control,name:"supabaseChangesOnly",render:e=>{let{field:n}=e;return(0,a.jsxs)(W.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(W.MJ,{children:(0,a.jsx)(K.d,{className:"mt-1",disabled:z||!ee,checked:n.value,onCheckedChange:e=>{n.onChange(e),ed.handleSubmit(eu)()}})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(W.lR,{className:"!text",children:"Supabase changes only"}),(0,a.jsxs)(W.Rr,{className:"text-xs text-foreground-lighter",children:["Trigger branch creation only when there were changes to ",(0,a.jsx)("code",{children:"supabase"})," ","directory."]})]})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"GitHubIntegrationConnectionForm.tsx"})]})})]})},ee=()=>{var e;let{ref:n}=(0,h.g)(),t=(0,c.KT)(),r=(0,N.a)(),s=(0,S.bZ)(),i=(null==t?void 0:t.parent_project_ref)!==void 0,l=(0,w.SE)(x.aG.READ,"integrations.github_connections"),d=(0,w.SE)(x.aG.CREATE,"integrations.github_connections"),u=(0,w.SE)(x.aG.UPDATE,"integrations.github_connections"),{data:m}=(0,_.O)({organizationId:null==r?void 0:r.id}),{mutateAsync:C}=(0,y.L)({onSuccess:()=>{p.oR.success("Successfully deleted Github connection")}}),k=null!=(e=null==m?void 0:m.filter(e=>i?e.project.ref===t.parent_project_ref:e.project.ref===n))?e:[],P=(0,f.useCallback)(()=>{s.setGithubConnectionsOpen(!0)},[s]),I=(0,f.useCallback)(async e=>{if(!(null==r?void 0:r.id))return void p.oR.error("Organization not found");await C({connectionId:e.id,organizationId:r.id})},[C,null==r?void 0:r.id]);return(0,a.jsx)(o.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"GitHubSection","data-sentry-source-file":"GithubSection.tsx",children:(0,a.jsxs)(o.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"GithubSection.tsx",children:[(0,a.jsxs)(o.xp,{title:"GitHub Connections","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"GithubSection.tsx",children:[(0,a.jsx)(v.o,{content:"\nConnect any of your GitHub repositories to a project.\n","data-sentry-element":"Markdown","data-sentry-source-file":"GithubSection.tsx"}),(0,a.jsx)(et,{title:"github","data-sentry-element":"IntegrationImageHandler","data-sentry-source-file":"GithubSection.tsx"})]}),(0,a.jsx)(o.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"GithubSection.tsx",children:l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.o,{content:"\n\n### How will GitHub connections work?\n\nYou will be able to connect a GitHub repository to a Supabase project.\nThe GitHub app will watch for changes in your repository such as file changes, branch changes as well as pull request activity.\n"}),k.length>0?(0,a.jsx)("ul",{className:"flex flex-col",children:k.map(e=>{var n,t,r,s,l,o,c,d,m,x;return(0,a.jsxs)("div",{className:"relative flex flex-col -gap-[1px] [&>li]:pb-0",children:[(0,a.jsx)(g.S,{showNode:!1,disabled:i||!u,connection:{id:String(e.id),added_by:{id:String(null==(n=e.user)?void 0:n.id),primary_email:null!=(c=null==(t=e.user)?void 0:t.primary_email)?c:"",username:null!=(d=null==(r=e.user)?void 0:r.username)?d:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name}},type:"GitHub",onDeleteConnection:I,className:"!rounded-b-none !mb-0"},e.id),(0,a.jsx)("div",{className:"border-b border-l border-r rounded-b-lg",children:(0,a.jsx)(q,{disabled:i||!u,connection:{id:String(e.id),added_by:{id:String(null==(s=e.user)?void 0:s.id),primary_email:null!=(m=null==(l=e.user)?void 0:l.primary_email)?m:"",username:null!=(x=null==(o=e.user)?void 0:o.username)?x:""},foreign_project_id:String(e.repository.id),supabase_project_ref:e.project.ref,organization_integration_id:"unused",inserted_at:e.inserted_at,updated_at:e.updated_at,metadata:{name:e.repository.name,supabaseConfig:{supabaseDirectory:e.workdir,supabaseChangesOnly:e.supabase_changes_only,branchLimit:e.branch_limit}}}})})]},e.id)})}):(0,a.jsx)(b.MJ,{onClick:P,showNode:!1,disabled:i||!d,children:"Add new project connection"})]}):(0,a.jsx)(j.A,{resourceText:"view this organization's GitHub connections"})})]})})};var en=t(21019);let et=e=>{let{title:n}=e;return(0,a.jsx)("img",{className:"border rounded-lg shadow w-full sm:w-48 mt-6 border-body",src:"".concat(d.o2,"/img/integrations/covers/").concat(n,"-cover.png"),alt:"".concat(n," cover"),"data-sentry-component":"IntegrationImageHandler","data-sentry-source-file":"IntegrationsSettings.tsx"})},ea=()=>{let e=(0,c.KT)(),n=(0,c.Ne)(null==e?void 0:e.parent_project_ref),t=(null==e?void 0:e.parent_project_ref)!==void 0;return(0,a.jsxs)(a.Fragment,{children:[t&&(0,a.jsx)(o.eh,{children:(0,a.jsxs)(u.Fc,{variant:"default",className:"mt-6",children:[(0,a.jsx)(m.id,{}),(0,a.jsx)(u.XL,{children:"You are currently on a preview branch of your project"}),(0,a.jsxs)(u.TN,{children:["To adjust your project's integration settings, you may return to your"," ",(0,a.jsx)(s(),{href:"/project/".concat(null==n?void 0:n.ref,"/settings/general"),className:"text-brand",children:"main branch"}),"."]})]})}),(0,a.jsx)(ee,{"data-sentry-element":"GitHubSection","data-sentry-source-file":"IntegrationsSettings.tsx"}),(0,a.jsx)(o.cJ,{"data-sentry-element":"ScaffoldDivider","data-sentry-source-file":"IntegrationsSettings.tsx"}),(0,a.jsx)(en.A,{isProjectScoped:!0,"data-sentry-element":"VercelSection","data-sentry-source-file":"IntegrationsSettings.tsx"}),(0,a.jsx)(l.A,{"data-sentry-element":"SidePanelVercelProjectLinker","data-sentry-source-file":"IntegrationsSettings.tsx"}),(0,a.jsx)(i.A,{"data-sentry-element":"SidePanelGitHubRepoLinker","data-sentry-source-file":"IntegrationsSettings.tsx"})]})}},21019:(e,n,t)=>{t.d(n,{A:()=>D});var a=t(80263),r=t(77877),s=t(59153),i=t.n(s),l=t(53239),o=t(73969),c=t(60045),d=t(75493),u=t(27683),m=t(63720),x=t(40402),f=t(10585),p=t(93637),h=t(32144),g=t(80251),b=t(40807),v=t(20081);async function j(e,n){let{organization_integration_id:t,id:a}=e;if(!t)throw Error("organization_integration_id is required");let{data:r,error:s}=await (0,b.yH)("/platform/integrations/vercel/connections/{connection_id}",{params:{path:{connection_id:a}},signal:n});return s&&(0,b.H4)(s),r}let y=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,h.jE)();return(0,g.n)(e=>j(e),{async onSuccess(n,t,r){await Promise.all([a.invalidateQueries(v.Z.integrationsList()),a.invalidateQueries(v.Z.integrationsListWithOrg(t.orgSlug)),a.invalidateQueries(v.Z.vercelProjectList(t.organization_integration_id)),a.invalidateQueries(v.Z.vercelConnectionsList(t.organization_integration_id))]),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?o.oR.error("Failed to delete Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var _=t(24038),w=t(77227),N=t(34969),S=t(68875),C=t(49443),k=t(42963),P=t(60753),I=t(51859),R=t(71126),E=t(20565),A=t(32981),L=t(87494),V=t(39353),T=t(95268);async function z(e){let{id:n,envSyncTargets:t,publicEnvVarPrefix:a}=e,{data:r,error:s}=await (0,b.F6)("/platform/integrations/vercel/connections/{connection_id}",{params:{path:{connection_id:n}},body:{env_sync_targets:t,public_env_var_prefix:a}});return s&&(0,b.H4)(s),r}let O=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=(0,h.jE)();return(0,g.n)(e=>z(e),{async onSuccess(n,t,r){await a.invalidateQueries(v.Z.vercelConnectionsList(t.organizationIntegrationId)),await (null==e?void 0:e(n,t,r))},async onError(e,t,a){void 0===n?o.oR.error("Failed to update Vercel connection: ".concat(e.message)):n(e,t,a)},...t})};var G=t(57980),F=t(70324),B=t(91378),H=t(24794);let U=e=>{var n;let{disabled:t,connection:r,integration:s}=e,l=(0,N.a)(),c=(null==l?void 0:l.managed_by)==="vercel-marketplace"?[]:null!=(n=r.env_sync_targets)?n:[],d=V.Ik({environmentVariablesProduction:V.zM().default(c.includes("production")),environmentVariablesPreview:V.zM().default(c.includes("preview")),environmentVariablesDevelopment:V.zM().default(c.includes("development")),publicEnvVarPrefix:V.Yj().optional()}),u=(0,L.mN)({resolver:(0,A.u)(d),defaultValues:{environmentVariablesProduction:c.includes("production"),environmentVariablesPreview:c.includes("preview"),environmentVariablesDevelopment:c.includes("development"),publicEnvVarPrefix:r.public_env_var_prefix}}),{mutate:m,isLoading:x}=O({onSuccess:()=>{u.reset(u.getValues()),o.oR.success("Updated Vercel connection")}}),f="vercel-connection-form-".concat(r.id);return(0,a.jsx)(G.lV,{...u,"data-sentry-element":"Form_Shadcn_","data-sentry-component":"VercelIntegrationConnectionForm","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx",children:(0,a.jsx)("form",{id:f,onSubmit:u.handleSubmit(function(e){var n;let{environmentVariablesProduction:t,environmentVariablesPreview:a,environmentVariablesDevelopment:i}=e,l=[];t&&l.push("production"),a&&l.push("preview"),i&&l.push("development"),m({id:r.id,envSyncTargets:l,publicEnvVarPrefix:null==(n=e.publicEnvVarPrefix)?void 0:n.trim(),organizationIntegrationId:s.id})}),className:"w-full space-y-6",children:(0,a.jsxs)("div",{className:"px-6 py-4 flex flex-col gap-y-4",children:[(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(null==l?void 0:l.managed_by)==="vercel-marketplace"?(0,a.jsxs)(F.Fc,{children:[(0,a.jsx)(F.XL,{className:"text-sm",children:"Vercel Marketplace managed project"}),(0,a.jsxs)(F.TN,{className:"text-xs",children:["This project is managed via Vercel Marketplace. Environment variables are automatically synchronized for your connected Vercel projects. This integration purpose is synchronizing preview deployments environment variables with our"," ",(0,a.jsx)(i(),{target:"_blank",rel:"noreferrer",href:"https://supabase.com/docs/guides/platform/branching",className:"underline",children:"Branching"})," ","feature."]})]}):(0,a.jsxs)("div",{children:[(0,a.jsx)("h5",{className:"text-foreground text-sm",children:"Sync environment variables for selected target environments"}),(0,a.jsx)(G.zB,{control:u.control,name:"environmentVariablesProduction",render:e=>{let{field:n}=e;return(0,a.jsxs)(G.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(G.MJ,{children:(0,a.jsx)(B.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(G.lR,{className:"!text",children:"Production"}),(0,a.jsxs)(G.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"production"})," environment."]})]})]})}}),(0,a.jsx)(G.zB,{control:u.control,name:"environmentVariablesPreview",render:e=>{let{field:n}=e;return(0,a.jsxs)(G.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(G.MJ,{children:(0,a.jsx)(B.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(G.lR,{className:"!text",children:"Preview"}),(0,a.jsxs)(G.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"preview"})," environment."]})]})]})}}),(0,a.jsx)(G.zB,{control:u.control,name:"environmentVariablesDevelopment",render:e=>{let{field:n}=e;return(0,a.jsxs)(G.eI,{className:"space-y-0 flex gap-x-4",children:[(0,a.jsx)(G.MJ,{children:(0,a.jsx)(B.d,{disabled:t,className:"mt-1",checked:n.value,onCheckedChange:n.onChange})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(G.lR,{className:"!text",children:"Development"}),(0,a.jsxs)(G.Rr,{className:"text-xs text-foreground-lighter",children:["Sync environment variables for ",(0,a.jsx)("code",{children:"development"})," environment."]})]})]})}})]})}),(0,a.jsx)("h5",{className:"mt-2 text-foreground text-sm",children:"Customize public environment variable prefix"}),(0,a.jsx)("div",{className:"flex flex-col gap-4",children:(0,a.jsx)(G.zB,{control:u.control,name:"publicEnvVarPrefix",render:e=>{let{field:n}=e;return(0,a.jsxs)(G.eI,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,a.jsx)(G.lR,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Prefix"}),(0,a.jsx)(G.MJ,{className:"col-span-8",children:(0,a.jsx)(H.p,{...n,className:"w-full",disabled:t,placeholder:"An empty prefix will result in no public env vars"})}),(0,a.jsxs)(G.Rr,{className:"col-start-5 col-span-8 text-xs",children:["e.g."," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("NEXT_PUBLIC_")},children:"NEXT_PUBLIC_"}),","," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("VITE_PUBLIC_")},children:"VITE_PUBLIC_"}),","," ",(0,a.jsx)("code",{className:"cursor-pointer",role:"button",onClick:()=>{n.onChange("PUBLIC_")},children:"PUBLIC_"}),", etc."]}),(0,a.jsx)(G.C5,{className:"col-start-5 col-span-8"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx"})}),u.formState.isDirty?(0,a.jsxs)("p",{className:"mt-2 text-sm text-warning-600",children:["Note: Changing these settings will ",(0,a.jsx)("strong",{children:"not"})," trigger a resync of environment variables."]}):(0,a.jsx)("div",{className:"mt-2 h-5 w-full"}),(0,a.jsx)(T.I,{disabled:t,form:f,hasChanges:u.formState.isDirty,isSubmitting:x,handleReset:()=>u.reset(),"data-sentry-element":"FormActions","data-sentry-source-file":"VercelIntegrationConnectionForm.tsx"})]})})})},D=e=>{var n;let{isProjectScoped:t}=e,s=(0,S.KT)(),h=(0,N.a)(),{data:g}=(0,p.$)({orgSlug:null==h?void 0:h.slug}),b=(0,P.bZ)(),v=(null==s?void 0:s.parent_project_ref)!==void 0,j=(0,w.SE)(c.aG.READ,"integrations.vercel_connections"),A=(0,w.SE)(c.aG.CREATE,"integrations.vercel_connections"),L=(0,w.SE)(c.aG.UPDATE,"integrations.vercel_connections"),{mutate:V}=y({onSuccess:()=>{o.oR.success("Successfully deleted Vercel connection")}}),T=(0,l.useMemo)(()=>null==g?void 0:g.filter(e=>"Vercel"===e.integration.name).map(e=>{if(e.metadata&&"Vercel"===e.integration.name){let n=e.metadata.account.avatar||"Team"!==e.metadata.account.type?"https://vercel.com/api/www/avatar/".concat(e.metadata.account.avatar,"?s=48"):"https://vercel.com/api/www/avatar?teamId=".concat(e.metadata.account.team_id,"&s=48");e.metadata.account.avatar=n}return e}),[g]),z=null==T?void 0:T[0],{data:O}=(0,_.b)({organization_integration_id:null==z?void 0:z.id},{enabled:(null==z?void 0:z.id)!==void 0}),G=null!=(n=null==O?void 0:O.length)?n:0,F=(0,l.useCallback)(e=>{b.setVercelConnectionsIntegrationId(e),b.setVercelConnectionsOpen(!0)},[b]),B=(0,l.useCallback)(async e=>{V({id:e.id,organization_integration_id:e.organization_integration_id,orgSlug:null==h?void 0:h.slug})},[V,null==h?void 0:h.slug]),H=G>0&&void 0!==z?"\nYour Vercel connection has access to ".concat(G," Vercel Projects.\nYou can change the scope of the access for Supabase by configuring\n[here](").concat((0,k.U)(z),").\n"):"",D=(t?null==z?void 0:z.connections.filter(e=>e.supabase_project_ref===(null==s?void 0:s.ref)):null==z?void 0:z.connections)||[],M="".concat(D.length," project ").concat((0,C.td)(D.length,"connection")," ");return(0,a.jsx)(x.eh,{"data-sentry-element":"ScaffoldContainer","data-sentry-component":"VercelSection","data-sentry-source-file":"VercelSection.tsx",children:(0,a.jsxs)(x.gu,{"data-sentry-element":"ScaffoldSection","data-sentry-source-file":"VercelSection.tsx",children:[(0,a.jsxs)(x.xp,{title:"Vercel Integration","data-sentry-element":"ScaffoldSectionDetail","data-sentry-source-file":"VercelSection.tsx",children:[(0,a.jsx)(m.o,{content:"\n\nConnect your Vercel teams to your Supabase organization.\n","data-sentry-element":"Markdown","data-sentry-source-file":"VercelSection.tsx"}),(0,a.jsx)(E.U,{title:"vercel","data-sentry-element":"IntegrationImageHandler","data-sentry-source-file":"VercelSection.tsx"})]}),(0,a.jsx)(x.Rf,{"data-sentry-element":"ScaffoldSectionContent","data-sentry-source-file":"VercelSection.tsx",children:j?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(m.o,{content:"\n\n### How does the Vercel integration work?\n\nSupabase will keep your environment variables up to date in each of the projects you assign to a Supabase project.\nYou can also link multiple Vercel Projects to the same Supabase project.\n"}),z?(0,a.jsxs)("div",{children:[(0,a.jsx)(u.Tt,{title:"Vercel",integration:z}),D.length>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(u.Q7,{title:M,markdown:"Repository connections for Vercel"}),(0,a.jsx)("ul",{className:"flex flex-col",children:D.map(e=>(0,a.jsxs)("div",{className:(0,I.cn)(t&&"relative flex flex-col -gap-[1px] [&>li]:pb-0"),children:[(0,a.jsx)(d.S,{connection:e,disabled:v||!L,type:"Vercel",onDeleteConnection:B,className:(0,I.cn)(t&&"!rounded-b-none !mb-0")}),t?(0,a.jsx)("div",{className:"relative pl-8 ml-6 border-l border-muted pb-6",children:(0,a.jsx)("div",{className:"border-b border-l border-r rounded-b-lg",children:(0,a.jsx)(U,{connection:e,integration:z,disabled:v||!L})})}):null]},e.id))})]}):(0,a.jsx)(u.Q7,{title:M,className:"pb-0",markdown:"Repository connections for Vercel"}),(0,a.jsx)(u.MJ,{disabled:v||!A,onClick:()=>F(z.id),children:"Add new project connection"})]},z.id):(0,a.jsx)("div",{children:(0,a.jsx)(R.$,{icon:(0,a.jsx)(r.A,{}),asChild:!v,type:"default",disabled:v,children:v?(0,a.jsx)("p",{children:"Install Vercel Integration"}):(0,a.jsx)(i(),{href:"https://vercel.com/integrations/supabase",target:"_blank",rel:"noreferrer",children:"Install Vercel Integration"})})}),H&&(0,a.jsx)(m.o,{extLinks:!0,content:H,className:"text-foreground-lighter"})]}):(0,a.jsx)(f.A,{resourceText:"view this organization's Vercel connections"})})]})})}},24038:(e,n,t)=>{t.d(n,{b:()=>l});var a=t(56947),r=t(40807),s=t(20081);async function i(e,n){let{organization_integration_id:t}=e;if(!t)throw Error("organization_integration_id is required");let{data:a,error:s}=await (0,r.Jt)("/platform/integrations/vercel/projects/{organization_integration_id}",{params:{path:{organization_integration_id:t},query:{limit:1e3}},signal:n});return s&&(0,r.H4)(s),a.projects}let l=function(e){let{organization_integration_id:n}=e,{enabled:t=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(s.Z.vercelProjectList(n),e=>{let{signal:t}=e;return i({organization_integration_id:n},t)},{enabled:t&&void 0!==n,...r})}},27683:(e,n,t)=>{t.d(n,{LT:()=>S,MJ:()=>k,Q7:()=>P,Tt:()=>N});var a=t(80263),r=t(53434),s=t.n(r),i=t(87176),l=t.n(i),o=t(53239),c=t(63720),d=t(41370),u=t(84438),m=t(64036),x=t(42963),f=t(96282),p=t(77877),h=t(76733),g=t(59153),b=t.n(g),v=t(51859),j=t(65863),y=t(71126);let _=e=>{let{type:n,className:t}=e;switch(n){case"GitHub":return(0,a.jsx)(f.A,{strokeWidth:2,size:14});case"Vercel":return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 512 512",className:(0,v.cn)("w-3.5",t),children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M256,48,496,464H16Z"})});case"Supabase":return(0,a.jsx)("img",{src:"".concat(m.o2,"/img/supabase-logo.svg"),alt:"Supabase",className:"w-3.5"});default:return(0,a.jsx)(a.Fragment,{})}},w=e=>{let{src:n}=e;return(0,a.jsx)("div",{className:"relative border shadow-lg w-8 h-8 rounded-full overflow-hidden","data-sentry-component":"Avatar","data-sentry-source-file":"IntegrationPanels.tsx",children:(0,a.jsx)(l(),{src:n||"",width:30,height:30,layout:"fill",alt:"avatar",className:"relative","data-sentry-element":"Image","data-sentry-source-file":"IntegrationPanels.tsx"})})},N=(0,o.forwardRef)((e,n)=>{var t,r,i,l,o;let{integration:c,disabled:d,...u}=e;return(0,a.jsxs)("li",{ref:n,className:"bg-surface-100 border shadow-sm flex justify-between items-center px-8 py-4 rounded-lg",...u,children:[(0,a.jsxs)("div",{className:"flex gap-6 items-center",children:[(0,a.jsx)("div",{className:"flex gap-3 items-center",children:(0,a.jsxs)("div",{className:"flex -space-x-1",children:[(0,a.jsx)(()=>(0,a.jsx)("div",{className:"bg-black text-white w-8 h-8 rounded flex items-center justify-center","data-sentry-component":"IntegrationIconBlock","data-sentry-source-file":"IntegrationPanels.tsx",children:(0,a.jsx)(_,{type:c.integration.name,"data-sentry-element":"HandleIcon","data-sentry-source-file":"IntegrationPanels.tsx"})}),{}),(0,a.jsx)(w,{src:null==c||null==(t=c.metadata)?void 0:t.account.avatar})]})}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-foreground text-sm font-medium",children:(null==(r=c.metadata)?void 0:r.account.name)||void 0!==c.metadata&&"gitHubConnectionOwner"in c.metadata&&(null==(i=c.metadata)?void 0:i.gitHubConnectionOwner)}),(0,a.jsx)(j.E,{className:"capitalize",children:null==(l=c.metadata)?void 0:l.account.type})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Created ",s()(c.inserted_at).fromNow()]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Added by ",null==c||null==(o=c.added_by)?void 0:o.primary_email]})]})]})]}),(0,a.jsx)(y.$,{asChild:!0,disabled:d,type:"default",iconRight:(0,a.jsx)(p.A,{}),children:d?(0,a.jsx)("p",{children:"Manage"}):(0,a.jsx)(b(),{href:(0,x.U)(c),target:"_blank",rel:"noopener noreferrer",children:"Manage"})})]},c.id)}),S=(0,o.forwardRef)((e,n)=>{var t,r,i,l,o;let{connection:c,type:d,actions:x,showNode:f=!0,orientation:p="horizontal",className:g,...b}=e,{data:j}=(0,u.el)(),y=null==j?void 0:j.find(e=>e.ref===c.supabase_project_ref);return(0,a.jsxs)("li",{ref:n,...b,className:(0,v.cn)(f&&"pl-8 ml-6 border-l border-muted","relative"),children:[f&&(0,a.jsx)("div",{className:"absolute w-8 rounded-bl-full border-b border-l border-muted h-10 -left-px"}),(0,a.jsxs)("div",{className:(0,v.cn)("horizontal"===p?"flex items-center justify-between gap-2":"flex flex-col gap-3","bg-surface-100 border shadow-sm px-6 py-4 rounded-lg",g),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("div",{className:"flex-shrink-0 flex gap-x-2 items-center max-w-40 ",children:[(0,a.jsx)(_,{type:"Supabase"}),(0,a.jsx)("span",{title:null==y?void 0:y.name,className:"text-sm truncate",children:null==y?void 0:y.name})]}),(0,a.jsx)(h.A,{size:14,className:"flex-shrink-0 text-foreground-lighter",strokeWidth:1.5}),(0,a.jsxs)("div",{className:"flex-1 min-w-0 flex gap-2 items-center",children:[(null==c||null==(t=c.metadata)?void 0:t.framework)?(0,a.jsx)("img",{src:"".concat(m.o2,"/img/icons/frameworks/").concat(c.metadata.framework,".svg"),width:21,height:21,alt:"icon"}):(0,a.jsx)("div",{className:"bg-black text-white w-4 h-4 rounded flex items-center justify-center",children:(0,a.jsx)(_,{type:d,className:"!w-2.5"})}),"GitHub"===d?(0,a.jsx)("a",{title:c.metadata.name,href:"https://github.com/".concat(null==(r=c.metadata)?void 0:r.name),className:"text-sm truncate",target:"_blank",rel:"noreferrer",children:null==(i=c.metadata)?void 0:i.name}):(0,a.jsx)("span",{title:c.metadata.name,className:"text-sm truncate",children:null==(l=c.metadata)?void 0:l.name})]})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-0",children:[(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Connected ",s()(null==c?void 0:c.inserted_at).fromNow()]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Added by ",null==c||null==(o=c.added_by)?void 0:o.primary_email]})]})]}),(0,a.jsx)("div",{className:"flex-shrink-0",children:x})]})]},c.id)}),C=(0,o.forwardRef)((e,n)=>{let{connection:t,type:r,...i}=e,{data:l}=(0,u.el)(),o=null==l?void 0:l.find(e=>e.ref===t.supabase_project_ref);return(0,a.jsxs)("li",{ref:n,...i,className:(0,v.cn)("bg-surface-100 border shadow-sm flex justify-between items-center px-8 py-4 rounded-lg"),children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,a.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,a.jsx)(_,{type:"Supabase"}),(0,a.jsx)("span",{className:"text-sm",children:null==o?void 0:o.name}),(0,a.jsx)(h.A,{size:14,className:"text-foreground-lighter",strokeWidth:1.5}),(0,a.jsx)(_,{type:r}),(0,a.jsx)("span",{className:"text-sm",children:t.metadata.name})]}),(0,a.jsxs)("span",{className:"text-foreground-lighter text-xs",children:["Connected ",s()(t.inserted_at).fromNow()]})]}),(0,a.jsx)(y.$,{type:"default",children:"Connect"})]},t.id)}),k=(0,o.forwardRef)((e,n)=>{let{className:t,showNode:r=!0,onClick:s,disabled:i,...l}=e;return(0,a.jsxs)("div",{ref:n,...l,className:(0,v.cn)(r&&"ml-6 pl-8 mt-4 border-l","relative pb-2","last:border-l-transparent",t),children:[r&&(0,a.jsx)("div",{className:"absolute w-8 rounded-bl-full border-b border-l border-muted h-14 -top-4 -left-px"}),(0,a.jsx)("div",{className:(0,v.cn)("w-full","border border-dashed bg-surface-100 border-overlay","flex h-20 px-10 rounded-lg justify-center items-center"),children:(0,a.jsx)(d.G,{type:"default",disabled:i,onClick:()=>s(),tooltip:{content:{side:"bottom",text:i?"Additional permissions required to add connection":void 0}},children:"Add new project connection"})})]})}),P=(0,o.forwardRef)((e,n)=>{let{className:t,markdown:r="",showNode:s=!0,...i}=e;return(0,a.jsxs)("div",{...i,ref:n,className:(0,v.cn)(s&&"border-l border-muted ml-6 pl-8","py-4 prose text-sm",t),children:[i.title&&(0,a.jsx)("h5",{className:"text-foreground",children:i.title}),(0,a.jsx)(c.o,{content:r})]})});N.displayName="IntegrationInstallation",S.displayName="IntegrationConnection",P.displayName="IntegrationConnectionHeader",k.displayName="EmptyIntegrationConnection",C.displayName="IntegrationConnectionOption"},40402:(e,n,t)=>{t.d(n,{BS:()=>l,Dm:()=>d,HJ:()=>v,Rf:()=>g,Uw:()=>c,Vw:()=>_,Xr:()=>y,aw:()=>p,bV:()=>i,cJ:()=>x,dX:()=>u,eh:()=>o,fh:()=>j,gu:()=>m,sZ:()=>f,tn:()=>b,xp:()=>h});var a=t(80263),r=t(53239),s=t(51859);let i="mx-auto w-full max-w-[1200px]",l="px-4 @lg:px-6 @xl:px-12 @2xl:px-20 @3xl:px-24",o=(0,r.forwardRef)((e,n)=>{let{className:t,bottomPadding:r,size:i="default",...o}=e;return(0,a.jsx)("div",{ref:n,...o,className:(0,s.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[i],l,r&&"pb-16",t)})}),c=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("header",{...r,ref:n,className:(0,s.cn)("w-full","flex-col gap-3 py-6",t)})}),d=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("h1",{ref:n,...r,className:(0,s.cn)("text-2xl",t)})}),u=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:n,...r,className:(0,s.cn)("text-sm text-foreground-light",t)})}),m=(0,r.forwardRef)((e,n)=>{let{className:t,isFullWidth:r,topPadding:i,...l}=e;return(0,a.jsx)("div",{ref:n,...l,className:(0,s.cn)("flex flex-col first:pt-12 py-6",r?"w-full":"gap-3 lg:grid md:grid-cols-12",t)})}),x=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("w-full h-px bg-border",t)})}),f=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:n,...r,className:(0,s.cn)("text-foreground text-xl",t)})}),p=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:n,...r,className:(0,s.cn)("text-sm text-foreground-light",t)})}),h=(0,r.forwardRef)((e,n)=>{let{className:t,children:r,title:i,...l}=e;return(0,a.jsxs)("div",{ref:n,...l,className:(0,s.cn)("col-span-4 xl:col-span-5 prose text-sm",t),children:[i&&(0,a.jsx)("h2",{children:i}),r]})}),g=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",t)})}),b=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("flex flex-col gap-3 items-center",t)})}),v=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("flex w-full items-center",t)})}),j=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("flex flex-row gap-3",t)})}),y=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)("flex flex-col gap-3","min-w-[420px]",t)})}),_=(0,r.forwardRef)((e,n)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:n,...r,className:(0,s.cn)(i,l,"my-8 flex flex-col gap-8",t)})});c.displayName="ScaffoldHeader",d.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",o.displayName="ScaffoldContainer",x.displayName="ScaffoldDivider",m.displayName="ScaffoldSection",y.displayName="ScaffoldColumn",h.displayName="ScaffoldSectionDetail",g.displayName="ScaffoldSectionContent",b.displayName="ScaffoldFilterAndContent",v.displayName="ScaffoldActionsContainer",j.displayName="ScaffoldActionsGroup",_.displayName="ScaffoldContainerLegacy",f.displayName="ScaffoldSectionTitle",p.displayName="ScaffoldSectionDescription"},41529:(e,n,t)=>{t.d(n,{O:()=>a});let a=Object.values({POSTGRES_URL:{key:"POSTGRES_URL",type:"encrypted"},POSTGRES_PRISMA_URL:{key:"POSTGRES_PRISMA_URL",type:"encrypted"},POSTGRES_URL_NON_POOLING:{key:"POSTGRES_URL_NON_POOLING",type:"encrypted"},POSTGRES_USER:{key:"POSTGRES_USER",type:"encrypted"},POSTGRES_HOST:{key:"POSTGRES_HOST",type:"encrypted"},POSTGRES_PASSWORD:{key:"POSTGRES_PASSWORD",type:"encrypted"},POSTGRES_DATABASE:{key:"POSTGRES_DATABASE",type:"encrypted"},SUPABASE_ANON_KEY:{key:"SUPABASE_ANON_KEY",type:"encrypted"},SUPABASE_URL:{key:"SUPABASE_URL",type:"encrypted"},SUPABASE_SERVICE_ROLE_KEY:{key:"SUPABASE_SERVICE_ROLE_KEY",type:"encrypted"},SUPABASE_JWT_SECRET:{key:"SUPABASE_JWT_SECRET",type:"encrypted"},NEXT_PUBLIC_SUPABASE_ANON_KEY:{key:"NEXT_PUBLIC_SUPABASE_ANON_KEY",type:"encrypted"},NEXT_PUBLIC_SUPABASE_URL:{key:"NEXT_PUBLIC_SUPABASE_URL",type:"encrypted"}}).map(e=>e.key)},41615:(e,n,t)=>{t.d(n,{A:()=>w});var a=t(80263),r=t(30075),s=t.n(r),i=t(53239),l=t(73969),o=t(19898),c=t(41529),d=t(43718),u=t(63720),m=t(76483),x=t(93637),f=t(74459),p=t(24038),h=t(84438),g=t(34969),b=t(64036),v=t(47328),j=t(60753),y=t(35212);let _=(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"white",viewBox:"0 0 512 512",className:"w-6",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M256,48,496,464H16Z"})}),w=()=>{let{ref:e}=(0,o.g)(),n=(0,g.a)(),t=(0,j.bZ)(),r=t.vercelConnectionsIntegrationId,{data:w}=(0,x.$)({orgSlug:null==n?void 0:n.slug}),N=null==w?void 0:w.filter(e=>"Vercel"===e.integration.name),S=null==N?void 0:N.find(e=>e.id===r),{data:C}=(0,h.el)({enabled:void 0!==r}),k=(0,i.useMemo)(()=>{var e;return null!=(e=null==C?void 0:C.filter(e=>e.organization_id===(null==n?void 0:n.id)).map(e=>({name:e.name,ref:e.ref})))?e:v.Oj},[null==n?void 0:n.id,C]),{data:P}=(0,p.b)({organization_integration_id:r},{enabled:void 0!==r}),I=(0,i.useMemo)(()=>null!=P?P:v.Oj,[P]),R=(0,i.useMemo)(()=>s()(I,"id"),[I]),E=(0,i.useCallback)(e=>{let n=R[e.id];return(null==n?void 0:n.framework)?(0,a.jsx)("img",{src:"".concat(b.o2,"/img/icons/frameworks/").concat(n.framework,".svg"),width:21,height:21,alt:"icon"}):m.d},[R]),{mutate:A,isLoading:L}=(0,f.T)({async onSuccess(e){let{env_sync_error:n}=e;n&&l.oR.error("Failed to sync environment variables: ".concat(n.message,". Please try re-syncing manually from settings.")),t.setVercelConnectionsOpen(!1)}}),V=(0,i.useCallback)(e=>{A({...e,connection:{...e.connection,metadata:{...e.connection.metadata,supabaseConfig:{projectEnvVars:{write:!0}}}}})},[A]);return(0,a.jsx)(y.Ay,{hideFooter:!0,size:"large",header:"Add new Vercel project connection",visible:t.vercelConnectionsOpen,onCancel:()=>t.setVercelConnectionsOpen(!1),"data-sentry-element":"SidePanel","data-sentry-component":"SidePanelVercelProjectLinker","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsxs)("div",{className:"py-6 flex flex-col gap-6 bg-studio h-full",children:[(0,a.jsx)(y.Ay.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsx)(u.o,{content:"\n### Choose repository to connect to\n\nCheck the details below before proceeding\n          ","data-sentry-element":"Markdown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"})}),(0,a.jsxs)(y.Ay.Content,{className:"flex flex-col gap-2","data-sentry-element":"unknown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:[(0,a.jsx)(d.A,{defaultSupabaseProjectRef:e,organizationIntegrationId:null==S?void 0:S.id,foreignProjects:I,supabaseProjects:k,onCreateConnections:V,installedConnections:null==S?void 0:S.connections,isLoading:L,integrationIcon:_,getForeignProjectIcon:E,choosePrompt:"Choose Vercel Project",mode:"Vercel","data-sentry-element":"ProjectLinker","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"}),(0,a.jsx)(u.o,{content:"\nThe following environment variables will be added:\n\n".concat(c.O.map(e=>"\n - `".concat(e,"`")),"\n"),"data-sentry-element":"Markdown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx"})]}),(0,a.jsx)(y.Ay.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"SidePanelVercelProjectLinker.tsx",children:(0,a.jsx)("ul",{children:(0,a.jsx)("li",{className:"border px-10"})})})]})})}},42963:(e,n,t)=>{t.d(n,{I:()=>l,U:()=>o});var a=t(40807),r=t(956),s=t(79140);async function i(e){let n=!(arguments.length>1)||void 0===arguments[1]||arguments[1],t=await (0,a.x8)(e);if(!t.ok)return{error:new r.o(t.statusText,t.status)};try{return n?await t.json():await t.text()}catch(e){return{error:new r.o(e.message,500)}}}async function l(e){var n,t;if(!e)return null;let[,,,a,r,,l,...o]=null!=(t=null==e?void 0:e.split("/"))?t:[],c=o.join("/"),d="https://api.github.com/repos/".concat(a,"/").concat(r,"/contents/").concat(c),u="".concat(d,"/supabase?ref=").concat(l),m="".concat(d,"/").concat("supabase/migrations").concat(l?"?ref=".concat(l):""),[x,f]=await Promise.all([i(u),i(m)]);if(!(0,s.IP)(x))return console.warn("Failed to fetch supabase files from GitHub: ".concat(x.error)),null;if(!(0,s.IP)(f))return console.warn("Failed to fetch migration files from GitHub: ".concat(f.error)),null;let p=null==(n=x.find(e=>"seed.sql"===e.name))?void 0:n.download_url,h=f.sort((e,n)=>e.name<n.name?-1:+(e.name>n.name)),g=h.map(e=>i(e.download_url,!1)),[b,...v]=await Promise.all([p?i(p,!1):Promise.resolve(""),...g]),j=v.filter(e=>(0,s.IP)(e)).join(";"),y=(0,s.IP)(b)?b:"",_="\n    create schema if not exists supabase_migrations;\n    create table if not exists supabase_migrations.schema_migrations (\n      version text not null primary key,\n      statements text[],\n      name text\n    );\n    ".concat(h.map((e,n)=>{let t=v[n];if(!(0,s.IP)(t))return"";let a=e.name.split("_")[0],r=JSON.stringify(t.split(";").map(e=>e.trim()).filter(Boolean));return"\n        insert into supabase_migrations.schema_migrations (version, statements, name)\n        select '".concat(a,"', array_agg(jsonb_statements)::text[], '").concat(e.name,"'\n        from jsonb_array_elements_text($statements$").concat(r,"$statements$::jsonb) as jsonb_statements;\n      ")}),"\n  ");return"".concat(j,";").concat(_,";").concat(y)}function o(e){var n,t,a,r,s,i,l,o;return"Vercel"===e.integration.name?(n=e,"https://vercel.com/dashboard/".concat((null==(t=n.metadata)?void 0:t.account.type)==="Team"?"".concat(null==(a=n.metadata)?void 0:a.account.team_slug,"/"):"","integrations/").concat(null==(r=n.metadata)?void 0:r.configuration_id)):"GitHub"===e.integration.name?(s=e,"https://github.com/".concat((null==(i=s.metadata)?void 0:i.account.type)==="Organization"?"organizations/".concat(null==(l=s.metadata)?void 0:l.account.name,"/"):"","settings/installations/").concat(null==(o=s.metadata)?void 0:o.installation_id)):""}},64540:(e,n,t)=>{t.d(n,{A:()=>d});var a=t(80263),r=t(53239),s=t(82758),i=t(51859),l=t(71126),o=t(10406);let c=(0,r.forwardRef)((e,n)=>{let{title:t,description:c,size:d="small",visible:u,onCancel:m,onConfirm:x,loading:f,cancelLabel:p="Cancel",confirmLabel:h="Submit",confirmLabelLoading:g,alert:b,children:v,variant:j="default",disabled:y,..._}=e,[w,N]=(0,r.useState)(void 0!==f&&f);return(0,r.useEffect)(()=>{u&&void 0===f&&N(!1)},[u]),(0,r.useEffect)(()=>{void 0!==f&&N(f)},[f]),(0,a.jsx)(s.lG,{open:u,..._,onOpenChange:()=>{u&&m()},children:(0,a.jsxs)(s.Cf,{ref:n,className:"p-0 gap-0 pb-5 !block",size:d,children:[(0,a.jsxs)(s.c7,{className:(0,i.cn)("border-b"),padding:"small",children:[(0,a.jsx)(s.L3,{children:t}),c&&(0,a.jsx)(s.rr,{children:c})]}),b&&(0,a.jsx)(o.Z,{type:j,label:b.title,description:b.description,className:"border-r-0 border-l-0 rounded-none -mt-px [&_svg]:ml-0.5 mb-0",...null==b?void 0:b.base}),v&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(s.OO,{padding:"small",children:v}),(0,a.jsx)(s.pf,{})]}),(0,a.jsxs)("div",{className:"flex gap-2 px-5 pt-5",children:[(0,a.jsx)(l.$,{size:"medium",block:!0,type:"default",disabled:w,onClick:()=>m(),children:p}),(0,a.jsx)(l.$,{block:!0,size:"medium",type:"destructive"===j?"danger":"warning"===j?"warning":"primary",htmlType:"submit",loading:w,disabled:w||y,onClick:e=>{e.preventDefault(),e.stopPropagation(),x(),void 0===f&&N(!0)},className:"truncate",children:h})]})]})})});c.displayName="ConfirmationModal";let d=c},74459:(e,n,t)=>{t.d(n,{T:()=>d});var a=t(32144),r=t(80251),s=t(73969),i=t(40807),l=t(86197),o=t(20081);async function c(e){let{organizationIntegrationId:n,connection:t}=e,{data:a,error:r}=await (0,i.bE)("/platform/integrations/vercel/connections",{body:{organization_integration_id:n,connection:{foreign_project_id:t.foreign_project_id,supabase_project_ref:t.supabase_project_ref,metadata:t.metadata}}});return r&&(0,i.H4)(r),a}let d=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)(),d=(0,l.yr)();return(0,r.n)(e=>c(e),{async onSuccess(n,t,a){await Promise.all([i.invalidateQueries(o.Z.integrationsList()),i.invalidateQueries(o.Z.integrationsListWithOrg(t.orgSlug)),i.invalidateQueries(o.Z.vercelProjectList(t.organizationIntegrationId)),i.invalidateQueries(o.Z.vercelConnectionsList(t.organizationIntegrationId))]),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){d.setLoading(!1),void 0===n?s.oR.error("Failed to create connection: ".concat(e.message)):n(e,t,a)},...t})}},75493:(e,n,t)=>{t.d(n,{S:()=>N});var a=t(80263),r=t(62659),s=t(8945),i=t(653),l=t(28097),o=t(59153),c=t.n(o),d=t(47504),u=t(53239),m=t(73969),x=t(27683),f=t(41370),p=t(80251),h=t(40807);async function g(e){let{connectionId:n}=e,{data:t,error:a}=await (0,h.bE)("/platform/integrations/vercel/connections/{connection_id}/sync-envs",{params:{path:{connection_id:n}}});return a&&(0,h.H4)(a),t}let b=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,p.n)(e=>g(e),{async onSuccess(n,t,a){await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?m.oR.error("Failed to sync environment variables: ".concat(e.message)):n(e,t,a)},...t})};var v=t(84438),j=t(74115),y=t(71126),_=t(64540),w=t(34969);let N=(0,u.forwardRef)((e,n)=>{let{disabled:t,onDeleteConnection:o,...p}=e,h=(0,d.useRouter)(),g=(0,w.a)(),{type:N,connection:S}=p,{data:C}=(0,v.el)(),k=null==C?void 0:C.find(e=>e.ref===S.supabase_project_ref),P=(null==k?void 0:k.is_branch_enabled)===!0,[I,R]=(0,u.useState)(!1),[E,A]=(0,u.useState)(!1),[L,V]=(0,u.useState)(!1),T=(0,u.useCallback)(async()=>{try{A(!0),await o(S)}catch(e){}finally{A(!1),R(!1)}},[S,o]),z=(0,u.useCallback)(()=>{R(!1)},[]),{mutate:O,isLoading:G}=b({onSuccess:()=>{m.oR.success("Successfully synced environment variables"),V(!1)}}),F=(0,u.useCallback)(async()=>{O({connectionId:S.id})},[S,O]),B="/project/[ref]/settings/integrations";return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(x.LT,{showNode:!1,actions:t?(0,a.jsx)(f.G,{disabled:!0,iconRight:(0,a.jsx)(r.A,{size:14}),type:"default",tooltip:{content:{side:"bottom",text:"You need additional permissions to manage this connection"}},children:"Manage"}):(0,a.jsxs)(j.rI,{open:L,onOpenChange:()=>V(!L),modal:!1,children:[(0,a.jsx)(j.ty,{asChild:!0,children:(0,a.jsx)(y.$,{iconRight:(0,a.jsx)(r.A,{size:14}),type:"default",children:(0,a.jsx)("span",{children:"Manage"})})}),(0,a.jsxs)(j.SQ,{side:"bottom",align:"end",children:[h.pathname!==B&&(0,a.jsx)(j._2,{asChild:!0,children:(0,a.jsx)(c(),{href:B.replace("[ref]",S.supabase_project_ref),children:"Configure connection"})}),"Vercel"===N&&(null==g?void 0:g.managed_by)!=="vercel-marketplace"&&(0,a.jsxs)(j._2,{className:"space-x-2",onSelect:e=>{e.preventDefault(),F()},disabled:G,children:[G?(0,a.jsx)(s.A,{className:"animate-spin",size:14}):(0,a.jsx)(i.A,{size:14}),(0,a.jsx)("p",{children:"Resync environment variables"})]}),("Vercel"===N&&(null==g?void 0:g.managed_by)!=="vercel-marketplace"||h.pathname!==B)&&(0,a.jsx)(j.mB,{}),(0,a.jsxs)(j._2,{className:"space-x-2",onSelect:()=>R(!0),children:[(0,a.jsx)(l.A,{size:14}),(0,a.jsx)("p",{children:"Delete connection"})]})]})]}),...p}),(0,a.jsx)(_.A,{variant:"destructive",size:"GitHub"===N&&P?"medium":"small",visible:I,title:"Confirm to delete ".concat(N," connection"),confirmLabel:"Delete connection",onCancel:z,onConfirm:T,loading:E,children:(0,a.jsx)("p",{className:"text-sm text-foreground-light",children:"Deleting this GitHub connection will stop automatic creation and merging of preview branches. Existing preview branches will remain unchanged."})})]})});N.displayName="IntegrationConnectionItem"},76483:(e,n,t)=>{t.d(n,{d:()=>s});var a=t(80263),r=t(34048);let s=(0,a.jsx)("div",{className:"flex items-center justify-center rounded bg-black p-1",children:(0,a.jsx)("svg",{className:"m-auto fill-current text-white",width:"12px",height:"12px",viewBox:"0 0 1155 1000",children:(0,a.jsx)("path",{d:"M577.344 0L1154.69 1000H0L577.344 0Z"})})});r.A},84478:(e,n,t)=>{t.d(n,{O:()=>c});var a=t(32144),r=t(80251),s=t(73969),i=t(40807),l=t(77424);async function o(e){let{id:n,branchName:t,gitBranch:a,persistent:r}=e,{data:s,error:l}=await (0,i.F6)("/v1/branches/{branch_id}",{params:{path:{branch_id:n}},body:{branch_name:t,git_branch:a,persistent:r}});return l&&(0,i.H4)(l),s}let c=function(){let{onSuccess:e,onError:n,...t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,a.jE)();return(0,r.n)(e=>o(e),{async onSuccess(n,t,a){let{projectRef:r}=t;await i.invalidateQueries(l.N.list(r)),await (null==e?void 0:e(n,t,a))},async onError(e,t,a){void 0===n?s.oR.error("Failed to update branch: ".concat(e.message)):n(e,t,a)},...t})}},86197:(e,n,t)=>{t.d(n,{yr:()=>i});var a=t(56028),r=t(12532);let s=(0,a.BX)({loading:!1,setLoading:e=>{s.loading=e}}),i=e=>(0,r.s)(s,e)},91378:(e,n,t)=>{t.d(n,{d:()=>d});var a=t(80263),r=t(44893),s=t(79279),i=t(53239),l=t(51859);let o=(0,s.F)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),c=(0,s.F)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),d=i.forwardRef((e,n)=>{let{className:t,size:s,...i}=e;return(0,a.jsx)(r.bL,{className:(0,l.cn)(o({size:s}),t),...i,ref:n,children:(0,a.jsx)(r.zi,{className:(0,l.cn)(c({size:s}))})})});d.displayName=r.bL.displayName},93637:(e,n,t)=>{t.d(n,{$:()=>l});var a=t(56947),r=t(40807),s=t(20081);async function i(e,n){let{orgSlug:t}=e;if(!t)throw Error("orgSlug is required");let{data:a,error:s}=await (0,r.Jt)("/platform/integrations/{slug}",{params:{path:{slug:t}}});return s&&(0,r.H4)(s),a}let l=function(e){let{orgSlug:n}=e,{enabled:t=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(s.Z.integrationsListWithOrg(n),e=>{let{signal:t}=e;return i({orgSlug:n},t)},{enabled:t&&void 0!==n,staleTime:18e5,...r})}},95268:(e,n,t)=>{t.d(n,{I:()=>s});var a=t(80263),r=t(71126);let s=e=>{let{form:n,hasChanges:t,handleReset:s,helper:i,disabled:l=!1,isSubmitting:o,submitText:c="Save"}=e,d=o||l||!t&&void 0!==t;return(0,a.jsxs)("div",{className:["flex w-full items-center gap-2",i?"justify-between":"justify-end"].join(" "),"data-sentry-component":"FormActions","data-sentry-source-file":"FormActions.tsx",children:[i&&(0,a.jsx)("span",{className:"text-sm text-foreground-lighter",children:i}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(r.$,{disabled:d,type:"default",htmlType:"reset",onClick:()=>s(),"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:"Cancel"}),(0,a.jsx)(r.$,{form:n,type:"primary",htmlType:"submit",disabled:d,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:c})]})]})}}}]);