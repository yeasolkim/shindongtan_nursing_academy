!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=(new e.Error).stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="ea9c7315-050f-4048-96a0-cd68fa6e73a6",e._sentryDebugIdIdentifier="sentry-dbid-ea9c7315-050f-4048-96a0-cd68fa6e73a6")}catch(e){}}(),(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6544],{805:(e,t,s)=>{"use strict";s.d(t,{A:()=>h});var n=s(80263),a=s(60045),r=s(59153),l=s.n(r),i=s(77227),o=s(34969),c=s(68875),d=s(74725),u=s(51859),m=s(71126),x=s(41370);let h=e=>{var t,s,r;let{icon:h,primaryText:p,secondaryText:f,addon:y,buttonText:j,source:g="upgrade",disabled:v=!1}=e,b=(0,c.KT)(),N=(0,o.a)(),w=null==N||null==(t=N.plan)?void 0:t.id,S=(0,i.SE)(a.aG.BILLING_WRITE,"stripe.subscriptions"),A=(0,d._)("disableProjectCreationAndUpdate");return(0,n.jsx)("div",{className:(0,u.cn)("block w-full rounded border border-opacity-20 py-4 px-6","border-overlay bg-surface-200"),"data-sentry-component":"UpgradeToPro","data-sentry-source-file":"UpgradeToPro.tsx",children:(0,n.jsxs)("div",{className:"flex gap-x-3",children:[h&&(0,n.jsx)("div",{className:"mt-1",children:h}),(0,n.jsxs)("div",{className:"flex flex-col md:flex-row w-full md:items-center justify-between gap-4 md:gap-x-8 xl:gap-x-32",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"text-sm",children:p}),(0,n.jsx)("div",{children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:f})})]}),!S||A?(0,n.jsx)(x.G,{disabled:!0,type:"primary",tooltip:{content:{side:"bottom",text:A?"Subscription changes are currently disabled, our engineers are working on a fix":S?void 0:"You need additional permissions to amend subscriptions"}},children:"Reset database password"}):(0,n.jsx)(m.$,{asChild:!0,type:"primary",disabled:!S||A||v,children:(0,n.jsx)(l(),{href:"free"===w?"/org/".concat(null!=(s=null==N?void 0:N.slug)?s:"_","/billing?panel=subscriptionPlan&source=").concat(g):"/project/".concat(null!=(r=null==b?void 0:b.ref)?r:"_","/settings/addons?panel=").concat(y,"&source=").concat(g),children:j||("free"===w?"Upgrade to Pro":"Enable add on")})})]})]})})}},4487:(e,t,s)=>{"use strict";s.d(t,{A:()=>j});var n=s(80263),a=s(60045),r=s(27452),l=s(44679),i=s(66345),o=s(53239),c=s(97872),d=s(788),u=s(77227),m=s(71126),x=s(25171),h=s(70324),p=s(95793),f=s(36141),y=s(67585);let j=e=>{let{className:t,disabled:s=!1,size:j="tiny",showError:g=!0,selectedSchemaName:v,supportSelectAll:b=!1,excludedSchemas:N=[],onSelectSchema:w,onSelectCreateSchema:S,portal:A=!0}=e,[C,_]=(0,o.useState)(!1),k=(0,u.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"schemas"),{project:E}=(0,c.Om)(),{data:R,isLoading:T,isSuccess:L,isError:z,error:I,refetch:F}=(0,d.w$)({projectRef:null==E?void 0:E.ref,connectionString:null==E?void 0:E.connectionString}),D=(R||[]).filter(e=>!N.includes(e.name)).sort((e,t)=>e.name.localeCompare(t.name));return(0,n.jsxs)("div",{className:t,"data-sentry-component":"SchemaSelector","data-sentry-source-file":"SchemaSelector.tsx",children:[T&&(0,n.jsx)(m.$,{type:"default",className:"w-full [&>span]:w-full",size:j,disabled:!0,children:(0,n.jsx)(x.E,{className:"w-full h-3 bg-foreground-muted"})},"schema-selector-skeleton"),g&&z&&(0,n.jsxs)(h.Fc,{variant:"warning",className:"!px-3 !py-3",children:[(0,n.jsx)(h.XL,{className:"text-xs text-amber-900",children:"Failed to load schemas"}),(0,n.jsxs)(h.TN,{className:"text-xs mb-2 break-words",children:["Error: ",null==I?void 0:I.message]}),(0,n.jsx)(m.$,{type:"default",size:"tiny",onClick:()=>F(),children:"Reload schemas"})]}),L&&(0,n.jsxs)(p.AM,{open:C,onOpenChange:_,modal:!1,children:[(0,n.jsx)(p.Wv,{asChild:!0,children:(0,n.jsx)(m.$,{size:j,disabled:s,type:"default","data-testid":"schema-selector",className:"w-full [&>span]:w-full !pr-1 space-x-1",iconRight:(0,n.jsx)(r.A,{className:"text-foreground-muted",strokeWidth:2,size:14}),children:v?(0,n.jsxs)("div",{className:"w-full flex gap-1",children:[(0,n.jsx)("p",{className:"text-foreground-lighter",children:"schema"}),(0,n.jsx)("p",{className:"text-foreground",children:"*"===v?"All schemas":v})]}):(0,n.jsx)("div",{className:"w-full flex gap-1",children:(0,n.jsx)("p",{className:"text-foreground-lighter",children:"Choose a schemaâ€¦"})})})}),(0,n.jsx)(p.hl,{className:"p-0 min-w-[200px] pointer-events-auto",side:"bottom",align:"start",portal:A,sameWidthAsTrigger:!0,children:(0,n.jsxs)(f.uB,{children:[(0,n.jsx)(f.G7,{placeholder:"Find schema..."}),(0,n.jsxs)(f.oI,{children:[(0,n.jsx)(f.xL,{children:"No schemas found"}),(0,n.jsx)(f.L$,{children:(0,n.jsxs)(y.FK,{className:(D||[]).length>7?"h-[210px]":"",children:[b&&(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w("*"),_(!1)},onClick:()=>{w("*"),_(!1)},children:[(0,n.jsx)("span",{children:"All schemas"}),"*"===v&&(0,n.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},"select-all"),null==D?void 0:D.map(e=>(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center justify-between space-x-2 w-full",onSelect:()=>{w(e.name),_(!1)},onClick:()=>{w(e.name),_(!1)},children:[(0,n.jsx)("span",{children:e.name}),v===e.name&&(0,n.jsx)(l.A,{className:"text-brand",strokeWidth:2,size:16})]},e.id))]})}),void 0!==S&&k&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.fx,{}),(0,n.jsx)(f.L$,{children:(0,n.jsxs)(f.h_,{className:"cursor-pointer flex items-center gap-x-2 w-full",onSelect:()=>{S(),_(!1)},onClick:()=>{S(),_(!1)},children:[(0,n.jsx)(i.A,{size:12}),"Create a new schema"]})})]})]})]})})]})]})}},7971:(e,t,s)=>{"use strict";s.d(t,{A:()=>A});var n=s(80263),a=s(66345),r=s(34048),l=s(77877),i=s(53239),o=s(73969),c=s(97872),d=s(23992),u=s(96457),m=s(11273),x=s(788),h=s(96557),p=s(68875),f=s(67920),y=s(66586),j=s(16988),g=s(26104),v=s(70324),b=s(83086),N=s(71126),w=s(10406);let S=["vector","postgis"],A=e=>{let{visible:t,extension:s,onCancel:A}=e,{project:C}=(0,c.Om)(),_=(0,p.W0)(),[k,E]=(0,i.useState)(),[R,T]=(0,i.useState)(!1),{data:L,isLoading:z}=(0,x.w$)({projectRef:null==C?void 0:C.ref,connectionString:null==C?void 0:C.connectionString},{enabled:t}),{mutate:I,isLoading:F}=(0,m.E)({onSuccess:()=>{o.oR.success('Extension "'.concat(s.name,'" is now enabled')),A()},onError:e=>{o.oR.error("Failed to enable ".concat(s.name,": ").concat(e.message))}});(0,i.useEffect)(()=>{let e=!1;return t&&(async()=>{e||(T(!0),E(void 0));try{let t=await (0,h.E)({projectRef:null==C?void 0:C.ref,connectionString:null==C?void 0:C.connectionString,sql:"select * from pg_available_extension_versions where name = '".concat(s.name,"'")});e||E(t.result[0].schema)}catch(e){}T(!1)})(),()=>{e=!0}},[t,s.name]);let D=async e=>{if(void 0===C)return console.error("Project is required");let t=null!=k?k:"custom"===e.schema?e.name:e.schema;I({projectRef:C.ref,connectionString:null==C?void 0:C.connectionString,schema:t,name:s.name,version:s.default_version,cascade:!0,createSchema:!t.startsWith("pg_")})};return(0,n.jsx)(f.A,{hideFooter:!0,visible:t,onCancel:A,size:"small",header:(0,n.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,n.jsx)("h5",{className:"text-sm text-foreground",children:"Confirm to enable"}),(0,n.jsx)("code",{className:"text-xs",children:s.name})]}),"data-sentry-element":"Modal","data-sentry-component":"EnableExtensionModal","data-sentry-source-file":"EnableExtensionModal.tsx",children:(0,n.jsx)(y.A,{initialValues:{name:s.name,schema:"extensions"},validate:e=>{let t={};return"custom"!==e.schema||e.name||(t.name="Required field"),t},onSubmit:D,"data-sentry-element":"Form","data-sentry-source-file":"EnableExtensionModal.tsx",children:e=>{let{values:t}=e;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(f.A.Content,{className:"flex flex-col gap-y-2",children:[_&&S.includes(s.name)&&(0,n.jsxs)(w.Z,{type:"default",title:"Extension is limited by OrioleDB",children:[(0,n.jsxs)("span",{className:"block",children:[s.name," cannot be accelerated by indexes on tables that are using the OrioleDB access method"]}),(0,n.jsx)(d.A,{abbrev:!1,className:"mt-2",href:"https://supabase.com/docs"})]}),R||z?(0,n.jsxs)("div",{className:"space-y-2",children:[(0,n.jsx)(u.A,{}),(0,n.jsx)("div",{className:"w-3/4",children:(0,n.jsx)(u.A,{})})]}):k?(0,n.jsx)(j.A,{disabled:!0,id:"schema",name:"schema",value:k,label:"Select a schema to enable the extension for",descriptionText:"Extension must be installed in ".concat(k,".")}):(0,n.jsxs)(g.A,{size:"small",name:"schema",label:"Select a schema to enable the extension for",children:[(0,n.jsxs)(g.A.Option,{id:"custom",label:'Create a new schema "'.concat(s.name,'"'),value:"custom",addOnBefore:()=>(0,n.jsx)(a.A,{size:16,strokeWidth:1.5}),children:['Create a new schema "',s.name,'"']},"custom"),(0,n.jsx)(f.A.Separator,{}),null==L?void 0:L.map(e=>(0,n.jsx)(g.A.Option,{id:e.name,label:e.name,value:e.name,addOnBefore:()=>(0,n.jsx)(r.A,{size:16,strokeWidth:1.5}),children:e.name},e.id))]})]}),"custom"===t.schema&&(0,n.jsx)(f.A.Content,{children:(0,n.jsx)(j.A,{id:"name",name:"name",label:"Schema name"})}),"pg_cron"===s.name&&(null==C?void 0:C.cloud_provider)==="FLY"&&(0,n.jsx)(f.A.Content,{children:(0,n.jsxs)(v.Fc,{variant:"warning",children:[(0,n.jsx)(b.id,{}),(0,n.jsx)(v.XL,{children:"The pg_cron extension is not fully supported for Fly projects"}),(0,n.jsx)(v.TN,{children:"You can still enable the extension, but pg_cron jobs may not run due to the behavior of Fly projects."}),(0,n.jsx)(v.TN,{className:"mt-3",children:(0,n.jsx)(N.$,{asChild:!0,type:"default",iconRight:(0,n.jsx)(l.A,{width:12,height:12}),children:(0,n.jsx)("a",{href:"/docs/guides/platform/fly-postgres#limitations",target:"_blank",rel:"noopener noreferrer",children:(0,n.jsx)("span",{children:"Learn more"})})})})]})}),(0,n.jsx)(f.A.Separator,{}),(0,n.jsxs)(f.A.Content,{className:"flex items-center justify-end space-x-2",children:[(0,n.jsx)(N.$,{type:"default",disabled:F,onClick:()=>A(),children:"Cancel"}),(0,n.jsx)(N.$,{htmlType:"submit",disabled:F,loading:F,children:"Enable extension"})]})]})}})})}},9611:(e,t,s)=>{"use strict";s.d(t,{b:()=>n});let n={list:e=>["projects",e,"database-publications"]}},11273:(e,t,s)=>{"use strict";s.d(t,{E:()=>u});var n=s(45874),a=s(48596),r=s(32144),l=s(80251),i=s(73969),o=s(96557),c=s(73516);async function d(e){let{projectRef:t,connectionString:s,schema:r,name:l,version:i,cascade:c=!1,createSchema:d=!1}=e,u=new Headers;s&&u.set("x-connection-encrypted",s);let{sql:m}=n.A.extensions.create({schema:r,name:l,version:i,cascade:c}),{result:x}=await (0,o.E)({projectRef:t,connectionString:s,sql:d?"create schema if not exists ".concat((0,a.bD)(r),"; ").concat(m):m,queryKey:["extension","create"]});return x}let u=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,r.jE)();return(0,l.n)(e=>d(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(c.I.list(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?i.oR.error("Failed to enable database extension: ".concat(e.message)):t(e,s,n)},...s})}},12204:(e,t,s)=>{"use strict";s.d(t,{CM:()=>n,hk:()=>a,lR:()=>r});let n=["adminpack","amcheck","file_fdw","lo","old_snapshot","pageinspect","pg_buffercache","pg_freespacemap","pg_surgery","pg_visibility","supabase_vault","supautils","intagg","xml2","pg_tle"],a={vector:["pgvector","pg_vector"]},r={pg_cron:"Disabling this extension will delete all scheduled jobs. This cannot be undone."}},12484:(e,t,s)=>{"use strict";s.d(t,{A:()=>c});var n=s(80263),a=s(59153),r=s.n(a),l=s(38220),i=s(65863),o=s(71126);let c=e=>{let{name:t="",isActive:s,isExternal:a,icon:c,rightIcon:d,url:u="",target:m="_self",onClick:x,textClassName:h="",hoverText:p="",label:f}=e,y=(0,n.jsx)(l.Ay.Item,{icon:c,rounded:!0,active:s,onClick:x,children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between gap-1",children:[(0,n.jsxs)("div",{title:p||("string"==typeof t?t:""),className:"flex items-center gap-2 truncate w-full "+h,children:[(0,n.jsxs)("span",{className:"truncate",children:[t," "]}),void 0!==f&&(0,n.jsx)(i.E,{variant:"warning",className:"py-0 px-1.5 capitalize",children:f})]}),d&&(0,n.jsx)("div",{children:d})]})});return u?a?(0,n.jsx)(o.$,{asChild:!0,block:!0,className:"!justify-start",type:"text",size:"small",icon:c,children:(0,n.jsx)(r(),{href:u,target:"_blank",rel:"noreferrer",children:t})}):(0,n.jsx)(r(),{href:u,className:"block",target:m,children:y}):y}},12804:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var n=s(80263),a=s(16110),r=s(64036);let l=()=>(0,n.jsxs)("div",{className:"flex h-64 flex-col items-center justify-center","data-sentry-component":"NoSearchResults","data-sentry-source-file":"NoSearchResults.tsx",children:[(0,n.jsx)(a.A,{src:"".concat(r.o2,"/img/no-search-results.svg"),preProcessor:e=>e.replace(/svg/,'svg className="mb-2 w-16 h-16 text-color-inherit"'),"data-sentry-element":"SVG","data-sentry-source-file":"NoSearchResults.tsx"}),(0,n.jsx)("p",{className:"w-64 text-center text-sm opacity-50",children:"Hmm, we couldn't find any results that match your query."})]})},16939:(e,t,s)=>{"use strict";s.d(t,{A:()=>n});let n=(0,s(23983).A)("Columns2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M12 3v18",key:"108xh3"}]])},18398:(e,t,s)=>{"use strict";s.d(t,{Fg:()=>n,QY:()=>a,mV:()=>r});let n=["anon","service_role","authenticated","authenticator","dashboard_user","supabase_admin","supabase_auth_admin","supabase_functions_admin","supabase_read_only_user","supabase_realtime_admin","supabase_replication_admin","supabase_storage_admin","pgbouncer","pgsodium_keyholder","pgsodium_keyiduser","pgsodium_keymaker","pgtle_admin"],a=["postgres","pgbouncer","supabase_admin","supabase_auth_admin","supabase_storage_admin","dashboard_user","authenticator","pg_database_owner","pg_read_all_data","pg_write_all_data"],r={canLogin:{disabled:!1,description:"User can login",grant_by_dashboard:!0},canCreateRole:{disabled:!1,description:"User can create roles",grant_by_dashboard:!0},canCreateDb:{disabled:!1,description:"User can create databases",grant_by_dashboard:!0},canBypassRls:{disabled:!1,description:"User bypasses every row level security policy",grant_by_dashboard:!0},isSuperuser:{disabled:!0,description:"User is a Superuser",grant_by_dashboard:!1},isReplicationRole:{disabled:!1,description:"User can initiate streaming replication and put the system in and out of backup mode",grant_by_dashboard:!0}}},23148:(e,t,s)=>{"use strict";function n(e){return"\n    begin;\n\n    ".concat(e,"\n    \n    commit;\n  ")}s.d(t,{d:()=>n})},24198:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var n=s(80263),a=s(51859),r=s(71126);let l=e=>{let{searchString:t,onResetFilter:s,className:l}=e;return(0,n.jsxs)("div",{className:(0,a.cn)("bg-surface-100 border border-default px-6 py-4 rounded flex items-center justify-between",l),"data-sentry-component":"NoSearchResults","data-sentry-source-file":"NoSearchResults.tsx",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',t,'" did not return any results']})]}),void 0!==s&&(0,n.jsx)(r.$,{type:"default",onClick:()=>s(),children:"Reset filter"})]})}},24652:(e,t,s)=>{"use strict";s.d(t,{H:()=>d});var n=s(45874),a=s(32144),r=s(80251),l=s(73969),i=s(96557),o=s(9611);async function c(e){let{projectRef:t,connectionString:s,id:a,tables:r,publish_insert:l,publish_update:o,publish_delete:c,publish_truncate:d}=e,{sql:u}=n.A.publications.update(a,{tables:r,publish_insert:l,publish_update:o,publish_delete:c,publish_truncate:d}),{result:m}=await (0,i.E)({projectRef:t,connectionString:s,sql:u,queryKey:["publication","update",a]});return m}let d=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,a.jE)();return(0,r.n)(e=>c(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(o.b.list(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?l.oR.error("Failed to update database publication: ".concat(e.message)):t(e,s,n)},...s})}},25321:(e,t,s)=>{"use strict";s.d(t,{k:()=>i});var n=s(12056),a=s(53239),r=s(19898);let l=e=>(0,n.ZA)("schema",n.tU.withDefault(e)),i=()=>{let{ref:e}=(0,r.g)(),t=e&&e.length>0&&window.localStorage.getItem(r.rS.LAST_SELECTED_SCHEMA(e))||"public",[s,n]=l((0,a.useMemo)(()=>t,[e]));return(0,a.useEffect)(()=>{e&&e.length>0&&window.localStorage.setItem(r.rS.LAST_SELECTED_SCHEMA(e),s)},[s,e]),{selectedSchema:s,setSelectedSchema:n}}},25549:(e,t,s)=>{"use strict";s.d(t,{A:()=>h});var n=s(80263),a=s(47504),r=s(90915),l=s(39071),i=s(89771),o=s(45174),c=s(68875),d=s(80207),u=s(30651),m=s(26551);let x=()=>{let e=(0,c.KT)(),t=(0,a.useRouter)().pathname.split("/")[4],{data:s}=(0,i.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),{data:d}=(0,o.Q)({projectRef:null==e?void 0:e.ref}),u=void 0!==(null!=s?s:[]).find(e=>"pg_net"===e.name),x=(null==d?void 0:d.selected_addons.find(e=>"pitr"===e.type))!==void 0,h=(0,r.p4)();return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(l.l,{page:t,menu:(0,m.k)(e,{pgNetExtensionExists:u,pitrEnabled:x,columnLevelPrivileges:h}),"data-sentry-element":"ProductMenu","data-sentry-source-file":"DatabaseLayout.tsx"})})},h=(0,d.r)(e=>{let{children:t}=e;return(0,n.jsx)(u.A,{product:"Database",productMenu:(0,n.jsx)(x,{}),isBlocking:!1,"data-sentry-element":"ProjectLayout","data-sentry-component":"DatabaseLayout","data-sentry-source-file":"DatabaseLayout.tsx",children:t})})},26104:(e,t,s)=>{"use strict";s.d(t,{A:()=>y});var n=s(80263),a=s(10726),r=s(11203),l=s.n(r),i=s(53239),o=s(19480),c=s(29660),d=s(42889),u=s(16865),m=s(51859),x=s(3891);let h=(0,i.createContext)({onChange:e=>{},selected:void 0});var p=s(44679);function f(e){let{children:t,className:s,buttonClassName:r,descriptionText:p,error:f,icon:y,id:j="",name:g="",label:v,labelOptional:b,layout:N,value:w,onChange:S,onFocus:A,onBlur:C,style:_,size:k="medium",defaultValue:E,validation:R,disabled:T,optionsWidth:L}=e,[z,I]=(0,i.useState)(void 0),[F,D]=(0,i.useState)({}),P=(0,u.A)("listbox"),B=(0,i.useRef)(null),{formContextOnChange:M,values:O,errors:V,handleBlur:q,touched:$,fieldLevelValidation:Y}=(0,x.x)();O&&!w&&(w=O[j||g],E=O[j||g]),f||(V&&!f&&(f=V[j||g]),f=$&&$[j||g]?f:void 0),(0,i.useEffect)(()=>{void 0!==w&&I(w)},[w]),(0,i.useEffect)(()=>{function e(){var e;document.documentElement.style.setProperty("--width-listbox","".concat(L||(null==(e=B.current)?void 0:e.offsetWidth),"px"))}return window.addEventListener("resize",e),e(),()=>window.removeEventListener("resize",e)},[]),(0,i.useEffect)(()=>{var e;let s=l()(t);function n(e){return s.find(t=>t.props.value===e)}if(w){I(w);let e=n(w);D((null==e?void 0:e.props)?e.props:void 0);return}if(z){let e=n(z);D((null==e?void 0:e.props)?e.props:void 0);return}if(E){I(E);let e=n(z);D((null==e?void 0:e.props)?e.props:void 0);return}D(null==(e=s[0])?void 0:e.props)},[z]);let W=[P.container,P.base,r],H=[P.addOnBefore];return f&&W.push(P.variants.error),f||W.push(P.variants.standard),y&&H.push(P.with_icon),k&&W.push(P.size[k]),T&&W.push(P.disabled),(0,n.jsx)(o.H,{label:v,labelOptional:b,layout:N,id:j,error:f,descriptionText:p,className:s,style:_,size:k,"data-sentry-element":"FormLayout","data-sentry-component":"Listbox","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsxs)(a.bL,{"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:[(0,n.jsx)(a.l9,{asChild:!0,disabled:T,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsxs)("button",{"data-size":k,ref:B,className:(0,m.cn)(W),onBlur:function(e){q&&q(e),C&&C(e)},onFocus:A,name:g,id:j,children:[(0,n.jsxs)("span",{className:(0,m.cn)(H),children:[y&&(0,n.jsx)(d.A,{size:k,icon:y}),(null==F?void 0:F.addOnBefore)&&(0,n.jsx)(F.addOnBefore,{}),(0,n.jsx)("span",{className:P.label,children:null==F?void 0:F.label})]}),(0,n.jsx)("span",{className:P.chevron_container,children:(0,n.jsx)("svg",{className:P.chevron,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-sentry-element":"svg","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd","data-sentry-element":"path","data-sentry-source-file":"Listbox2.tsx"})})}),f&&(0,n.jsx)("div",{className:P.actions_container,children:f&&(0,n.jsx)(c.A,{size:k})})]})}),(0,n.jsx)(a.UC,{sideOffset:6,loop:!0,side:"bottom",align:"center",className:P.options_container,"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:(0,n.jsx)("div",{children:(0,n.jsx)(h.Provider,{value:{onChange:function(e){S&&S(e),I(e);let t={};t.target={type:"select",name:g,id:j,value:e,checked:void 0},M&&M(t),R&&Y(j,R(e))},selected:z},"data-sentry-element":"unknown","data-sentry-source-file":"Listbox2.tsx",children:t})})})]})})}f.Option=function(e){let{id:t,value:s,label:r,disabled:l=!1,children:i,className:o="",addOnBefore:c}=e,d=(0,u.A)("listbox");return(0,n.jsx)(h.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"SelectOption","data-sentry-source-file":"Listbox2.tsx",children:e=>{let{onChange:r,selected:u}=e,x=u===s;return(0,n.jsxs)(a.q7,{className:(0,m.cn)(d.option,x?d.option_active:" ",l?d.option_disabled:" ",o),onSelect:()=>l?{}:r(s),children:[(0,n.jsxs)("div",{className:d.option_inner,children:[c&&c({active:x,selected:u}),(0,n.jsx)("span",{children:"function"==typeof i?i({active:x,selected:u}):i})]}),x?(0,n.jsx)("span",{className:(0,m.cn)(d.option_check,x?d.option_check_active:""),children:(0,n.jsx)(p.A,{className:d.option_check_icon,"aria-hidden":"true"})}):null]},t)}})};let y=f},26366:(e,t,s)=>{"use strict";s.d(t,{Dt:()=>o});var n=s(56947),a=s(96557),r=s(95059);let l=()=>"show max_connections";async function i(e,t){let{projectRef:s,connectionString:n}=e,r=l(),{result:i}=await (0,a.E)({projectRef:s,connectionString:n,sql:r,queryKey:["max-connections"]},t);return{maxConnections:parseInt(i[0].max_connections)}}let o=function(e){let{projectRef:t,connectionString:s}=e,{enabled:a=!0,...l}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.c.maxConnections(t),e=>{let{signal:n}=e;return i({projectRef:t,connectionString:s},n)},{enabled:a&&void 0!==t,...l})}},30075:(e,t,s)=>{var n=s(50117);e.exports=s(94277)(function(e,t,s){n(e,s,t)})},30472:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>i});var n=s(80263),a=s(90709);s(53239);var r=s(16865);let l=e=>{let{open:t,children:s,className:r,...l}=e;return(0,n.jsx)(a.bL,{asChild:l.asChild,defaultOpen:l.defaultOpen,open:t,onOpenChange:l.onOpenChange,disabled:l.disabled,className:r,"data-sentry-element":"unknown","data-sentry-component":"Collapsible","data-sentry-source-file":"Collapsible.tsx",children:s})};l.Trigger=function(e){let{children:t,asChild:s}=e;return(0,n.jsx)(a.l9,{asChild:s,"data-sentry-element":"unknown","data-sentry-component":"Trigger","data-sentry-source-file":"Collapsible.tsx",children:t})},l.Content=function(e){let{asChild:t,children:s,className:l}=e,i=(0,r.A)("collapsible");return(0,n.jsx)(a.UC,{asChild:t,className:[i.content,l].join(" "),"data-sentry-element":"unknown","data-sentry-component":"Content","data-sentry-source-file":"Collapsible.tsx",children:s})};let i=l},33050:(e,t,s)=>{"use strict";s.d(t,{x:()=>n});let n={list:e=>["projects",e,"foreignTables"],listBySchema:(e,t)=>[...n.list(e),t]}},36475:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var n=s(80263),a=s(3073);let r=()=>(0,n.jsx)("div",{className:"block w-full rounded border border-muted border-opacity-50 bg-gray-300 p-3","data-sentry-component":"BackupsEmpty","data-sentry-source-file":"BackupsEmpty.tsx",children:(0,n.jsxs)("div",{className:"flex space-x-3",children:[(0,n.jsx)(a.A,{size:20,strokeWidth:1.5,"data-sentry-element":"Info","data-sentry-source-file":"BackupsEmpty.tsx"}),(0,n.jsx)("p",{className:"text-sm",children:"No backups created yet - check again tomorrow."})]})})},38220:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>m});var n=s(80263),a=s(53239),r=s(16865),l=s(51859);function i(e){let{children:t,className:s,tag:a="div",style:r}=e;return(0,n.jsx)("".concat(a),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Typography","data-sentry-source-file":"Typography.tsx",children:t})}i.Title=function(e){let{className:t,level:s=1,children:a,style:r}=e;return(0,n.jsx)("h".concat(s),{style:r,"data-sentry-element":"CustomTag","data-sentry-component":"Title","data-sentry-source-file":"Title.tsx",children:a})},i.Text=function(e){let{className:t,children:s,style:a,type:r,disabled:l,mark:i,code:o,keyboard:c,underline:d,strikethrough:u,strong:m,small:x}=e;return o?(0,n.jsx)("code",{style:a,children:s}):i?(0,n.jsx)("mark",{style:a,children:s}):c?(0,n.jsx)("kbd",{style:a,children:s}):m?(0,n.jsx)("strong",{style:a,children:s}):(0,n.jsx)("span",{style:a,"data-sentry-component":"Text","data-sentry-source-file":"Text.tsx",children:s})},i.Link=function(e){let{children:t,target:s="_blank",href:a,className:r,onClick:l,style:i}=e;return(0,n.jsx)("a",{onClick:l,href:a,target:s,rel:"noopener noreferrer",style:i,"data-sentry-component":"Link","data-sentry-source-file":"Link.tsx",children:t})};let o=(0,a.createContext)({type:"text"}),c=e=>{let{type:t}=e;return(0,n.jsx)(o.Provider,{value:{type:t},"data-sentry-element":"unknown","data-sentry-component":"MenuContextProvider","data-sentry-source-file":"MenuContext.tsx",children:e.children})},d=()=>{let e=(0,a.useContext)(o);if(void 0===e)throw Error("MenuContext must be used within a MenuContextProvider.");return e};function u(e){let{children:t,className:s,ulClassName:a,style:r,type:l="text"}=e;return(0,n.jsx)("nav",{role:"menu","aria-label":"Sidebar","aria-orientation":"vertical","aria-labelledby":"options-menu",className:s,style:r,"data-sentry-component":"Menu","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(c,{type:l,"data-sentry-element":"MenuContextProvider","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("ul",{className:a,children:t})})})}u.Item=function(e){let{children:t,icon:s,active:a,rounded:i,onClick:o,doNotCloseOverlay:c=!1,showActiveBar:u=!1,style:m}=e,x=(0,r.A)("menu"),{type:h}=d(),p=[x.item.base];p.push(x.item.variants[h].base),a?p.push(x.item.variants[h].active):p.push(x.item.variants[h].normal);let f=[x.item.content.base];a?f.push(x.item.content.active):f.push(x.item.content.normal);let y=[x.item.icon.base];return a?y.push(x.item.icon.active):y.push(x.item.icon.normal),(0,n.jsxs)("li",{role:"menuitem",className:(0,l.cn)("outline-none",p),style:m,onClick:o,"aria-current":a?"page":void 0,"data-sentry-component":"Item","data-sentry-source-file":"Menu.tsx",children:[s&&(0,n.jsx)("div",{className:"".concat(y.join(" ")," min-w-fit"),children:s}),(0,n.jsx)("span",{className:f.join(" "),children:t})]})},u.Group=function(e){let{children:t,icon:s,title:a}=e,l=(0,r.A)("menu"),{type:i}=d();return(0,n.jsxs)("div",{className:[l.group.base,l.group.variants[i]].join(" "),"data-sentry-component":"Group","data-sentry-source-file":"Menu.tsx",children:[s&&(0,n.jsx)("span",{className:l.group.icon,children:s}),(0,n.jsx)("span",{className:l.group.content,children:a}),t]})},u.Misc=function(e){let{children:t}=e;return(0,n.jsx)("div",{"data-sentry-component":"Misc","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)(i.Text,{"data-sentry-element":"unknown","data-sentry-source-file":"Menu.tsx",children:(0,n.jsx)("span",{children:t})})})};let m=u},39071:(e,t,s)=>{"use strict";s.d(t,{l:()=>i});var n=s(80263),a=s(38220),r=s(65863),l=s(12484);let i=e=>{let{page:t,menu:s}=e;return(0,n.jsx)("div",{className:"flex flex-col space-y-8 overflow-y-auto","data-sentry-component":"ProductMenu","data-sentry-source-file":"ProductMenu.tsx",children:(0,n.jsx)(a.Ay,{type:"pills","data-sentry-element":"Menu","data-sentry-source-file":"ProductMenu.tsx",children:s.map((e,i)=>(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"my-6 space-y-8",children:(0,n.jsxs)("div",{className:"mx-3",children:[(0,n.jsx)(a.Ay.Group,{title:e.title?(0,n.jsxs)("div",{className:"flex flex-col space-y-2 uppercase font-mono",children:[(0,n.jsx)("span",{children:e.title}),e.isPreview&&(0,n.jsx)(r.E,{variant:"warning",children:"Not production ready"})]}):null}),(0,n.jsx)("div",{children:e.items.map(e=>{let s=e.pages?e.pages.includes(null!=t?t:""):t===e.key;return(0,n.jsx)(l.A,{url:e.url,name:e.name,icon:e.icon,rightIcon:e.rightIcon,isActive:s,isExternal:e.isExternal,target:e.isExternal?"_blank":"_self",label:e.label},e.key)})})]})}),i!==s.length-1&&(0,n.jsx)("div",{className:"h-px w-full bg-border-overlay"})]},e.key||e.title))})})}},40402:(e,t,s)=>{"use strict";s.d(t,{BS:()=>i,Dm:()=>d,HJ:()=>g,Rf:()=>y,Uw:()=>c,Vw:()=>N,Xr:()=>b,aw:()=>p,bV:()=>l,cJ:()=>x,dX:()=>u,eh:()=>o,fh:()=>v,gu:()=>m,sZ:()=>h,tn:()=>j,xp:()=>f});var n=s(80263),a=s(53239),r=s(51859);let l="mx-auto w-full max-w-[1200px]",i="px-4 @lg:px-6 @xl:px-12 @2xl:px-20 @3xl:px-24",o=(0,a.forwardRef)((e,t)=>{let{className:s,bottomPadding:a,size:l="default",...o}=e;return(0,n.jsx)("div",{ref:t,...o,className:(0,r.cn)("mx-auto w-full",{small:"max-w-[768px]",default:"max-w-[1200px]",large:"max-w-[1600px]",full:"max-w-none"}[l],i,a&&"pb-16",s)})}),c=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("header",{...a,ref:t,className:(0,r.cn)("w-full","flex-col gap-3 py-6",s)})}),d=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("h1",{ref:t,...a,className:(0,r.cn)("text-2xl",s)})}),u=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("p",{ref:t,...a,className:(0,r.cn)("text-sm text-foreground-light",s)})}),m=(0,a.forwardRef)((e,t)=>{let{className:s,isFullWidth:a,topPadding:l,...i}=e;return(0,n.jsx)("div",{ref:t,...i,className:(0,r.cn)("flex flex-col first:pt-12 py-6",a?"w-full":"gap-3 lg:grid md:grid-cols-12",s)})}),x=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,r.cn)("w-full h-px bg-border",s)})}),h=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("h3",{ref:t,...a,className:(0,r.cn)("text-foreground text-xl",s)})}),p=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("p",{ref:t,...a,className:(0,r.cn)("text-sm text-foreground-light",s)})}),f=(0,a.forwardRef)((e,t)=>{let{className:s,children:a,title:l,...i}=e;return(0,n.jsxs)("div",{ref:t,...i,className:(0,r.cn)("col-span-4 xl:col-span-5 prose text-sm",s),children:[l&&(0,n.jsx)("h2",{children:l}),a]})}),y=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,r.cn)("col-span-8 xl:col-span-7","flex flex-col gap-6",s)})}),j=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,r.cn)("flex flex-col gap-3 items-center",s)})}),g=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,r.cn)("flex w-full items-center",s)})}),v=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,r.cn)("flex flex-row gap-3",s)})}),b=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,r.cn)("flex flex-col gap-3","min-w-[420px]",s)})}),N=(0,a.forwardRef)((e,t)=>{let{className:s,...a}=e;return(0,n.jsx)("div",{ref:t,...a,className:(0,r.cn)(l,i,"my-8 flex flex-col gap-8",s)})});c.displayName="ScaffoldHeader",d.displayName="ScaffoldTitle",u.displayName="ScaffoldDescription",o.displayName="ScaffoldContainer",x.displayName="ScaffoldDivider",m.displayName="ScaffoldSection",b.displayName="ScaffoldColumn",f.displayName="ScaffoldSectionDetail",y.displayName="ScaffoldSectionContent",j.displayName="ScaffoldFilterAndContent",g.displayName="ScaffoldActionsContainer",v.displayName="ScaffoldActionsGroup",N.displayName="ScaffoldContainerLegacy",h.displayName="ScaffoldSectionTitle",p.displayName="ScaffoldSectionDescription"},48660:(e,t,s)=>{"use strict";s.d(t,{k:()=>n});let n={list:e=>["projects",e,"views"],listBySchema:(e,t)=>[...n.list(e),t]}},55476:(e,t,s)=>{"use strict";s.d(t,{A:()=>d});var n=s(80263),a=s(53239),r=s(19480),l=s(16865),i=s(3891);let o=(0,a.createContext)({parentCallback:e=>{},type:"",name:"",activeId:"",parentSize:""});function c(e){var t;let{id:s=(t=46656*Math.random()|0,("00000"+(46656*Math.random()|0).toString(36)).slice(-3)+("00000"+t.toString(36)).slice(-3)),disabled:a,value:r,label:c,afterLabel:d,beforeLabel:u,description:m,name:x,checked:h,className:p,onChange:f,onBlur:y,hidden:j=!1,size:g="medium",align:v="vertical",optionalLabel:b,addOnBefore:N,children:w}=e,S=(0,l.A)("radio"),{handleBlur:A}=(0,i.x)();function C(e){A&&A(e),y&&y(e)}return(0,n.jsx)(o.Consumer,{"data-sentry-element":"unknown","data-sentry-component":"Radio","data-sentry-source-file":"Radio.tsx",children:e=>{let{parentCallback:t,type:l,name:i,activeId:o,parentSize:y}=e;g=y||g;let A=o===s||!!h||!1!==h&&void 0,_=[p,S.variants[l].container.base,"list"===l&&!j&&S.variants[l].container.size[g]];return _.push(S.variants[l].base),_.push(S.variants[l].size[g]),A?_.push(S.variants[l].active):_.push(S.variants[l].inactive),a&&_.push(S.disabled),"list"!==l&&(j=!0),(0,n.jsxs)("label",{htmlFor:s,className:_.join(" "),children:[(0,n.jsx)("input",{id:s,name:i||x,type:"radio",className:[S.base,S.size[g],j&&S.hidden,S.variants[l].radio_offset,""].join(" "),checked:A,disabled:a,value:r||s,onChange:e=>{t&&t(e),f&&f(e)},onBlur:C}),N,w||(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:[S.label.base,S.label[g],S.variants[l].container.align[v]].join(" "),children:[u&&(0,n.jsx)("div",{className:[S.label_before.base,S.label_before[g]].join(" "),children:u}),(0,n.jsx)("div",{children:c}),d&&(0,n.jsx)("div",{className:[S.label_after.base,S.label_after[g]].join(" "),children:d}),m&&(0,n.jsx)("div",{className:[S.description.base,S.description[g]].join(" "),children:m})]}),b&&(0,n.jsx)("div",{className:[S.optionalLabel.base,S.optionalLabel[g]].join(" "),children:b})]})]})}})}c.Group=function(e){let{id:t,layout:s,error:d,descriptionText:u,label:m,afterLabel:x,beforeLabel:h,labelOptional:p,children:f,className:y,type:j="list",options:g,value:v,name:b,onChange:N,size:w="medium",validation:S,groupClassName:A,labelsLayout:C="vertical"}=e,[_,k]=(0,a.useState)(""),E=(0,l.A)("radio"),{formContextOnChange:R,values:T,errors:L,touched:z,fieldLevelValidation:I}=(0,i.x)();return T&&!v&&(v=T[t||b]),d||(L&&!d&&(d=L[t||b]),d=z&&z[t||b]?d:void 0),(0,a.useEffect)(()=>{S&&I(t,S(v))},[]),(0,a.useEffect)(()=>{k(v)},[v]),(0,n.jsx)("fieldset",{name:b,className:y,"data-sentry-component":"RadioGroup","data-sentry-source-file":"Radio.tsx",children:(0,n.jsx)(r.H,{nonBoxInput:!0,label:m,afterLabel:x,beforeLabel:h,labelOptional:p,layout:s,id:t,error:d,descriptionText:u,size:w,labelLayout:C,"data-sentry-element":"FormLayout","data-sentry-source-file":"Radio.tsx",children:(0,n.jsx)("div",{className:A||E.variants[j].group,children:(0,n.jsx)(o.Provider,{value:{parentCallback:function(e){N&&N(e),R&&R(e),S&&I(t,S(e.target.value)),k(e.target.id)},type:j,name:b,activeId:_,parentSize:w},"data-sentry-element":"unknown","data-sentry-source-file":"Radio.tsx",children:g?g.map(e=>(0,n.jsx)(c,{id:e.id,label:e.label,beforeLabel:e.beforeLabel,afterLabel:e.afterLabel,value:e.value,description:e.description})):f})})})})};let d=c},58423:(e,t,s)=>{"use strict";s.d(t,{h:()=>o});var n=s(56947),a=s(40807),r=s(68875),l=s(95059);async function i(e,t){let{projectRef:s}=e;if(!s)throw Error("Project ref is required");let{data:n,error:r}=await (0,a.Jt)("/platform/database/{ref}/backups",{params:{path:{ref:s}},signal:t});return r&&(0,a.H4)(r),n}let o=function(e){let{projectRef:t}=e,{enabled:s=!0,...a}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=(0,r.CG)();return(0,n.I)(l.c.backups(t),e=>{let{signal:s}=e;return i({projectRef:t},s)},{enabled:s&&!o&&void 0!==t,...a})}},65645:(e,t,s)=>{"use strict";s.d(t,{p:()=>i});var n=s(56947),a=s(40807),r=s(68966);async function l(e,t){let{projectRef:s,connectionString:n}=e;if(!s)throw Error("projectRef is required");let r=new Headers;n&&r.set("x-connection-encrypted",n);let{data:l,error:i}=await (0,a.Jt)("/platform/pg-meta/{ref}/types",{params:{header:{"x-connection-encrypted":n},path:{ref:s}},headers:Object.fromEntries(r),signal:t});return i&&(0,a.H4)(i),l}let i=function(e){let{projectRef:t,connectionString:s}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.K.list(t),e=>{let{signal:n}=e;return l({projectRef:t,connectionString:s},n)},{enabled:a&&void 0!==t,...i})}},68557:(e,t,s)=>{"use strict";s.d(t,{K:()=>f,T:()=>g});var n=s(80263),a=s(53239),r=s(51527),l=s(51859),i=s(16632),o=s(53434),c=s.n(o),d=s(27344),u=s.n(d),m=s(37361),x=s.n(m);c().extend(u()),c().extend(x());let h=e=>c().unix(Number(e)/1e3/1e3).toISOString(),p=e=>{let t=16===String(e).length;return!Number.isNaN(Number(e))&&t},f=e=>{let{utcTimestamp:t,format:s}=e,n=p(t)?h(t):t;return c().utc(n).local().format(s)},y=e=>{let{utcTimestamp:t,format:s}=e,n=p(t)?h(t):t;return c().utc(n).format(s)},j=e=>{let{utcTimestamp:t}=e,s=p(t)?h(t):t;return c().utc(s).fromNow()},g=e=>{let{utcTimestamp:t,className:s,displayAs:o="local",format:c="DD MMM  HH:mm:ss",labelFormat:d="DD MMM HH:mm:ss"}=e,u=f({utcTimestamp:t,format:c}),m=y({utcTimestamp:t,format:c}),x=j({utcTimestamp:t}),[h,p]=(0,a.useState)("start"),g=(0,a.useRef)(null),v=Intl.DateTimeFormat().resolvedOptions().timeZone;(0,a.useEffect)(()=>{let e=()=>{if(g.current){let e=g.current.getBoundingClientRect(),t=window.innerHeight;p(e.top<t/2?"start":"end")}};return e(),window.addEventListener("scroll",e),window.addEventListener("resize",e),()=>{window.removeEventListener("scroll",e),window.removeEventListener("resize",e)}},[]);let b=e=>{let{label:t,value:s}=e,[i,o]=(0,a.useState)(!1);return(0,n.jsxs)("div",{onPointerDown:e=>{e.stopPropagation()},onMouseDown:e=>{e.stopPropagation()},onClick:e=>{e.stopPropagation(),e.preventDefault(),(0,r.l)(s,()=>{o(!0),setTimeout(()=>{o(!1)},1e3)})},className:(0,l.cn)("relative cursor-pointer flex gap-y-2 gap-x-0.5 hover:bg-surface-100 px-2 py-1 group",{"bg-surface-100":i}),"data-sentry-component":"TooltipRow","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2 text-left truncate",children:[(0,n.jsx)("p",{children:t}),(0,n.jsx)("div",{className:"border-t w-full border-dashed"})]}),(0,n.jsxs)("div",{className:"relative flex items-center gap-x-2 flex-grow",children:[(0,n.jsx)("div",{className:"border-t w-full border-dashed z-10"}),i&&(0,n.jsx)("span",{className:"flex items-center justify-end w-full absolute inset-0 flex items-right text-brand-600 bg-surface-100",children:"Copied!"}),(0,n.jsx)("span",{className:"flex items-center gap-x-2 justify-end whitespace-nowrap",children:s})]})]})};return(0,n.jsxs)(i.m_,{"data-sentry-element":"Tooltip","data-sentry-component":"TimestampInfo","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(i.k$,{asChild:!0,ref:g,className:"text-xs ".concat(s," border-b border-transparent hover:border-dashed hover:border-foreground-light"),"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"index.tsx",children:(0,n.jsx)("span",{children:"local"===o?f({utcTimestamp:t,format:d}):y({utcTimestamp:t,format:d})})}),(0,n.jsxs)(i.ZI,{align:h,side:"right",className:"font-mono p-0 py-1 min-w-80","data-sentry-element":"TooltipContent","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(b,{label:"UTC",value:m,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:v,value:u,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:"Relative",value:x,"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(b,{label:"Timestamp",value:String(t),"data-sentry-element":"TooltipRow","data-sentry-source-file":"index.tsx"})]})]})}},69879:(e,t,s)=>{"use strict";s.d(t,{_:()=>i});var n=s(56947),a=s(40807),r=s(9611);async function l(e,t){let{projectRef:s,connectionString:n}=e;if(!s)throw Error("projectRef is required");let r=new Headers;n&&r.set("x-connection-encrypted",n);let{data:l,error:i}=await (0,a.Jt)("/platform/pg-meta/{ref}/publications",{params:{header:{"x-connection-encrypted":n},path:{ref:s}},headers:r,signal:t});return i&&(0,a.H4)(i),l}let i=function(e){let{projectRef:t,connectionString:s}=e,{enabled:a=!0,...i}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,n.I)(r.b.list(t),e=>{let{signal:n}=e;return l({projectRef:t,connectionString:s},n)},{enabled:a&&void 0!==t,...i})}},76448:(e,t,s)=>{"use strict";s.d(t,{M:()=>l});var n=s(80263),a=s(51859),r=s(23992);let l=e=>{let{title:t,description:s,docsUrl:l,actions:i,className:o}=e;return(0,n.jsxs)("div",{className:(0,a.cn)("w-full mb-6 flex flex-col sm:flex-row md:items-center justify-between gap-4 ".concat(o)),"data-sentry-component":"FormHeader","data-sentry-source-file":"FormHeader.tsx",children:[(0,n.jsxs)("div",{className:"space-y-1",children:[(0,n.jsx)("h3",{className:"text-foreground text-xl prose",children:t}),s&&(0,n.jsx)("div",{className:"prose text-sm max-w-2xl",children:s})]}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row md:items-center gap-x-2",children:[void 0!==l&&(0,n.jsx)(r.A,{href:l}),i]})]})}},86639:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});var n=s(80263),a=s(70324),r=s(83086);let l=()=>(0,n.jsxs)(a.Fc,{variant:"default","data-sentry-element":"Alert_Shadcn_","data-sentry-component":"BackupsStorageAlert","data-sentry-source-file":"BackupsStorageAlert.tsx",children:[(0,n.jsx)(r.id,{"data-sentry-element":"WarningIcon","data-sentry-source-file":"BackupsStorageAlert.tsx"}),(0,n.jsx)(a.TN,{"data-sentry-element":"AlertDescription_Shadcn_","data-sentry-source-file":"BackupsStorageAlert.tsx",children:"Database backups do not include objects stored via the Storage API, as the database only includes metadata about these objects. Restoring an old backup does not restore objects that have been deleted since then."})]})},88767:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var n=s(80263),a=s(51859);let r=e=>{let{max:t=100,value:s=0,barClass:r="bg-foreground",bgClass:l="",type:i="vertical",borderClass:o="",labelBottom:c="",labelBottomClass:d="tabular-nums",labelTop:u="",labelTopClass:m=""}=e;if("horizontal"===i){let e=Number(s/t*100),i=c||u;return(0,n.jsxs)("div",{className:"flex flex-col w-full",children:[i&&(0,n.jsxs)("div",{className:"flex align-baseline justify-between pb-1 space-x-8",children:[(0,n.jsx)("p",{className:(0,a.cn)("text-foreground text-sm truncate capitalize-sentence",u.length>0&&"max-w-[75%]",d),children:c}),(0,n.jsx)("p",{className:(0,a.cn)("text-foreground-light text-sm",m),children:u})]}),(0,n.jsx)("div",{className:"relative rounded h-1 overflow-hidden w-full border p-0 ".concat(l||"bg-surface-400"," ").concat(o||"border-none"),children:(0,n.jsx)("div",{className:"absolute rounded inset-x-0 bottom-0 h-1 ".concat(r," transition-all"),style:{width:"".concat(e,"%")}})})]})}{let e=Number(s/t*35);return e<2&&(e=2),(0,n.jsx)("div",{className:"relative rounded w-5 overflow-hidden border p-1 ".concat(l||"bg-gray-400"," ").concat(o||"border-none"),style:{height:35},children:(0,n.jsx)("div",{className:"absolute inset-x-0 bottom-0 w-5 ".concat(r),style:{height:e}})})}}},89262:(e,t,s)=>{"use strict";s.d(t,{GQ:()=>r,Il:()=>l});var n=s(97344),a=s.n(n);function r(e){let t=null==e?void 0:e.split(",").map(e=>e.trim());return a()(e)||!t||0===t.length?{value:[]}:{value:t.map(e=>{let t=e.match(/(\w+)\s+([\w\[\]]+)(?:\s+DEFAULT\s+(.*))?/i);if(!t)return console.error("Error while trying to parse function arguments",e),null;{let[,e,s,n]=t,a=n?n.trim():void 0;return["timestamp","time","timetz","timestamptz"].includes(s.toLowerCase())&&a&&(a="'".concat(a,"'")),{name:e,type:s,defaultValue:a}}}).filter(Boolean)}}function l(e){let t=[];if(e)for(var s in e)t.push({name:s,value:e[s]});return{value:t}}},89771:(e,t,s)=>{"use strict";s.d(t,{z:()=>c});var n=s(56947),a=s(40807),r=s(73516),l=s(68875),i=s(64036);async function o(e,t){let{projectRef:s,connectionString:n}=e;if(!s)throw Error("projectRef is required");let r=new Headers;n&&r.set("x-connection-encrypted",n);let{data:l,error:i}=await (0,a.Jt)("/platform/pg-meta/{ref}/extensions",{params:{header:{"x-connection-encrypted":n},path:{ref:s}},headers:r,signal:t});return i&&(0,a.H4)(i),l}let c=function(e){let{projectRef:t,connectionString:s}=e,{enabled:a=!0,...c}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},d=(0,l.KT)(),u=(null==d?void 0:d.status)===i.BU.ACTIVE_HEALTHY;return(0,n.I)(r.I.list(t),e=>{let{signal:n}=e;return o({projectRef:t,connectionString:s},n)},{enabled:a&&void 0!==t&&u,...c})}},91378:(e,t,s)=>{"use strict";s.d(t,{d:()=>d});var n=s(80263),a=s(44893),r=s(79279),l=s(53239),i=s(51859);let o=(0,r.F)("peer inline-flex shrink-0 cursor-pointer items-center rounded-full border transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-brand data-[state=checked]:hover:bg-brand-600/90 data-[state=unchecked]:bg-control data-[state=unchecked]:hover:bg-border",{variants:{size:{small:"h-[16px] w-[28px]",medium:"h-[20px] w-[34px]",large:"h-[24px] w-[44px]"}},defaultVariants:{size:"medium"}}),c=(0,r.F)("pointer-events-none block rounded-full bg-foreground-lighter data-[state=checked]:bg-white shadow-lg ring-0 transition-transform",{variants:{size:{small:"h-[12px] w-[12px] data-[state=checked]:translate-x-[13px] data-[state=unchecked]:translate-x-[1px]",medium:"h-[16px] w-[16px] data-[state=checked]:translate-x-[15px] data-[state=unchecked]:translate-x-[1px]",large:"h-[18px] w-[18px] data-[state=checked]:translate-x-[22px] data-[state=unchecked]:translate-x-[3px]"}},defaultVariants:{size:"medium"}}),d=l.forwardRef((e,t)=>{let{className:s,size:r,...l}=e;return(0,n.jsx)(a.bL,{className:(0,i.cn)(o({size:r}),s),...l,ref:t,children:(0,n.jsx)(a.zi,{className:(0,i.cn)(c({size:r}))})})});d.displayName=a.bL.displayName},91962:(e,t,s)=>{"use strict";s.d(t,{AL:()=>c,J5:()=>u,J_:()=>o,N1:()=>i,aw:()=>d,fX:()=>y,mL:()=>m,mN:()=>x,wB:()=>h,wy:()=>f,x0:()=>p});var n=s(86631),a=s.n(n),r=s(14506),l=s.n(r);let i=["int2","int4","int8","float4","float8","numeric","double precision"],o=["json","jsonb"],c=["text","varchar"],d=["timestamp","timestamptz"],u=["date"],m=["time","timetz"],x=a()(d,u,m),h=["uuid","bool","vector","bytea"],p=l()(a()(i,o,c,x,h)),f={varchar:{alternative:"text",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_varchar.28n.29_by_default"},json:{alternative:"jsonb",reference:"https://www.postgresql.org/docs/current/datatype-json.html"},timetz:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timetz"},timestamp:{alternative:"timestamptz",reference:"https://wiki.postgresql.org/wiki/Don't_Do_This#Don.27t_use_timestamp_.28without_time_zone.29"}},y=[{name:"int2",description:"Signed two-byte integer",type:"number"},{name:"int4",description:"Signed four-byte integer",type:"number"},{name:"int8",description:"Signed eight-byte integer",type:"number"},{name:"float4",description:"Single precision floating-point number (4 bytes)",type:"number"},{name:"float8",description:"Double precision floating-point number (8 bytes)",type:"number"},{name:"numeric",description:"Exact numeric of selectable precision",type:"number"},{name:"json",description:"Textual JSON data",type:"json"},{name:"jsonb",description:"Binary JSON data, decomposed",type:"json"},{name:"text",description:"Variable-length character string",type:"text"},{name:"varchar",description:"Variable-length character string",type:"text"},{name:"uuid",description:"Universally unique identifier",type:"text"},{name:"date",description:"Calendar date (year, month, day)",type:"time"},{name:"time",description:"Time of day (no time zone)",type:"time"},{name:"timetz",description:"Time of day, including time zone",type:"time"},{name:"timestamp",description:"Date and time (no time zone)",type:"time"},{name:"timestamptz",description:"Date and time, including time zone",type:"time"},{name:"bool",description:"Logical boolean (true/false)",type:"bool"},{name:"bytea",description:"Variable-length binary string",type:"others"}]},94555:(e,t,s)=>{"use strict";s.d(t,{A:()=>I});var n=s(80263),a=s(60045),r=s(8945),l=s(96282),i=s(45936),o=s(74438),c=s(95e3),d=s(59153),u=s.n(d),m=s(53239),x=s(73969),h=s(97872),p=s(41370),f=s(45874),y=s(32144),j=s(80251),g=s(96557),v=s(73516);async function b(e){let{projectRef:t,connectionString:s,id:n,cascade:a}=e,r=new Headers;s&&r.set("x-connection-encrypted",s);let{sql:l}=f.A.extensions.remove(n,{cascade:a}),{result:i}=await (0,g.E)({projectRef:t,connectionString:s,sql:l,queryKey:["extension","delete",n]});return i}let N=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,y.jE)();return(0,j.n)(e=>b(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(v.I.list(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?x.oR.error("Failed to disable database extension: ".concat(e.message)):t(e,s,n)},...s})};var w=s(77227),S=s(68875),A=s(88170),C=s(51859),_=s(16632),k=s(91378),E=s(71126),R=s(10406),T=s(64540),L=s(7971),z=s(12204);let I=e=>{var t,s,d;let{extension:f}=e,{project:y}=(0,h.Om)(),j=null!==f.installed_version,g=(0,S.W0)(),[v,b]=(0,m.useState)(!1),[I,F]=(0,m.useState)(!1),D=(0,w.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"extensions"),P=g&&"orioledb"===f.name,B=!D||P,M="px-5",O=A.XO.find(e=>e.name===f.name),V=(null==O?void 0:O.link.startsWith("/guides"))?"https://supabase.com/docs".concat(null==O?void 0:O.link):null!=(t=null==O?void 0:O.link)?t:void 0,{mutate:q,isLoading:$}=N({onSuccess:()=>{x.oR.success("".concat(f.name," is off.")),b(!1)}}),Y=()=>{if(void 0===y)return console.error("Project is required");q({projectRef:y.ref,connectionString:y.connectionString,id:f.name})};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"bg-surface-100 border border-overlay flex flex-col overflow-hidden rounded shadow-sm",children:[(0,n.jsxs)("div",{className:(0,C.cn)("border-b border-overlay flex justify-between w-full py-3",M),children:[(0,n.jsxs)("div",{className:"max-w-[85%] flex items-center space-x-3 truncate",children:[(0,n.jsx)("h3",{title:f.name,className:"h-5 m-0 text-sm truncate cursor-pointer text-foreground",children:f.name}),(0,n.jsx)("p",{className:"text-sm text-foreground-light font-mono tracking-tighter",children:null!=(s=null==f?void 0:f.installed_version)?s:f.default_version})]}),$?(0,n.jsx)(r.A,{className:"animate-spin",size:16}):(0,n.jsxs)(_.m_,{children:[(0,n.jsx)(_.k$,{children:(0,n.jsx)(k.d,{disabled:B,checked:j,onCheckedChange:()=>j?b(!0):F(!0)})}),B&&(0,n.jsx)(_.ZI,{side:"bottom",children:D?P?"Project is using OrioleDB and cannot be disabled":null:"You need additional permissions to toggle extensions"})]})]}),j&&(0,n.jsx)("div",{className:(0,C.cn)("border-b border-overlay py-2",M),children:(0,n.jsxs)("p",{className:"text-foreground-light text-sm",children:["Installed in ",(0,n.jsx)("span",{className:"text-foreground",children:f.schema})," schema"]})}),(0,n.jsxs)("div",{className:(0,C.cn)("flex h-full flex-col gap-y-3 py-3",M),children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light capitalize-sentence",children:f.comment}),(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(null==O?void 0:O.github_url)&&(0,n.jsx)(E.$,{asChild:!0,type:"default",icon:(0,n.jsx)(l.A,{}),className:"rounded-full",children:(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",href:O.github_url,className:"font-mono tracking-tighter",children:O.github_url.split("/").slice(-2).join("/")})}),void 0!==V&&(0,n.jsx)(E.$,{asChild:!0,type:"default",icon:(0,n.jsx)(i.A,{}),className:"rounded-full",children:(0,n.jsx)("a",{target:"_blank",rel:"noreferrer",className:"font-mono tracking-tighter",href:V,children:"Docs"})}),(null==O?void 0:O.deprecated)&&(null==O?void 0:O.deprecated.length)>0&&(0,n.jsx)(p.G,{type:"warning",icon:(0,n.jsx)(o.A,{}),className:"rounded-full",tooltip:{content:{text:"The extension is deprecated and will be removed in ".concat(O.deprecated.join(", "),".")}},children:"Deprecated"})]})]}),(null==O?void 0:O.product)&&(0,n.jsxs)("div",{className:(0,C.cn)("border-t border-overlay py-3 flex items-center gap-x-3",M),children:[(0,n.jsx)("div",{className:"min-w-5 w-5 h-5 border border-brand/50 rounded flex items-center justify-center",children:(0,n.jsx)(c.A,{className:"text-brand",size:12})}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("p",{className:"text-foreground-light text-xs",children:[(0,n.jsx)("span",{className:"text-foreground",children:f.name})," is used by"," ",O.product_url?(0,n.jsx)(u(),{href:O.product_url.replace("{ref}",null!=(d=null==y?void 0:y.ref)?d:""),className:"transition hover:text-foreground",children:O.product}):O.product]}),!j&&(0,n.jsxs)("p",{className:"text-foreground-lighter text-xs",children:["Install extension to use ",O.product]})]})]})]}),(0,n.jsx)(L.A,{visible:I,extension:f,onCancel:()=>F(!1),"data-sentry-element":"EnableExtensionModal","data-sentry-source-file":"ExtensionCard.tsx"}),(0,n.jsx)(T.A,{visible:v,title:"Confirm to disable extension",confirmLabel:"Disable",variant:"destructive",confirmLabelLoading:"Disabling",onCancel:()=>b(!1),onConfirm:()=>Y(),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"ExtensionCard.tsx",children:(0,n.jsxs)("div",{className:"flex flex-col gap-y-3",children:[(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Are you sure you want to turn OFF the "',f.name,'" extension?']}),z.lR[f.name]&&(0,n.jsx)(R.Z,{type:"warning",className:"m-0",children:z.lR[f.name]})]})})]})}},95268:(e,t,s)=>{"use strict";s.d(t,{I:()=>r});var n=s(80263),a=s(71126);let r=e=>{let{form:t,hasChanges:s,handleReset:r,helper:l,disabled:i=!1,isSubmitting:o,submitText:c="Save"}=e,d=o||i||!s&&void 0!==s;return(0,n.jsxs)("div",{className:["flex w-full items-center gap-2",l?"justify-between":"justify-end"].join(" "),"data-sentry-component":"FormActions","data-sentry-source-file":"FormActions.tsx",children:[l&&(0,n.jsx)("span",{className:"text-sm text-foreground-lighter",children:l}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(a.$,{disabled:d,type:"default",htmlType:"reset",onClick:()=>r(),"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:"Cancel"}),(0,n.jsx)(a.$,{form:t,type:"primary",htmlType:"submit",disabled:d,loading:o,"data-sentry-element":"Button","data-sentry-source-file":"FormActions.tsx",children:c})]})]})}},95584:(e,t,s)=>{"use strict";s.d(t,{aE:()=>tN,$e:()=>I,ZO:()=>tG,iZ:()=>t4,IP:()=>sx,Fd:()=>e8,eL:()=>tt,ZZ:()=>ta,Ey:()=>eQ,B3:()=>ec});var n=s(80263),a=s(60045),r=s(83927),l=s.n(r),i=s(61062),o=s(95285),c=s(66345),d=s(44679),u=s(62763),m=s(1051),x=s(15576),h=s(28097),p=s(59153),f=s.n(p),y=s(53239),j=s(19898),g=s(97872),v=s(12804),b=s(80125),N=s(48153),w=s(41370),S=s(96457),A=s(49015),C=s(42592),_=s(77227),k=s(82008),E=s(71126),R=s(16988),T=s(74115),L=s(16632),z=s(43970);let I=e=>{var t,s,r,p,I;let{onAddColumn:F=l(),onEditColumn:D=l(),onDeleteColumn:P=l()}=e,{id:B,ref:M}=(0,j.g)(),O=B?Number(B):void 0,{project:V}=(0,g.Om)(),{data:q,error:$,isError:Y,isLoading:W,isSuccess:H}=(0,A.Pk)({projectRef:null==V?void 0:V.ref,connectionString:null==V?void 0:V.connectionString,id:O}),[U,J]=(0,y.useState)(""),G=(0,C.KO)(q),K=null!=(r=0===U.length?null!=(s=null==q?void 0:q.columns)?s:[]:null==q||null==(t=q.columns)?void 0:t.filter(e=>e.name.includes(U)))?r:[],Q=k.i.includes(null!=(p=null==q?void 0:q.schema)?p:""),Z=(0,_.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"columns");return(0,n.jsxs)("div",{className:"space-y-4","data-sentry-component":"ColumnList","data-sentry-source-file":"ColumnList.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)(E.$,{asChild:!0,type:"outline",icon:(0,n.jsx)(i.A,{}),style:{padding:"5px"},"data-sentry-element":"Button","data-sentry-source-file":"ColumnList.tsx",children:(0,n.jsx)(f(),{href:"/project/".concat(M,"/database/tables"),"data-sentry-element":"Link","data-sentry-source-file":"ColumnList.tsx"})}),(0,n.jsx)(R.A,{size:"small",placeholder:"Filter columns",value:U,onChange:e=>J(e.target.value),icon:(0,n.jsx)(o.A,{size:12}),"data-sentry-element":"Input","data-sentry-source-file":"ColumnList.tsx"})]}),!Q&&G&&(0,n.jsx)(w.G,{icon:(0,n.jsx)(c.A,{}),disabled:!Z,onClick:()=>F(),tooltip:{content:{side:"bottom",text:Z?void 0:"You need additional permissions to create columns"}},children:"New column"})]}),Q&&(0,n.jsx)(z.A,{schema:null!=(I=null==q?void 0:q.schema)?I:"",entity:"columns"}),W&&(0,n.jsx)(S.y,{}),Y&&(0,n.jsx)(N.A,{error:$,subject:'Failed to retrieve columns for table "'.concat(null==q?void 0:q.schema,".").concat(null==q?void 0:q.name,'"')}),H&&(0,n.jsx)(n.Fragment,{children:0===K.length?(0,n.jsx)(v.A,{}):(0,n.jsx)("div",{children:(0,n.jsx)(b.A,{head:[(0,n.jsx)(b.A.th,{children:"Name"},"name"),(0,n.jsx)(b.A.th,{className:"hidden lg:table-cell",children:"Description"},"description"),(0,n.jsx)(b.A.th,{children:"Data Type"},"type"),(0,n.jsx)(b.A.th,{children:"Format"},"format"),(0,n.jsx)(b.A.th,{className:"text-center",children:"Nullable"},"format"),(0,n.jsx)(b.A.th,{},"buttons")],body:K.map(e=>(0,n.jsxs)(b.A.tr,{className:"border-t",children:[(0,n.jsx)(b.A.td,{children:(0,n.jsx)("p",{children:e.name})}),(0,n.jsx)(b.A.td,{className:"break-all whitespace-normal hidden xl:table-cell",children:null!==e.comment?(0,n.jsx)("p",{title:e.comment,children:e.comment}):(0,n.jsx)("p",{className:"text-border-stronger",children:"No description"})}),(0,n.jsx)(b.A.td,{children:(0,n.jsx)("code",{className:"text-xs",children:e.data_type})}),(0,n.jsx)(b.A.td,{className:"font-mono text-xs",children:(0,n.jsx)("code",{className:"text-xs",children:e.format})}),(0,n.jsx)(b.A.td,{className:"font-mono text-xs",children:e.is_nullable?(0,n.jsx)(d.A,{size:16,className:"mx-auto"}):(0,n.jsx)(u.A,{size:16,className:"mx-auto"})}),(0,n.jsx)(b.A.td,{className:"text-right",children:!Q&&G&&(0,n.jsxs)(T.rI,{children:[(0,n.jsx)(T.ty,{asChild:!0,children:(0,n.jsx)(E.$,{type:"default",className:"px-1",icon:(0,n.jsx)(m.A,{})})}),(0,n.jsxs)(T.SQ,{side:"bottom",align:"end",className:"w-32",children:[(0,n.jsxs)(L.m_,{children:[(0,n.jsx)(L.k$,{children:(0,n.jsxs)(T._2,{disabled:!Z,onClick:()=>D(e),className:"space-x-2",children:[(0,n.jsx)(x.A,{size:12}),(0,n.jsx)("p",{children:"Edit column"})]})}),!Z&&(0,n.jsx)(L.ZI,{side:"bottom",children:"Additional permissions required to edit column"})]}),(0,n.jsxs)(L.m_,{children:[(0,n.jsx)(L.k$,{children:(0,n.jsxs)(T._2,{disabled:!Z||Q,onClick:()=>P(e),className:"space-x-2",children:[(0,n.jsx)(h.A,{stroke:"red",size:12}),(0,n.jsx)("p",{children:"Delete column"})]})}),!Z&&(0,n.jsx)(L.ZI,{side:"bottom",children:"Additional permissions required to delete column"})]})]})]})})]},e.name))})})})]})};var F=s(88063),D=s(65880),P=s(72078),B=s(16939),M=s(14484),O=s(47504),V=s(4487),q=s(69879),$=s(17137),Y=s(56947),W=s(40807),H=s(33050);async function U(e,t){let{projectRef:s,connectionString:n,schema:a}=e;if(!s)throw Error("projectRef is required");let r=new Headers;n&&r.set("x-connection-encrypted",n);let{data:l,error:i}=await (0,W.Jt)("/platform/pg-meta/{ref}/foreign-tables",{params:{header:{"x-connection-encrypted":n},path:{ref:s},query:{included_schemas:a||"",include_columns:!0}},headers:r,signal:t});return i&&(0,W.H4)(i),l}let J=function(e){let{projectRef:t,connectionString:s,schema:n}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,Y.I)(n?H.x.listBySchema(t,n):H.x.list(t),e=>{let{signal:a}=e;return U({projectRef:t,connectionString:s,schema:n},a)},{enabled:a&&void 0!==t,...r})},G={list:e=>["projects",e,"materializedViews"],listBySchema:(e,t)=>[...G.list(e),t]};async function K(e,t){let{projectRef:s,connectionString:n,schema:a}=e;if(!s)throw Error("projectRef is required");let r=new Headers;n&&r.set("x-connection-encrypted",n);let{data:l,error:i}=await (0,W.Jt)("/platform/pg-meta/{ref}/materialized-views",{params:{header:{"x-connection-encrypted":n},path:{ref:s},query:{included_schemas:a||"",include_columns:!0}},headers:r,signal:t});return i&&(0,W.H4)(i),l}let Q=function(e){let{projectRef:t,connectionString:s,schema:n}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,Y.I)(n?G.listBySchema(t,n):G.list(t),e=>{let{signal:a}=e;return K({projectRef:t,connectionString:s,schema:n},a)},{enabled:a&&void 0!==t,staleTime:0,...r})};var Z=s(44914),X=s(61607),ee=s(48660);async function et(e,t){let{projectRef:s,connectionString:n,schema:a}=e;if(!s)throw Error("projectRef is required");let r=new Headers;n&&r.set("x-connection-encrypted",n);let{data:l,error:i}=await (0,W.Jt)("/platform/pg-meta/{ref}/views",{params:{header:{"x-connection-encrypted":n},path:{ref:s},query:{included_schemas:a||""}},headers:r,signal:t});return i&&(0,W.H4)(i),l}let es=function(e){let{projectRef:t,connectionString:s,schema:n}=e,{enabled:a=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,Y.I)(n?ee.k.listBySchema(t,n):ee.k.list(t),e=>{let{signal:a}=e;return et({projectRef:t,connectionString:s,schema:n},a)},{enabled:a&&void 0!==t,staleTime:0,...r})};var en=s(25321),ea=s(95793),er=s(9093),el=s(97380),ei=s(51859);let eo=e=>{let{tables:t=[],views:s=[],materializedViews:n=[],foreignTables:a=[]}=e,r=t.map(e=>{var t;return{...e,type:$.z.TABLE,rows:e.live_rows_estimate,columns:null!=(t=e.columns)?t:[]}}),l=s.map(e=>{var t;return{type:$.z.VIEW,id:e.id,name:e.name,comment:e.comment,rows:void 0,size:void 0,columns:null!=(t=e.columns)?t:[]}});return[...r,...l,...n.map(e=>{var t;return{type:$.z.MATERIALIZED_VIEW,id:e.id,name:e.name,comment:e.comment,rows:void 0,size:void 0,columns:null!=(t=e.columns)?t:[]}}),...a.map(e=>{var t;return{type:$.z.FOREIGN_TABLE,id:e.id,name:e.name,comment:e.comment,rows:void 0,size:void 0,columns:null!=(t=e.columns)?t:[]}})].sort((e,t)=>e.name.localeCompare(t.name))},ec=e=>{let{onDuplicateTable:t,onAddTable:s=l(),onEditTable:r=l(),onDeleteTable:i=l()}=e,p=(0,O.useRouter)(),{ref:v}=(0,j.g)(),{project:A}=(0,g.Om)(),C=(0,Z.li)(),{selectedSchema:I,setSelectedSchema:Y}=(0,en.k)(),[W,H]=(0,y.useState)(""),[U,G]=(0,y.useState)(Object.values($.z)),K=(0,_.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"tables"),{data:ee,error:et,isError:ec,isLoading:ed,isSuccess:eu}=(0,X.LW)({projectRef:null==A?void 0:A.ref,connectionString:null==A?void 0:A.connectionString,schema:I,sortByProperty:"name",includeColumns:!0},{select:e=>0===W.length?e:e.filter(e=>e.name.toLowerCase().includes(W.toLowerCase()))}),{data:em,error:ex,isError:eh,isLoading:ep,isSuccess:ef}=es({projectRef:null==A?void 0:A.ref,connectionString:null==A?void 0:A.connectionString,schema:I},{select:e=>0===W.length?e:e.filter(e=>e.name.toLowerCase().includes(W.toLowerCase()))}),{data:ey,error:ej,isError:eg,isLoading:ev,isSuccess:eb}=Q({projectRef:null==A?void 0:A.ref,connectionString:null==A?void 0:A.connectionString,schema:I},{select:e=>0===W.length?e:e.filter(e=>e.name.toLowerCase().includes(W.toLowerCase()))}),{data:eN,error:ew,isError:eS,isLoading:eA,isSuccess:eC}=J({projectRef:null==A?void 0:A.ref,connectionString:null==A?void 0:A.connectionString,schema:I},{select:e=>0===W.length?e:e.filter(e=>e.name.toLowerCase().includes(W.toLowerCase()))}),{data:e_}=(0,q._)({projectRef:null==A?void 0:A.ref,connectionString:null==A?void 0:A.connectionString}),ek=(null!=e_?e_:[]).find(e=>"supabase_realtime"===e.name),eE=eo({tables:ee,views:em,materializedViews:ey,foreignTables:eN}).filter(e=>U.includes(e.type)),eR=k.i.includes(I),eT=e=>{var t,s,n,a;return null==(a=Object.entries($.z).find(t=>{let[,s]=t;return s===e}))||null==(n=a[0])||null==(s=n.toLowerCase())||null==(t=s.split("_"))?void 0:t.join(" ")};return(0,n.jsxs)("div",{className:"flex flex-col gap-y-4","data-sentry-component":"TableList","data-sentry-source-file":"TableList.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2 flex-wrap",children:[(0,n.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,n.jsx)(V.A,{className:"flex-grow lg:flex-grow-0 w-[180px]",size:"tiny",showError:!1,selectedSchemaName:I,onSelectSchema:Y,"data-sentry-element":"SchemaSelector","data-sentry-source-file":"TableList.tsx"}),(0,n.jsxs)(ea.AM,{"data-sentry-element":"Popover_Shadcn_","data-sentry-source-file":"TableList.tsx",children:[(0,n.jsx)(ea.Wv,{asChild:!0,"data-sentry-element":"PopoverTrigger_Shadcn_","data-sentry-source-file":"TableList.tsx",children:(0,n.jsx)(E.$,{size:"tiny",type:5!==U.length?"default":"dashed",className:"px-1",icon:(0,n.jsx)(F.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"TableList.tsx"})}),(0,n.jsx)(ea.hl,{className:"p-0 w-56",side:"bottom",align:"center",portal:!0,"data-sentry-element":"PopoverContent_Shadcn_","data-sentry-source-file":"TableList.tsx",children:(0,n.jsxs)("div",{className:"px-3 pt-3 pb-2 flex flex-col gap-y-2",children:[(0,n.jsx)("p",{className:"text-xs",children:"Show entity types"}),(0,n.jsx)("div",{className:"flex flex-col",children:Object.entries($.z).map(e=>{let[t,s]=e;return(0,n.jsxs)("div",{className:"group flex items-center justify-between py-0.5",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(er.S,{id:t,name:t,checked:U.includes(s),onCheckedChange:()=>{U.includes(s)?G(U.filter(e=>e!==s)):G(U.concat([s]))}}),(0,n.jsx)(el.J,{htmlFor:t,className:"capitalize text-xs",children:t.toLowerCase().replace("_"," ")})]}),(0,n.jsx)(E.$,{size:"tiny",type:"default",onClick:()=>G([s]),className:"transition opacity-0 group-hover:opacity-100 h-auto px-1 py-0.5",children:"Select only"})]},t)})})]})})]})]}),(0,n.jsxs)("div",{className:"flex flex-grow justify-between gap-2 items-center",children:[(0,n.jsx)(R.A,{size:"tiny",className:"flex-grow lg:flex-grow-0 w-52",placeholder:"Search for a table",value:W,onChange:e=>H(e.target.value),icon:(0,n.jsx)(o.A,{size:12}),"data-sentry-element":"Input","data-sentry-source-file":"TableList.tsx"}),!eR&&(0,n.jsx)(w.G,{className:"w-auto ml-auto",icon:(0,n.jsx)(c.A,{}),disabled:!K,onClick:()=>s(),tooltip:{content:{side:"bottom",text:K?void 0:"You need additional permissions to create tables"}},children:"New table"})]})]}),eR&&(0,n.jsx)(z.A,{schema:I,entity:"tables"}),(ed||ep||ev||eA)&&(0,n.jsx)(S.y,{}),(ec||eh||eg||eS)&&(0,n.jsx)(N.A,{error:et||ex||ej||ew,subject:"Failed to retrieve tables"}),eu&&ef&&eb&&eC&&(0,n.jsx)("div",{className:"w-full",children:(0,n.jsx)(b.A,{head:[(0,n.jsx)(b.A.th,{className:"!px-0"},"icon"),(0,n.jsx)(b.A.th,{children:"Name"},"name"),(0,n.jsx)(b.A.th,{className:"hidden lg:table-cell",children:"Description"},"description"),(0,n.jsx)(b.A.th,{className:"hidden text-right xl:table-cell",children:"Rows (Estimated)"},"rows"),(0,n.jsx)(b.A.th,{className:"hidden text-right xl:table-cell",children:"Size (Estimated)"},"size"),(0,n.jsx)(b.A.th,{className:"hidden xl:table-cell text-center",children:"Realtime Enabled"},"realtime"),(0,n.jsx)(b.A.th,{},"buttons")],body:(0,n.jsxs)(n.Fragment,{children:[0===eE.length&&0===W.length&&(0,n.jsx)(b.A.tr,{children:(0,n.jsx)(b.A.td,{colSpan:7,children:0===U.length?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"Please select at least one entity type to filter with"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"There are currently no results based on the filter that you have applied"})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No tables created yet"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["There are no"," ",5===U.length?"tables":1===U.length?"".concat(eT(U[0]),"s"):"".concat(U.slice(0,-1).map(e=>"".concat(eT(e),"s")).join(", "),", and ").concat(eT(U[U.length-1]),"s")," ",'found in the schema "',I,'"']})]})})},I),0===eE.length&&W.length>0&&(0,n.jsx)(b.A.tr,{children:(0,n.jsxs)(b.A.td,{colSpan:7,children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',W,'" did not return any results']})]})},I),eE.length>0&&eE.map(e=>{var s,a,l,o;return(0,n.jsxs)(b.A.tr,{children:[(0,n.jsx)(b.A.td,{className:"!pl-5 !pr-1",children:(0,n.jsxs)(L.m_,{children:[(0,n.jsx)(L.k$,{asChild:!0,children:e.type===$.z.TABLE?(0,n.jsx)(D.A,{size:15,strokeWidth:1.5,className:"text-foreground-lighter"}):e.type===$.z.VIEW?(0,n.jsx)(P.A,{size:15,strokeWidth:1.5,className:"text-foreground-lighter"}):(0,n.jsx)("div",{className:(0,ei.cn)("flex items-center justify-center text-xs h-4 w-4 rounded-[2px] font-bold",e.type===$.z.FOREIGN_TABLE&&"text-yellow-900 bg-yellow-500",e.type===$.z.MATERIALIZED_VIEW&&"text-purple-1000 bg-purple-500"),children:null==(l=Object.entries($.z).find(t=>{let[,s]=t;return s===e.type}))||null==(a=l[0])||null==(s=a[0])?void 0:s.toUpperCase()})}),(0,n.jsx)(L.ZI,{side:"bottom",className:"capitalize",children:eT(e.type)})]})}),(0,n.jsx)(b.A.td,{children:e.name.length>20?(0,n.jsxs)(L.m_,{disableHoverableContent:!0,children:[(0,n.jsx)(L.k$,{asChild:!0,className:"max-w-[95%] overflow-hidden text-ellipsis whitespace-nowrap",children:(0,n.jsx)("p",{children:e.name})}),(0,n.jsx)(L.ZI,{side:"bottom",children:e.name})]}):(0,n.jsx)("p",{children:e.name})}),(0,n.jsx)(b.A.td,{className:"hidden lg:table-cell ",children:null!==e.comment?(0,n.jsx)("span",{className:"lg:max-w-48 truncate inline-block",title:e.comment,children:e.comment}):(0,n.jsx)("p",{className:"text-border-stronger",children:"No description"})}),(0,n.jsx)(b.A.td,{className:"hidden text-right xl:table-cell",children:void 0!==e.rows?e.rows.toLocaleString():"-"}),(0,n.jsx)(b.A.td,{className:"hidden text-right xl:table-cell",children:void 0!==e.size?(0,n.jsx)("code",{className:"text-xs",children:e.size}):"-"}),(0,n.jsx)(b.A.td,{className:"hidden xl:table-cell text-center",children:(null!=(o=null==ek?void 0:ek.tables)?o:[]).find(t=>t.id===e.id)?(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)(d.A,{size:18,strokeWidth:2,className:"text-brand"})}):(0,n.jsx)("div",{className:"flex justify-center",children:(0,n.jsx)(u.A,{size:18,strokeWidth:2,className:"text-foreground-lighter"})})}),(0,n.jsx)(b.A.td,{children:(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(E.$,{asChild:!0,type:"default",iconRight:(0,n.jsx)(B.A,{size:14,className:"text-foreground-light"}),className:"whitespace-nowrap hover:border-muted",style:{paddingTop:3,paddingBottom:3},children:(0,n.jsxs)(f(),{href:"/project/".concat(v,"/database/tables/").concat(e.id),children:[e.columns.length," columns"]})}),!eR&&(0,n.jsxs)(T.rI,{children:[(0,n.jsx)(T.ty,{asChild:!0,children:(0,n.jsx)(E.$,{type:"default",className:"px-1",icon:(0,n.jsx)(m.A,{})})}),(0,n.jsxs)(T.SQ,{side:"bottom",align:"end",className:"w-40",children:[(0,n.jsxs)(T._2,{className:"flex items-center space-x-2",onClick:()=>p.push("/project/".concat(null==A?void 0:A.ref,"/editor/").concat(e.id)),onMouseEnter:()=>C({id:e.id?String(e.id):void 0}),children:[(0,n.jsx)(P.A,{size:12}),(0,n.jsx)("p",{children:"View in Table Editor"})]}),e.type===$.z.TABLE&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(T.mB,{}),(0,n.jsxs)(L.m_,{children:[(0,n.jsx)(L.k$,{asChild:!0,children:(0,n.jsxs)(T._2,{className:"!pointer-events-auto gap-x-2",disabled:!K,onClick:()=>{K&&r(e)},children:[(0,n.jsx)(x.A,{size:12}),(0,n.jsx)("p",{children:"Edit table"})]})}),!K&&(0,n.jsx)(L.ZI,{side:"left",children:"You need additional permissions to edit this table"})]}),(0,n.jsxs)(T._2,{className:"space-x-2",onClick:s=>{s.stopPropagation(),K&&t(e)},children:[(0,n.jsx)(M.A,{size:12}),(0,n.jsx)("span",{children:"Duplicate Table"})]},"duplicate-table"),(0,n.jsxs)(L.m_,{children:[(0,n.jsx)(L.k$,{asChild:!0,children:(0,n.jsxs)(T._2,{disabled:!K||eR,className:"!pointer-events-auto gap-x-2",onClick:()=>{K&&!eR&&i({...e,schema:I})},children:[(0,n.jsx)(h.A,{stroke:"red",size:12}),(0,n.jsx)("p",{children:"Delete table"})]})}),!K&&(0,n.jsx)(L.ZI,{side:"left",children:"You need additional permissions to delete tables"})]})]})]})]})]})})]},e.id)})]})})})]})};var ed=s(53667),eu=s.n(ed),em=s(14506),ex=s.n(em),eh=s(24198),ep=s(88767),ef=s(96485),ey=s(26366),ej=s(65863),eg=s(32981),ev=s(87494),eb=s(73969),eN=s(39353),ew=s(95268),eS=s(45874),eA=s(32144),eC=s(80251),e_=s(96557);async function ek(e){let{projectRef:t,connectionString:s,payload:n}=e,a=eS.A.roles.create(n).sql,{result:r}=await (0,e_.E)({projectRef:t,connectionString:s,sql:a,queryKey:["roles","create"]});return r}let eE=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>ek(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await (0,ef.tV)(n,r),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to create database role: ".concat(e.message)):t(e,s,n)},...s})};var eR=s(35212),eT=s(57980),eL=s(24794),ez=s(91378),eI=s(18398);let eF=eN.Ay.object({name:eN.Ay.string().trim().min(1,"You must provide a name").default(""),isSuperuser:eN.Ay.boolean().default(!1),canLogin:eN.Ay.boolean().default(!1),canCreateRole:eN.Ay.boolean().default(!1),canCreateDb:eN.Ay.boolean().default(!1),isReplicationRole:eN.Ay.boolean().default(!1),canBypassRls:eN.Ay.boolean().default(!1)}),eD={name:"",isSuperuser:!1,canLogin:!1,canCreateRole:!1,canCreateDb:!1,isReplicationRole:!1,canBypassRls:!1},eP=e=>{let{visible:t,onClose:s}=e,a="create-new-role",{project:r}=(0,g.Om)(),l=(0,ev.mN)({resolver:(0,eg.u)(eF)}),{mutate:i,isLoading:o}=eE({onSuccess:(e,t)=>{eb.oR.success("Successfully created new role: ".concat(t.payload.name)),d()}}),c=async e=>{if(!r)return console.error("Project is required");i({projectRef:r.ref,connectionString:r.connectionString,payload:e})},d=()=>{s(),l.reset(eD)};return(0,n.jsx)(eR.Ay,{size:"large",visible:t,header:"Create a new role",className:"mr-0 transform transition-all duration-300 ease-in-out",loading:!1,onCancel:d,customFooter:(0,n.jsx)("div",{className:"flex w-full justify-end space-x-3 border-t border-default px-3 py-4",children:(0,n.jsx)(ew.I,{form:a,isSubmitting:o,hasChanges:l.formState.isDirty,handleReset:d})}),"data-sentry-element":"SidePanel","data-sentry-component":"CreateRolePanel","data-sentry-source-file":"CreateRolePanel.tsx",children:(0,n.jsx)(eT.lV,{...l,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateRolePanel.tsx",children:(0,n.jsxs)("form",{id:a,className:"grid gap-6 w-full px-8 py-8",onSubmit:l.handleSubmit(c),children:[(0,n.jsx)(eT.zB,{control:l.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,n.jsx)(eT.lR,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light",children:"Name"}),(0,n.jsx)(eT.MJ,{className:"col-span-8",children:(0,n.jsx)(eL.p,{...t,className:"w-full"})}),(0,n.jsx)(eT.C5,{className:"col-start-5 col-span-8"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateRolePanel.tsx"}),(0,n.jsxs)("div",{className:"grid gap-2 mt-4 md:grid md:grid-cols-12",children:[(0,n.jsx)("div",{className:"col-span-4",children:(0,n.jsx)(eT.lR,{className:"flex flex-col space-y-2 col-span-4 text-sm justify-center text-foreground-light","data-sentry-element":"FormLabel_Shadcn_","data-sentry-source-file":"CreateRolePanel.tsx",children:"Role privileges"})}),(0,n.jsxs)("div",{className:"col-span-8 grid gap-4",children:[Object.keys(eI.mV).filter(e=>eI.mV[e].grant_by_dashboard).map(e=>{let t=eI.mV[e];return(0,n.jsx)(eT.zB,{control:l.control,name:e,render:e=>{let{field:s}=e;return(0,n.jsxs)(eT.eI,{className:"grid gap-2 md:grid md:grid-cols-12 space-y-0",children:[(0,n.jsx)(eT.MJ,{className:"col-span-8 flex items-center gap-4",children:(0,n.jsxs)("div",{className:"w-full text-sm",children:[(0,n.jsx)(ez.d,{checked:s.value,onCheckedChange:s.onChange}),(0,n.jsx)(eT.lR,{children:t.description})]})}),(0,n.jsx)(eT.C5,{className:"col-start-5 col-span-8"})]})}},e)}),(0,n.jsx)(eR.Ay.Separator,{"data-sentry-element":"unknown","data-sentry-source-file":"CreateRolePanel.tsx"}),(0,n.jsxs)("div",{className:"grid gap-4",children:[(0,n.jsx)("p",{className:"text-sm",children:"These privileges cannot be granted via the Dashboard:"}),Object.keys(eI.mV).filter(e=>!eI.mV[e].grant_by_dashboard).map(e=>{let t=eI.mV[e];return(0,n.jsx)(eT.zB,{control:l.control,name:e,render:e=>{let{field:s}=e;return(0,n.jsxs)(eT.eI,{className:"space-y-0 opacity-70",children:[(0,n.jsx)(eT.MJ,{className:"flex items-center gap-4",children:(0,n.jsxs)("div",{className:"w-full text-sm",children:[(0,n.jsx)(ez.d,{checked:s.value,onCheckedChange:s.onChange,disabled:!0,"aria-readonly":!0}),(0,n.jsx)(eT.lR,{children:t.description})]})}),(0,n.jsx)(eT.C5,{className:"col-start-5 col-span-8"})]})}},e)})]})]})]})]})})})};var eB=s(67920);async function eM(e){let{projectRef:t,connectionString:s,id:n,payload:a}=e,r=eS.A.roles.remove({id:n},a).sql,{result:l}=await (0,e_.E)({projectRef:t,connectionString:s,sql:r,queryKey:["roles","delete"]});return l}let eO=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>eM(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await (0,ef.tV)(n,r),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to delete database role: ".concat(e.message)):t(e,s,n)},...s})},eV=e=>{let{role:t,visible:s,onClose:a}=e,{project:r}=(0,g.Om)(),{mutate:l,isLoading:i}=eO({onSuccess:()=>{eb.oR.success("Successfully deleted role: ".concat(t.name)),a()}}),o=async()=>r?t?void l({projectRef:r.ref,connectionString:r.connectionString,id:t.id}):console.error("Failed to delete role: role is missing"):console.error("Project is required");return(0,n.jsx)(eB.A,{size:"small",alignFooter:"right",visible:s,onCancel:a,onConfirm:o,header:(0,n.jsxs)("h3",{children:['Confirm to delete role "',null==t?void 0:t.name,'"']}),loading:i,"data-sentry-element":"Modal","data-sentry-component":"DeleteRoleModal","data-sentry-source-file":"DeleteRoleModal.tsx",children:(0,n.jsx)(eB.A.Content,{"data-sentry-element":"unknown","data-sentry-source-file":"DeleteRoleModal.tsx",children:(0,n.jsx)("p",{className:"text-sm",children:"This will automatically revoke any membership of this role in other roles, and this action cannot be undone."})})})};var eq=s(66586),e$=s(30472),eY=s(10482);async function eW(e){let{projectRef:t,connectionString:s,id:n,payload:a}=e,r=eS.A.roles.update({id:n},a).sql,{result:l}=await (0,e_.E)({projectRef:t,connectionString:s,sql:r,queryKey:["roles","update"]});return l}let eH=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>eW(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await (0,ef.tV)(n,r),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to update database role: ".concat(e.message)):t(e,s,n)},...s})};var eU=s(84294),eJ=s(87959);let eG=e=>{let{role:t,disabled:s=!1,onSelectDelete:a}=e,{project:r}=(0,g.Om)(),[l,i]=(0,y.useState)(!1),{mutate:o,isLoading:c}=eH(),{isSuperuser:d,canLogin:u,canCreateRole:x,canCreateDb:p,isReplicationRole:f,canBypassRls:j}=t,v=async(e,s)=>{let{resetForm:n}=s;if(!r)return console.error("Project is required");let a=Object.fromEntries(Object.entries(e).filter(e=>{let[s,n]=e;return n!==t[s]}));o({projectRef:r.ref,connectionString:r.connectionString,id:t.id,payload:a},{onSuccess:()=>{eb.oR.success('Successfully updated role "'.concat(t.name,'"')),n({values:{...e},initialValues:{...e}})}})};return(0,n.jsx)(eq.A,{name:"role-update-form",initialValues:{isSuperuser:d,canLogin:u,canCreateRole:x,canCreateDb:p,isReplicationRole:f,canBypassRls:j},onSubmit:v,className:(0,ei.cn)("bg-surface-100","hover:bg-overlay-hover","data-open:bg-selection","border-default hover:border-strong","data-open:border-strong","data-open:pb-px col-span-12 mx-auto","-space-y-px overflow-hidden","border border-t-0 first:border-t first:!mt-0 hover:border-t hover:-mt-[1px] shadow transition hover:z-50","first:rounded-tl first:rounded-tr","last:rounded-bl last:rounded-br"),"data-sentry-element":"Form","data-sentry-component":"RoleRow","data-sentry-source-file":"RoleRow.tsx",children:e=>{let{values:r,initialValues:o,handleReset:d}=e,u=JSON.stringify(r)!==JSON.stringify(o);return(0,n.jsxs)(e$.Ay,{open:l,children:[(0,n.jsx)(e$.Ay.Trigger,{asChild:!0,children:(0,n.jsxs)("button",{id:"collapsible-trigger",type:"button",className:"group flex w-full items-center justify-between rounded py-3 px-4 md:px-6 text-foreground",onClick:e=>{"collapsible-trigger"===e.target.id&&i(!l)},children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)(eU.A,{id:"collapsible-trigger",className:"text-border-stronger transition data-open-parent:rotate-0 data-closed-parent:rotate-180",strokeWidth:2,width:14}),(0,n.jsxs)("div",{className:"space-x-2 flex items-center",children:[(0,n.jsx)("p",{className:"text-left text-sm",id:"collapsible-trigger",children:t.name}),(0,n.jsxs)("p",{className:"text-left text-sm text-foreground-light",id:"collapsible-trigger",children:["(ID: ",t.id,")"]})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[t.activeConnections>0&&(0,n.jsx)("div",{className:"relative h-2 w-2",children:(0,n.jsxs)("span",{className:"flex h-2 w-2",children:[(0,n.jsx)("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-brand opacity-75"}),(0,n.jsx)("span",{className:"relative inline-flex h-2 w-2 rounded-full bg-brand opacity-75"})]})}),(0,n.jsxs)("p",{id:"collapsible-trigger",className:"text-sm ".concat(t.activeConnections>0?"text-foreground":"text-foreground-light"),children:[t.activeConnections," connections"]}),!s&&(0,n.jsxs)(T.rI,{children:[(0,n.jsx)(T.ty,{asChild:!0,children:(0,n.jsx)(E.$,{type:"default",className:"px-1",icon:(0,n.jsx)(m.A,{})})}),(0,n.jsx)(T.SQ,{side:"bottom",className:"w-[120px]",children:(0,n.jsxs)(T._2,{className:"space-x-2",onClick:e=>{e.stopPropagation(),a(t)},children:[(0,n.jsx)(h.A,{className:"text-red-800",size:"14",strokeWidth:2}),(0,n.jsx)("p",{children:"Delete"})]})})]})]})]})}),(0,n.jsx)(e$.Ay.Content,{children:(0,n.jsxs)("div",{className:"group border-t border-default bg-surface-100 py-6 px-5 md:px-20 text-foreground",children:[(0,n.jsx)("div",{className:"py-4 space-y-[9px]",children:Object.keys(eI.mV).map(e=>(0,n.jsx)(eY.A,{size:"small",id:e,name:e,label:eI.mV[e].description,disabled:s||eI.mV[e].disabled,className:["roles-toggle",s||eI.mV[e].disabled?"[&>div>button]:opacity-30 [&>div>label]:text-foreground-lighter":""].join(" "),afterLabel:!s&&eI.mV[e].disabled&&(0,n.jsxs)(L.m_,{children:[(0,n.jsx)(L.k$,{children:(0,n.jsx)(eJ.A,{size:"14",strokeWidth:2,className:"ml-2 relative top-[3px]"})}),(0,n.jsx)(L.ZI,{side:"bottom",children:"This privilege cannot be updated via the dashboard"})]})},e))}),!s&&(0,n.jsxs)("div",{className:"py-4 flex items-center space-x-2 justify-end",children:[(0,n.jsx)(E.$,{type:"default",disabled:!u||c,onClick:()=>d(),children:"Cancel"}),(0,n.jsx)(E.$,{type:"primary",htmlType:"submit",disabled:!u||c,loading:c,children:"Save"})]})]})})]})}})},eK=e=>{let{index:t}=e;return(0,n.jsx)("div",{className:(0,ei.cn)(["bg-surface-100","data-open:bg-selection","border-default","data-open:border-strong","data-open:pb-px col-span-12 mx-auto","-space-y-px overflow-hidden","border border-t-0 first:border-t first:!mt-0 shadow transition","first:rounded-tl first:rounded-tr","last:rounded-bl last:rounded-br"]),"data-sentry-component":"RoleRowSkeleton","data-sentry-source-file":"RoleRowSkeleton.tsx",children:(0,n.jsxs)("div",{className:"flex w-full items-center justify-between rounded py-3 px-6 text-foreground",children:[(0,n.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,n.jsx)(eU.A,{id:"collapsible-trigger",className:"text-border-stronger rotate-180",strokeWidth:2,width:14,"data-sentry-element":"ChevronUp","data-sentry-source-file":"RoleRowSkeleton.tsx"}),(0,n.jsxs)("div",{className:"space-x-2 flex items-center",children:[(0,n.jsx)(S.A,{className:"h-4 w-20 py-0 my-0.5",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"RoleRowSkeleton.tsx"}),(0,n.jsx)(S.A,{className:"h-4 w-16 py-0 my-0.5",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"RoleRowSkeleton.tsx"})]})]}),(0,n.jsx)(S.A,{className:"h-4 w-[90px] py-0 my-0.5",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"RoleRowSkeleton.tsx"})]})})},eQ=()=>{let{project:e}=(0,g.Om)(),[t,s]=(0,y.useState)(""),[r,l]=(0,y.useState)("all"),[i,d]=(0,y.useState)(!1),[m,x]=(0,y.useState)(),h=(0,_.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"roles"),{data:p}=(0,ey.Dt)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),f=null==p?void 0:p.maxConnections,{data:j,isLoading:v}=(0,ef._X)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),b=ex()(null!=j?j:[],e=>e.name.toLocaleLowerCase()),N=("active"===r?b.filter(e=>e.activeConnections>0):b).filter(e=>e.name.includes(t)),[S,A]=eu()(N,e=>eI.Fg.includes(e.name)),C=b.map(e=>e.activeConnections).reduce((e,t)=>e+t,0),k=ex()(b.filter(e=>e.activeConnections>0),e=>-e.activeConnections);return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"mb-4 flex items-center justify-between gap-2 flex-wrap",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,n.jsx)(R.A,{size:"tiny",className:"w-52",placeholder:"Search for a role",icon:(0,n.jsx)(o.A,{size:12}),value:t,onChange:e=>s(e.target.value),actions:t&&(0,n.jsx)(E.$,{size:"tiny",type:"text",onClick:()=>s(""),className:"px-1 mr-1",children:(0,n.jsx)(u.A,{size:12,strokeWidth:2})}),"data-sentry-element":"Input","data-sentry-source-file":"RolesList.tsx"}),(0,n.jsxs)("div",{className:"flex items-center border border-strong rounded-full w-min h-[26px]",children:[(0,n.jsx)("button",{className:["text-xs w-[80px] h-full text-center rounded-l-full flex items-center justify-center transition","all"===r?"bg-overlay-hover text-foreground":"hover:bg-surface-200 text-foreground-light"].join(" "),onClick:()=>l("all"),children:"All roles"}),(0,n.jsx)("div",{className:"h-full w-[1px] border-r border-strong"}),(0,n.jsx)("button",{className:["text-xs w-[80px] h-full text-center rounded-r-full flex items-center justify-center transition","active"===r?"bg-overlay-hover text-foreground":"hover:bg-surface-200 text-foreground-light"].join(" "),onClick:()=>l("active"),children:"Active roles"})]})]}),(0,n.jsxs)("div",{className:"flex items-center space-x-6",children:[(0,n.jsxs)(L.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"RolesList.tsx",children:[(0,n.jsx)(L.k$,{"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"RolesList.tsx",children:(0,n.jsx)("div",{className:"w-42",children:(0,n.jsx)(ep.A,{type:"horizontal",max:f||C,value:C,barClass:0===f||void 0===f?"bg-foreground":C>.9*f?"bg-destructive":C>.75*f?"bg-warning":void 0,labelTop:Number.isInteger(f)?"".concat(C,"/").concat(f):"".concat(C),labelTopClass:"text-xs",labelBottom:"Active connections",labelBottomClass:"text-xs","data-sentry-element":"SparkBar","data-sentry-source-file":"RolesList.tsx"})})}),(0,n.jsxs)(L.ZI,{align:"start",side:"bottom",className:"space-y-1","data-sentry-element":"TooltipContent","data-sentry-source-file":"RolesList.tsx",children:[(0,n.jsx)("p",{className:"text-foreground-light pr-2",children:"Connections by roles:"}),k.map(e=>(0,n.jsxs)("div",{children:[e.name,": ",e.activeConnections]},e.id))]})]}),(0,n.jsx)(w.G,{type:"primary",disabled:!h,icon:(0,n.jsx)(c.A,{size:12}),onClick:()=>d(!0),tooltip:{content:{side:"bottom",text:h?void 0:"You need additional permissions to add a new role"}},"data-sentry-element":"ButtonTooltip","data-sentry-source-file":"RolesList.tsx",children:"Add role"})]})]}),(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("div",{className:"bg-surface-100 border border-default px-4 md:px-6 py-3 rounded-t flex items-center space-x-4",children:[(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Roles managed by Supabase"}),(0,n.jsx)(ej.E,{variant:"brand","data-sentry-element":"Badge","data-sentry-source-file":"RolesList.tsx",children:"Protected"})]}),v?Array.from({length:5}).map((e,t)=>(0,n.jsx)(eK,{index:t},t)):S.map(e=>(0,n.jsx)(eG,{disabled:!0,role:e,onSelectDelete:x},e.id))]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:"bg-surface-100 border border-default px-4 md:px-6 py-3 rounded-t",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Other database roles"})}),v?Array.from({length:3}).map((e,t)=>(0,n.jsx)(eK,{index:t},t)):A.map(e=>(0,n.jsx)(eG,{disabled:!h,role:e,onSelectDelete:x},e.id))]})]}),t.length>0&&0===N.length&&(0,n.jsx)(eh.A,{searchString:t,onResetFilter:()=>s("")}),(0,n.jsx)(eP,{visible:i,onClose:()=>d(!1),"data-sentry-element":"CreateRolePanel","data-sentry-source-file":"RolesList.tsx"}),(0,n.jsx)(eV,{role:m,visible:void 0!==m,onClose:()=>x(void 0),"data-sentry-element":"DeleteRoleModal","data-sentry-source-file":"RolesList.tsx"})]})};var eZ=s(70350),eX=s.n(eZ),e0=s(55866),e1=s(23992),e2=s(72256),e4=s(89771),e5=s(94555);let e3=e=>{let{index:t=0}=e;return(0,n.jsxs)("div",{className:"flex border-overlay flex-col overflow-hidden rounded border shadow-sm","data-sentry-component":"ExtensionCardSkeleton","data-sentry-source-file":"ExtensionCardSkeleton.tsx",children:[(0,n.jsxs)("div",{className:"border-overlay bg-surface-100 flex justify-between w-full border-b py-3 px-4",children:[(0,n.jsx)("div",{className:"flex items-center gap-1 max-w-[85%]",children:(0,n.jsx)("div",{className:"flex items-center space-x-2 truncate",children:(0,n.jsx)(S.A,{className:"h-5 w-32 m-0 text-foreground",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"ExtensionCardSkeleton.tsx"})})}),(0,n.jsx)(eY.A,{size:"tiny",checked:!1,disabled:!0,"data-sentry-element":"Toggle","data-sentry-source-file":"ExtensionCardSkeleton.tsx"})]}),(0,n.jsx)("div",{className:"bg-panel-header-light bg-panel-secondary-light flex h-full flex-col justify-between",children:(0,n.jsx)("div",{className:"py-3 px-4",children:(0,n.jsx)(S.A,{className:"h-4 w-48",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"ExtensionCardSkeleton.tsx"})})})]})};var e6=s(12204);let e8=()=>{let{filter:e}=(0,j.g)(),{project:t}=(0,g.Om)(),[s,r]=(0,y.useState)(""),{data:l,isLoading:i}=(0,e4.z)({projectRef:null==t?void 0:t.ref,connectionString:null==t?void 0:t.connectionString}),c=0===s.length?null!=l?l:[]:(null!=l?l:[]).filter(e=>{let t=e.name.toLowerCase().includes(s.toLowerCase()),n=(e6.hk[e.name]||[]).some(e=>e.includes(s.toLowerCase()));return t||n}),d=c.filter(e=>!e6.CM.includes(e.name)),[u,m]=eu()(d,e=>!eX()(e.installed_version)),x=(0,_.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"extensions"),h=(0,_.Lh)();return(0,y.useEffect)(()=>{void 0!==e&&r(e)},[e]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)(R.A,{size:"tiny",placeholder:"Search for an extension",value:s,onChange:e=>r(e.target.value),className:"w-52",icon:(0,n.jsx)(o.A,{size:14}),"data-sentry-element":"Input","data-sentry-source-file":"Extensions.tsx"}),(0,n.jsx)(e1.A,{href:"https://supabase.com/docs/guides/database/extensions","data-sentry-element":"DocsButton","data-sentry-source-file":"Extensions.tsx"})]})}),h&&!x&&(0,n.jsx)(e2.A,{icon:(0,n.jsx)(e0.A,{className:"text-foreground-light",size:18,strokeWidth:2}),title:"You need additional permissions to update database extensions"}),i?(0,n.jsx)("div",{className:"my-8 w-full space-y-12",children:(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)(S.A,{className:"h-[28px] w-40"}),(0,n.jsx)("div",{className:"mb-4 grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-3",children:Array.from({length:6}).map((e,t)=>(0,n.jsx)(e3,{index:t},t))})]})}):(0,n.jsxs)(n.Fragment,{children:[0===c.length&&(0,n.jsx)(eh.A,{searchString:s,onResetFilter:()=>r("")}),(0,n.jsxs)("div",{className:"my-8 w-full space-y-12",children:[u.length>0&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h4",{className:"text-lg",children:"Enabled extensions"}),(0,n.jsx)("div",{className:"mb-4 grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-3",children:u.map(e=>(0,n.jsx)(e5.A,{extension:e},e.name))})]}),m.length>0&&(0,n.jsxs)("div",{className:"space-y-4",children:[(0,n.jsx)("h4",{className:"text-lg",children:"Available extensions"}),(0,n.jsx)("div",{className:"mb-4 grid grid-cols-1 gap-3 md:grid-cols-2 xl:grid-cols-3",children:m.map(e=>(0,n.jsx)(e5.A,{extension:e},e.name))})]})]})]})]})};var e7=s(64540),e9=s(24652);let te=e=>{let{index:t}=e;return(0,n.jsxs)(b.A.tr,{className:"border-t","data-sentry-element":"unknown","data-sentry-component":"PublicationSkeleton","data-sentry-source-file":"PublicationSkeleton.tsx",children:[(0,n.jsx)(b.A.td,{className:"px-4 py-3",style:{width:"25%"},"data-sentry-element":"unknown","data-sentry-source-file":"PublicationSkeleton.tsx",children:(0,n.jsx)(S.A,{className:"h-4 w-24 my-0.5 p-0",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"PublicationSkeleton.tsx"})}),(0,n.jsx)(b.A.td,{className:"hidden lg:table-cell",style:{width:"25%"},"data-sentry-element":"unknown","data-sentry-source-file":"PublicationSkeleton.tsx",children:(0,n.jsx)(S.A,{className:"h-4 w-14 my-0.5 p-0",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"PublicationSkeleton.tsx"})}),Array.from({length:4}).map((e,t)=>(0,n.jsx)(b.A.td,{children:(0,n.jsx)(eY.A,{size:"tiny",checked:!1,disabled:!0})},t)),(0,n.jsx)(b.A.td,{className:"px-4 py-3 pr-2","data-sentry-element":"unknown","data-sentry-source-file":"PublicationSkeleton.tsx",children:(0,n.jsx)("div",{className:"flex justify-end",children:(0,n.jsx)(S.A,{className:"h-6 w-12 p-0",delayIndex:t,"data-sentry-element":"ShimmeringLoader","data-sentry-source-file":"PublicationSkeleton.tsx"})})})]})},tt=e=>{let{onSelectPublication:t=l()}=e,{project:s}=(0,g.Om)(),[r,i]=(0,y.useState)(""),{data:c,isLoading:d}=(0,q._)({projectRef:null==s?void 0:s.ref,connectionString:null==s?void 0:s.connectionString}),{mutate:u}=(0,e9.H)({onSuccess:()=>{eb.oR.success("Successfully updated event"),j(null)}}),m=(0,_.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"publications"),x=(0,_.Lh)(),h=[{event:"Insert",key:"publish_insert"},{event:"Update",key:"publish_update"},{event:"Delete",key:"publish_delete"},{event:"Truncate",key:"publish_truncate"}],p=0===r.length?null!=c?c:[]:(null!=c?c:[]).filter(e=>e.name.includes(r)),[f,j]=(0,y.useState)(null),v=async()=>{if(!f||!s)return;let{publication:e,event:t,currentStatus:n}=f,a={projectRef:s.ref,connectionString:s.connectionString,id:e.id};a["publish_".concat(t.event.toLowerCase())]=!n,u(a)};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(R.A,{size:"tiny",icon:(0,n.jsx)(o.A,{size:"14"}),placeholder:"Filter",value:r,onChange:e=>i(e.target.value),"data-sentry-element":"Input","data-sentry-source-file":"PublicationsList.tsx"})}),x&&!m&&(0,n.jsx)("div",{className:"w-[500px]",children:(0,n.jsx)(e2.A,{icon:(0,n.jsx)(e0.A,{className:"text-foreground-light",strokeWidth:2}),title:"You need additional permissions to update database publications"})})]})}),(0,n.jsx)("div",{className:"w-full overflow-hidden overflow-x-auto",children:(0,n.jsx)(b.A,{head:[(0,n.jsx)(b.A.th,{children:"Name"},"header.name"),(0,n.jsx)(b.A.th,{children:"System ID"},"header.id"),(0,n.jsx)(b.A.th,{children:"Insert"},"header.insert"),(0,n.jsx)(b.A.th,{children:"Update"},"header.update"),(0,n.jsx)(b.A.th,{children:"Delete"},"header.delete"),(0,n.jsx)(b.A.th,{children:"Truncate"},"header.truncate"),(0,n.jsx)(b.A.th,{className:"text-right",children:"Source"},"header.source")],body:d?Array.from({length:5}).map((e,t)=>(0,n.jsx)(te,{index:t},t)):p.map(e=>(0,n.jsxs)(b.A.tr,{className:"border-t",children:[(0,n.jsx)(b.A.td,{className:"px-4 py-3",children:e.name}),(0,n.jsx)(b.A.td,{children:e.id}),h.map(t=>(0,n.jsx)(b.A.td,{children:(0,n.jsx)(eY.A,{size:"tiny",checked:e[t.key],disabled:!m,onChange:()=>{j({publication:e,event:t,currentStatus:e[t.key]})}})},t.key)),(0,n.jsx)(b.A.td,{className:"px-4 py-3 pr-2",children:(0,n.jsx)("div",{className:"flex justify-end gap-2",children:(0,n.jsx)(E.$,{type:"default",style:{paddingTop:3,paddingBottom:3},onClick:()=>t(e.id),children:null==e.tables?"All tables":"".concat(e.tables.length," ").concat(e.tables.length>1||0==e.tables.length?"tables":"table")})})})]},e.name)),"data-sentry-element":"Table","data-sentry-source-file":"PublicationsList.tsx"})}),!d&&0===p.length&&(0,n.jsx)(eh.A,{searchString:r,onResetFilter:()=>i(""),className:"rounded-t-none border-t-0"}),(0,n.jsx)(e7.A,{visible:null!==f,title:"Confirm to toggle sending ".concat(null==f?void 0:f.event.event.toLowerCase()," events"),confirmLabel:"Confirm",confirmLabelLoading:"Updating",onCancel:()=>j(null),onConfirm:()=>{v()},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"PublicationsList.tsx",children:(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:["Are you sure you want to ",(null==f?void 0:f.currentStatus)?"stop":"start"," ","sending ",null==f?void 0:f.event.event.toLowerCase()," events for"," ",null==f?void 0:f.publication.name,"?"]})})]})};var ts=s(81794);let tn=e=>{var t;let{table:s,selectedPublication:r}=e,{project:l}=(0,g.Om)(),i=null==r.tables,[o,c]=(0,y.useState)((null==(t=r.tables)?void 0:t.find(e=>e.id==s.id))!=void 0),d=(0,_.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"publications"),{mutate:u,isLoading:m}=(0,e9.H)(),x=async(e,t)=>{var s;if(void 0===l)return console.error("Project is required");c(!o);let n=null!=(s=null==t?void 0:t.tables)?s:[],a=n.some(t=>t.id==e.id)?n.filter(t=>t.id!=e.id).map(e=>"".concat(e.schema,".").concat(e.name)):["".concat(e.schema,".").concat(e.name)].concat(n.map(e=>"".concat(e.schema,".").concat(e.name)));u({projectRef:null==l?void 0:l.ref,connectionString:null==l?void 0:l.connectionString,id:t.id,tables:a},{onSuccess:()=>{eb.oR.success("Successfully ".concat(o?"disabled":"enabled"," replication for ").concat(e.name))},onError:t=>{eb.oR.error("Failed to toggle replication for ".concat(e.name,": ").concat(t.message)),c(o)}})};return(0,n.jsxs)(b.A.tr,{"data-sentry-element":"unknown","data-sentry-component":"PublicationsTableItem","data-sentry-source-file":"PublicationsTableItem.tsx",children:[(0,n.jsx)(b.A.td,{className:"whitespace-nowrap","data-sentry-element":"unknown","data-sentry-source-file":"PublicationsTableItem.tsx",children:s.name}),(0,n.jsx)(b.A.td,{className:"whitespace-nowrap","data-sentry-element":"unknown","data-sentry-source-file":"PublicationsTableItem.tsx",children:s.schema}),(0,n.jsx)(b.A.td,{className:"hidden max-w-sm truncate whitespace-nowrap lg:table-cell","data-sentry-element":"unknown","data-sentry-source-file":"PublicationsTableItem.tsx",children:s.comment}),(0,n.jsx)(b.A.td,{className:"px-4 py-3 pr-2","data-sentry-element":"unknown","data-sentry-source-file":"PublicationsTableItem.tsx",children:(0,n.jsx)("div",{className:"flex justify-end gap-2",children:i?(0,n.jsxs)(ej.E,{children:[(0,n.jsx)("span",{children:"Enabled"}),(0,n.jsx)("span",{className:"hidden lg:inline-block",children:"\xa0for all tables"})]}):(0,n.jsx)(eY.A,{size:"tiny",align:"right",disabled:!d||m,className:"m-0 ml-2 mt-1 -mb-1 p-0",checked:o,onChange:()=>x(s,r)})})})]},s.id)},ta=e=>{let{selectedPublication:t,onSelectBack:s}=e,{project:r}=(0,g.Om)(),[l,c]=(0,y.useState)(""),d=(0,_.SE)(a.aG.TENANT_SQL_ADMIN_WRITE,"publications"),{data:u,isLoading:m,isSuccess:x,isError:h,error:p}=(0,X.LW)({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString},{select:e=>e.filter(e=>0===l.length?!k.i.includes(e.schema):!k.i.includes(e.schema)&&e.name.includes(l))});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mb-4",children:(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,n.jsx)(E.$,{type:"outline",onClick:()=>s(),icon:(0,n.jsx)(i.A,{}),style:{padding:"5px"},"data-sentry-element":"Button","data-sentry-source-file":"PublicationsTables.tsx"}),(0,n.jsx)("div",{children:(0,n.jsx)(R.A,{size:"small",placeholder:"Filter",value:l,onChange:e=>c(e.target.value),icon:(0,n.jsx)(o.A,{size:"14"}),"data-sentry-element":"Input","data-sentry-source-file":"PublicationsTables.tsx"})})]}),!d&&(0,n.jsx)("div",{className:"w-[500px]",children:(0,n.jsx)(e2.A,{icon:(0,n.jsx)(e0.A,{className:"text-foreground-light",strokeWidth:2}),title:"You need additional permissions to update database replications"})})]})}),m&&(0,n.jsx)("div",{className:"mt-8",children:(0,n.jsx)(ts.A,{})}),h&&(0,n.jsx)(N.A,{error:p,subject:"Failed to retrieve tables"}),x&&(0===u.length?(0,n.jsx)(v.A,{}):(0,n.jsx)("div",{children:(0,n.jsx)(b.A,{head:[(0,n.jsx)(b.A.th,{children:"Name"},"header-name"),(0,n.jsx)(b.A.th,{children:"Schema"},"header-schema"),(0,n.jsx)(b.A.th,{className:"hidden text-left lg:table-cell",children:"Description"},"header-desc"),(0,n.jsx)(b.A.th,{},"header-all")],body:u.map(e=>(0,n.jsx)(tn,{table:e,selectedPublication:t},e.id))})}))]})};var tr=s(53434),tl=s.n(tr),ti=s(49009),to=s(21889),tc=s(805);async function td(e){let{ref:t,backup:s}=e;if(s.isPhysicalBackup){let{data:e,error:n}=await (0,W.bE)("/platform/database/{ref}/backups/restore-physical",{params:{path:{ref:t}},body:{id:s.id,recovery_time_target:s.inserted_at}});if(n)throw n;return e}let{data:n,error:a}=await (0,W.bE)("/platform/database/{ref}/backups/restore",{params:{path:{ref:t}},body:{id:s.id}});return a&&(0,W.H4)(a),n}let tu=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return(0,eC.n)(e=>td(e),{async onSuccess(t,s,n){await (null==e?void 0:e(t,s,n))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to restore from backup: ".concat(e.message)):t(e,s,n)},...s})};var tm=s(58423),tx=s(84438),th=s(64036),tp=s(57953),tf=s(19362),ty=s(67408),tj=s(68557);let tg=e=>{let{index:t,isHealthy:s,backup:r,onSelectBackup:l}=e,{ref:i}=(0,j.g)(),o=(0,_.SE)(a.aG.INFRA_EXECUTE,"queue_job.restore.prepare"),{mutate:c,isLoading:d}=(0,ty.Z)({onSuccess:e=>{let{fileUrl:t}=e,s=document.createElement("a");s.href=t,document.body.appendChild(s),s.click(),document.body.removeChild(s)}});return(0,n.jsxs)("div",{className:"flex h-12 items-center justify-between px-6 ".concat(t?"border-t border-default":""),"data-sentry-component":"BackupItem","data-sentry-source-file":"BackupItem.tsx",children:[(0,n.jsxs)("div",{className:"flex items-center gap-x-2",children:[(0,n.jsx)(tj.T,{displayAs:"utc",utcTimestamp:r.inserted_at,labelFormat:"DD MMM YYYY HH:mm:ss (ZZ)",className:"text-left !text-sm font-mono tracking-tight","data-sentry-element":"TimestampInfo","data-sentry-source-file":"BackupItem.tsx"}),(0,n.jsxs)(L.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"BackupItem.tsx",children:[(0,n.jsx)(L.k$,{"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"BackupItem.tsx",children:(0,n.jsx)(ej.E,{variant:"default","data-sentry-element":"Badge","data-sentry-source-file":"BackupItem.tsx",children:r.isPhysicalBackup?"Physical":"Logical"})}),(0,n.jsxs)(L.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"BackupItem.tsx",children:["Learn more about backup types"," ",(0,n.jsx)(tf.g,{href:"https://supabase.com/blog/postgresql-physical-logical-backups","data-sentry-element":"InlineLink","data-sentry-source-file":"BackupItem.tsx",children:"here"})]})]})]}),(0,n.jsx)("div",{children:(e=>"COMPLETED"===e.status?(0,n.jsxs)("div",{className:"flex space-x-4",children:[(0,n.jsx)(w.G,{type:"default",disabled:!s||!o,onClick:l,tooltip:{content:{side:"bottom",text:s?o?void 0:"You need additional permissions to trigger a restore":"Cannot be restored as project is not active"}},children:"Restore"}),(0,n.jsx)(w.G,{type:"default",icon:(0,n.jsx)(tp.A,{}),loading:d,disabled:!o||d||e.isPhysicalBackup,onClick:()=>{if(!i)return console.error("Project ref is required");c({ref:i,backup:e})},tooltip:{content:{side:"bottom",className:e.isPhysicalBackup?"w-64":"",text:e.isPhysicalBackup?(0,n.jsxs)(n.Fragment,{children:["Physical backups cannot be downloaded through the dashboard. You can still download it via pgdump by following our guide"," ",(0,n.jsx)(tf.g,{href:"https://supabase.com/docs/guides/troubleshooting/download-logical-backups",children:"here"}),"."]}):o?void 0:"You need additional permissions to download backups"}},children:"Download"})]}):(0,n.jsx)(ej.E,{variant:"warning","data-sentry-element":"Badge","data-sentry-component":"generateSideButtons","data-sentry-source-file":"BackupItem.tsx",children:"Backup In Progress..."}))(r)})]})};var tv=s(36475),tb=s(86639);let tN=()=>{var e,t;let s=(0,O.useRouter)(),a=(0,eA.jE)(),{ref:r}=(0,j.g)(),{project:l}=(0,g.Om)(),i=(null==l?void 0:l.status)===th.BU.ACTIVE_HEALTHY,[o,c]=(0,y.useState)(),{data:d}=(0,tm.h)({projectRef:r}),{mutate:u,isLoading:m,isSuccess:x}=tu({onSuccess:()=>{r&&setTimeout(()=>{(0,tx.Mi)(a,r,th.BU.RESTORING),eb.oR.success("Restoring database back to ".concat(tl()(null==o?void 0:o.inserted_at).format("DD MMM YYYY HH:mm:ss"))),s.push("/project/".concat(r))},3e3)}}),h=null!=(e=null==d?void 0:d.tierKey)?e:"",p=(null!=(t=null==d?void 0:d.backups)?t:[]).sort((e,t)=>new Date(t.inserted_at).valueOf()-new Date(e.inserted_at).valueOf()),f=null==d?void 0:d.pitr_enabled;return"FREE"===h?(0,n.jsx)(tc.A,{addon:"pitr",icon:(0,n.jsx)(ti.A,{size:20}),primaryText:"Free Plan does not include project backups.",secondaryText:"Upgrade to the Pro Plan for up to 7 days of scheduled backups.",source:"backups"}):f?null:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"space-y-6",children:0===p.length&&"FREE"!==h?(0,n.jsx)(tv.A,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tb.A,{}),(0,n.jsx)(to.A,{children:null==p?void 0:p.map((e,t)=>(0,n.jsx)(tg,{backup:e,index:t,isHealthy:i,onSelectBackup:()=>c(e)},e.id))})]})}),(0,n.jsx)(e7.A,{size:"medium",confirmLabel:"Confirm restore",confirmLabelLoading:"Restoring",visible:void 0!==o,title:"Confirm to restore from backup",alert:{base:{variant:"warning"},title:"Your project will be offline while the restore is in progress",description:"It is advised to upgrade at a time when there will be minimal impact for your application."},loading:m||x,onCancel:()=>c(void 0),onConfirm:()=>void 0===r?console.error("Project ref required"):void 0===o?console.error("Backup required"):void u({ref:r,backup:o}),"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"BackupsList.tsx",children:(0,n.jsxs)("p",{className:"text-sm",children:["Are you sure you want to restore from"," ",tl()(null==o?void 0:o.inserted_at).format("DD MMM YYYY"),"? This will destroy any new data written since this backup was made."]})})]})};var tw=s(97344),tS=s.n(tw),tA=s(30075),tC=s.n(tA),t_=s(44217),tk=s.n(t_),tE=s(91962),tR=s(95059);async function tT(e){let{projectRef:t,connectionString:s,payload:n}=e,{sql:a,zod:r}=eS.A.functions.create(n),{result:l}=await (0,e_.E)({projectRef:t,connectionString:s,sql:a,queryKey:["functions","create"]});return l}let tL=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>tT(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(tR.c.databaseFunctions(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to create database function: ".concat(e.message)):t(e,s,n)},...s})};async function tz(e){let{projectRef:t,connectionString:s,func:n,payload:a}=e,{sql:r,zod:l}=eS.A.functions.update(n,a),{result:i}=await (0,e_.E)({projectRef:t,connectionString:s,sql:r,queryKey:["functions","update",n.id.toString()]});return i}let tI=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>tz(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(tR.c.databaseFunctions(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to update database function: ".concat(e.message)):t(e,s,n)},...s})};var tF=s(14943),tD=s(22979),tP=s(20894),tB=s(67585),tM=s(55476),tO=s(84377),tV=s(89262);let tq=e=>{let{selectedFunction:t,assistantVisible:s,setAssistantVisible:a}=e;return(0,n.jsx)(tF.Fm,{className:"py-3 flex flex-row justify-between items-center border-b-0","data-sentry-element":"SheetHeader","data-sentry-component":"CreateFunctionHeader","data-sentry-source-file":"CreateFunctionHeader.tsx",children:(0,n.jsxs)("div",{className:"flex flex-row gap-3 items-center max-w-[75%]",children:[(0,n.jsxs)(tF.kN,{className:(0,ei.cn)("text-muted hover:text ring-offset-background transition-opacity hover:opacity-100","focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","disabled:pointer-events-none data-[state=open]:bg-secondary","transition"),"data-sentry-element":"SheetClose","data-sentry-source-file":"CreateFunctionHeader.tsx",children:[(0,n.jsx)(u.A,{className:"h-3 w-3","data-sentry-element":"X","data-sentry-source-file":"CreateFunctionHeader.tsx"}),(0,n.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,n.jsx)(tF.qp,{className:"truncate","data-sentry-element":"SheetTitle","data-sentry-source-file":"CreateFunctionHeader.tsx",children:void 0!==t?"Edit '".concat(t,"' function"):"Add a new function"})]})})};var t$=s(41226),tY=s(52700),tW=s(94326);let tH=e=>{let{field:t,language:s,focused:a,setFocused:r}=e;return(0,n.jsxs)("div",{className:(0,ei.cn)("rounded-md relative group flex-grow"),"data-sentry-component":"FunctionEditor","data-sentry-source-file":"FunctionEditor.tsx",children:[(0,n.jsx)(eT.MJ,{"data-sentry-element":"FormControl_Shadcn_","data-sentry-source-file":"FunctionEditor.tsx",children:void 0!==s&&(0,n.jsx)(tW.A,{id:"database-functions-editor",language:"pgsql",placeholder:"plpgsql"===s?"BEGIN\n\nEND;":void 0,value:t.value,onInputChange:t.onChange})}),(0,n.jsx)("div",{className:(0,ei.cn)("absolute top-0 right-2 bg-surface-300 border border-strong rounded h-[28px]","opacity-0 group-hover:opacity-100 group-hover:top-2 transition-all"),children:(0,n.jsxs)(L.m_,{"data-sentry-element":"Tooltip","data-sentry-source-file":"FunctionEditor.tsx",children:[(0,n.jsx)(L.k$,{asChild:!0,"data-sentry-element":"TooltipTrigger","data-sentry-source-file":"FunctionEditor.tsx",children:(0,n.jsx)(E.$,{type:"text",size:"tiny",className:(0,ei.cn)("px-1.5 text-foreground-lighter hover:text-foreground","transition z-50"),onClick:()=>r(!a),icon:a?(0,n.jsx)(t$.A,{}):(0,n.jsx)(tY.A,{}),"data-sentry-element":"Button","data-sentry-source-file":"FunctionEditor.tsx"})}),(0,n.jsx)(L.ZI,{side:"bottom","data-sentry-element":"TooltipContent","data-sentry-source-file":"FunctionEditor.tsx",children:a?"Minimize editor":"Maximize editor"})]})})]})},tU="create-function-sidepanel",tJ=eN.Ay.object({name:eN.Ay.string().trim().min(1),schema:eN.Ay.string().trim().min(1),args:eN.Ay.array(eN.Ay.object({name:eN.Ay.string().trim().min(1),type:eN.Ay.string().trim()})),behavior:eN.Ay.enum(["IMMUTABLE","STABLE","VOLATILE"]),definition:eN.Ay.string().trim().min(1),language:eN.Ay.string().trim(),return_type:eN.Ay.string().trim(),security_definer:eN.Ay.boolean(),config_params:eN.Ay.array(eN.Ay.object({name:eN.Ay.string().trim().min(1),value:eN.Ay.string().trim().min(1)})).optional()}),tG=e=>{let{func:t,visible:s,setVisible:a}=e,{project:r}=(0,g.Om)(),[l,i]=(0,y.useState)(!1),[o,c]=(0,y.useState)(!1),[d,u]=(0,y.useState)(!1),[m,x]=(0,y.useState)(!1),h=!!(null==t?void 0:t.id),p=(0,ev.mN)({resolver:(0,eg.u)(tJ)}),f=p.watch("language"),{mutate:j,isLoading:v}=tL(),{mutate:b,isLoading:N}=tI();function w(){p.formState.isDirty?i(!0):a(!s)}let S=async e=>{if(!r)return console.error("Project is required");let n={...e,args:e.args.map(e=>"".concat(e.name," ").concat(e.type)),config_params:tk()(tC()(e.config_params,"name"),"value")};h?b({func:t,projectRef:r.ref,connectionString:r.connectionString,payload:n},{onSuccess:()=>{eb.oR.success("Successfully updated function ".concat(e.name)),a(!s)}}):j({projectRef:r.ref,connectionString:r.connectionString,payload:n},{onSuccess:()=>{eb.oR.success("Successfully created function ".concat(e.name)),a(!s)}})};return(0,y.useEffect)(()=>{if(s){var e,n,a,r,l,i,o;x(!1),p.reset({name:null!=(e=null==t?void 0:t.name)?e:"",schema:null!=(n=null==t?void 0:t.schema)?n:"public",args:(0,tV.GQ)((null==t?void 0:t.argument_types)||"").value,behavior:null!=(a=null==t?void 0:t.behavior)?a:"VOLATILE",definition:null!=(r=null==t?void 0:t.definition)?r:"",language:null!=(l=null==t?void 0:t.language)?l:"plpgsql",return_type:null!=(i=null==t?void 0:t.return_type)?i:"void",security_definer:null!=(o=null==t?void 0:t.security_definer)&&o,config_params:(0,tV.Il)(null==t?void 0:t.config_params).value})}},[s,t]),(0,n.jsx)(tF.cj,{open:s,onOpenChange:()=>w(),"data-sentry-element":"Sheet","data-sentry-component":"CreateFunction","data-sentry-source-file":"index.tsx",children:(0,n.jsxs)(tF.h,{showClose:!1,size:d?"lg":"default",className:(0,ei.cn)("p-0 flex flex-row gap-0",d?"!min-w-screen lg:!min-w-[1200px]":"!min-w-screen lg:!min-w-[600px]"),"data-sentry-element":"SheetContent","data-sentry-source-file":"index.tsx",children:[(0,n.jsxs)("div",{className:(0,ei.cn)("flex flex-col grow w-full",d&&"w-[60%]"),children:[(0,n.jsx)(tq,{selectedFunction:null==t?void 0:t.name,assistantVisible:d,setAssistantVisible:u,"data-sentry-element":"CreateFunctionHeader","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(tD.w,{"data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(eT.lV,{...p,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"index.tsx",children:(0,n.jsxs)("form",{id:tU,className:"flex-grow overflow-auto",onSubmit:p.handleSubmit(S),children:[(0,n.jsx)(tF.Xc,{className:m?"hidden":"","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,n.jsx)(eT.zB,{control:p.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsx)(tO.M,{label:"Name of function",description:"Name will also be used for the function name in postgres",layout:"horizontal",children:(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(eL.p,{...t})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"})}),(0,n.jsx)(tD.w,{className:m?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,n.jsxs)(tF.Xc,{className:m?"hidden":"space-y-4","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(eT.zB,{control:p.control,name:"schema",render:e=>{let{field:t}=e;return(0,n.jsx)(tO.M,{label:"Schema",description:"Tables made in the table editor will be in 'public'",layout:"horizontal",children:(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(V.A,{portal:!1,selectedSchemaName:t.value,excludedSchemas:k.i,size:"small",onSelectSchema:e=>t.onChange(e)})})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"}),!h&&(0,n.jsx)(eT.zB,{control:p.control,name:"return_type",render:e=>{let{field:t}=e;return(0,n.jsx)(tO.M,{label:"Return type",layout:"horizontal",children:(0,n.jsxs)(tP.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,n.jsx)(tP.bq,{className:"col-span-8",children:(0,n.jsx)(tP.yv,{})}),(0,n.jsx)(tP.gC,{children:(0,n.jsx)(tB.FK,{className:"h-52",children:["void","record","trigger","integer",...tE.x0].map(e=>(0,n.jsx)(tP.eb,{value:e,children:e},e))})})]})})}})]}),(0,n.jsx)(tD.w,{className:m?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(tF.Xc,{className:m?"hidden":"","data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,n.jsx)(tK,{readonly:h,"data-sentry-element":"FormFieldArgs","data-sentry-source-file":"index.tsx"})}),(0,n.jsx)(tD.w,{className:m?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),(0,n.jsx)(tF.Xc,{className:"".concat(m?"h-full":""," !px-0"),"data-sentry-element":"SheetSection","data-sentry-source-file":"index.tsx",children:(0,n.jsx)(eT.zB,{control:p.control,name:"definition",render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{className:"space-y-4 flex flex-col h-full",children:[(0,n.jsxs)("div",{className:"px-content",children:[(0,n.jsx)(eT.lR,{className:"text-base text-foreground",children:"Definition"}),(0,n.jsxs)(eT.Rr,{className:"text-sm text-foreground-light",children:[(0,n.jsxs)("p",{children:["The language below should be written in ",(0,n.jsx)("code",{children:f}),"."]}),!h&&(0,n.jsx)("p",{children:"Change the language in the Advanced Settings below."})]})]}),(0,n.jsx)("div",{className:(0,ei.cn)("border border-default flex",m?"flex-grow ":"h-72"),children:(0,n.jsx)(tH,{field:t,language:f,focused:m,setFocused:x})}),(0,n.jsx)(eT.C5,{className:"px-content"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"index.tsx"})}),(0,n.jsx)(tD.w,{className:m?"hidden":"","data-sentry-element":"Separator","data-sentry-source-file":"index.tsx"}),h?(0,n.jsx)(n.Fragment,{}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(tF.Xc,{className:m?"hidden":"",children:(0,n.jsx)("div",{className:"space-y-8 rounded bg-studio py-4 px-6 border border-overlay",children:(0,n.jsx)(eY.A,{onChange:()=>c(!o),label:"Show advanced settings",checked:o,labelOptional:"These are settings that might be familiar for Postgres developers"})})}),o&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(tF.Xc,{className:m?"hidden":"space-y-2 pt-0",children:[(0,n.jsx)(tX,{}),(0,n.jsx)(eT.zB,{control:p.control,name:"behavior",render:e=>{let{field:t}=e;return(0,n.jsx)(tO.M,{label:"Behavior",layout:"horizontal",children:(0,n.jsxs)(tP.l6,{defaultValue:t.value,onValueChange:t.onChange,children:[(0,n.jsx)(tP.bq,{className:"col-span-8",children:(0,n.jsx)(tP.yv,{})}),(0,n.jsxs)(tP.gC,{children:[(0,n.jsx)(tP.eb,{value:"IMMUTABLE",children:"immutable"},"IMMUTABLE"),(0,n.jsx)(tP.eb,{value:"STABLE",children:"stable"},"STABLE"),(0,n.jsx)(tP.eb,{value:"VOLATILE",children:"volatile"},"VOLATILE")]})]})})}})]}),(0,n.jsx)(tD.w,{className:m?"hidden":""}),(0,n.jsx)(tF.Xc,{className:m?"hidden":"",children:(0,n.jsx)(tQ,{readonly:h})}),(0,n.jsx)(tD.w,{className:m?"hidden":""}),(0,n.jsxs)(tF.Xc,{className:m?"hidden":"",children:[(0,n.jsx)("h5",{className:"text-base text-foreground mb-4",children:"Type of Security"}),(0,n.jsx)(eT.zB,{control:p.control,name:"security_definer",render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{children:[(0,n.jsx)(eT.MJ,{className:"col-span-8",children:(0,n.jsxs)(tM.A.Group,{type:"cards",layout:"vertical",onChange:e=>t.onChange("SECURITY_DEFINER"==e.target.value),value:t.value?"SECURITY_DEFINER":"SECURITY_INVOKER",children:[(0,n.jsx)(tM.A,{id:"SECURITY_INVOKER",label:"SECURITY INVOKER",value:"SECURITY_INVOKER",checked:!t.value,description:(0,n.jsxs)(n.Fragment,{children:["Function is to be executed with the privileges of the user that ",(0,n.jsx)("span",{className:"text-foreground",children:"calls it"}),"."]})}),(0,n.jsx)(tM.A,{id:"SECURITY_DEFINER",label:"SECURITY DEFINER",value:"SECURITY_DEFINER",checked:t.value,description:(0,n.jsxs)(n.Fragment,{children:["Function is to be executed with the privileges of the user that ",(0,n.jsx)("span",{className:"text-foreground",children:"created it"}),"."]})})]})}),(0,n.jsx)(eT.C5,{})]})}})]})]})]})]})}),(0,n.jsxs)(tF.XW,{"data-sentry-element":"SheetFooter","data-sentry-source-file":"index.tsx",children:[(0,n.jsx)(E.$,{disabled:v||N,type:"default",onClick:w,"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Cancel"}),(0,n.jsx)(E.$,{form:tU,htmlType:"submit",disabled:v||N,loading:v||N,"data-sentry-element":"Button","data-sentry-source-file":"index.tsx",children:"Confirm"})]})]}),d?(0,n.jsx)("div",{className:"border-l shadow-[rgba(0,0,0,0.13)_-4px_0px_6px_0px] z-10 w-[50%] bg-studio"}):null,(0,n.jsx)(e7.A,{visible:l,title:"Discard changes",confirmLabel:"Discard",onCancel:()=>i(!1),onConfirm:()=>{i(!1),a(!s)},"data-sentry-element":"ConfirmationModal","data-sentry-source-file":"index.tsx",children:(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"There are unsaved changes. Are you sure you want to close the panel? Your changes will be lost."})})]})})},tK=e=>{let{readonly:t}=e,{fields:s,append:a,remove:r}=(0,ev.jz)({name:"args"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex flex-col",children:[(0,n.jsx)("h5",{className:"text-base text-foreground",children:"Arguments"}),(0,n.jsx)("p",{className:"text-sm text-foreground-light",children:"Arguments can be referenced in the function body using either names or numbers."})]}),(0,n.jsxs)("div",{className:"space-y-2 pt-4",children:[t&&tS()(s)&&(0,n.jsx)("span",{className:"text-foreground-lighter",children:"No argument for this function"}),s.map((e,s)=>(0,n.jsxs)("div",{className:"flex flex-row space-x-1",children:[(0,n.jsx)(eT.zB,{name:"args.".concat(s,".name"),render:e=>{let{field:s}=e;return(0,n.jsxs)(eT.eI,{className:"flex-1",children:[(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(eL.p,{...s,disabled:t,placeholder:"argument_name"})}),(0,n.jsx)(eT.C5,{})]})}}),(0,n.jsx)(eT.zB,{name:"args.".concat(s,".type"),render:e=>{let{field:s}=e;return(0,n.jsxs)(eT.eI,{className:"flex-1",children:[(0,n.jsx)(eT.MJ,{children:t?(0,n.jsx)(eL.p,{value:s.value,disabled:!0,readOnly:!0,className:"h-auto"}):(0,n.jsx)(n.Fragment,{children:(0,n.jsxs)(tP.l6,{disabled:t,onValueChange:s.onChange,defaultValue:s.value,children:[(0,n.jsx)(tP.bq,{className:"h-[38px]",children:(0,n.jsx)(tP.yv,{})}),(0,n.jsx)(tP.gC,{children:(0,n.jsx)(tB.FK,{className:"h-52",children:["integer",...tE.x0].map(e=>(0,n.jsx)(tP.eb,{value:e,children:e},e))})})]})})}),(0,n.jsx)(eT.C5,{})]})}}),!t&&(0,n.jsx)(E.$,{type:"danger",icon:(0,n.jsx)(h.A,{size:12}),onClick:()=>r(s),className:"h-[38px] w-[38px]"})]},e.id)),!t&&(0,n.jsx)(E.$,{type:"default",icon:(0,n.jsx)(c.A,{size:12}),onClick:()=>a({name:"",type:"integer"}),disabled:t,children:"Add a new argument"})]})]})},tQ=e=>{let{readonly:t}=e,{fields:s,append:a,remove:r}=(0,ev.jz)({name:"config_params"});return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h5",{className:"text-base text-foreground",children:"Configuration Parameters"}),(0,n.jsxs)("div",{className:"space-y-2 pt-4",children:[t&&tS()(s)&&(0,n.jsx)("span",{className:"text-foreground-lighter",children:"No argument for this function"}),s.map((e,s)=>(0,n.jsxs)("div",{className:"flex flex-row space-x-1",children:[(0,n.jsx)(eT.zB,{name:"config_params.".concat(s,".name"),render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{className:"flex-1",children:[(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(eL.p,{...t,placeholder:"parameter_name"})}),(0,n.jsx)(eT.C5,{})]})}}),(0,n.jsx)(eT.zB,{name:"config_params.".concat(s,".value"),render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{className:"flex-1",children:[(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(eL.p,{...t,placeholder:"parameter_value"})}),(0,n.jsx)(eT.C5,{})]})}}),!t&&(0,n.jsx)(E.$,{type:"danger",icon:(0,n.jsx)(h.A,{size:12}),onClick:()=>r(s),className:"h-[38px] w-[38px]"})]},e.id)),!t&&(0,n.jsx)(E.$,{type:"default",icon:(0,n.jsx)(c.A,{size:12}),onClick:()=>a({name:"",type:""}),disabled:t,children:"Add a new config"})]})]})},tZ=["plpgsql","sql","plcoffee","plv8","plls"],tX=()=>{let{project:e}=(0,g.Om)(),{data:t}=(0,e4.z)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString},{select:e=>eu()(e,e=>!eX()(e.installed_version))[0]}),s=(0,y.useMemo)(()=>tZ.filter(e=>!e.startsWith("pl")||(null==t?void 0:t.find(t=>t.name===e))!==void 0),[t]);return(0,n.jsx)(eT.zB,{name:"language",render:e=>{let{field:t}=e;return(0,n.jsx)(tO.M,{label:"Language",layout:"horizontal",children:(0,n.jsxs)(tP.l6,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,n.jsx)(tP.bq,{className:"col-span-8",children:(0,n.jsx)(tP.yv,{})}),(0,n.jsx)(tP.gC,{children:s.map(e=>(0,n.jsx)(tP.eb,{value:e,children:e},e))})]})})},"data-sentry-element":"FormField_Shadcn_","data-sentry-component":"FormFieldLanguage","data-sentry-source-file":"index.tsx"})};async function t0(e){let{projectRef:t,connectionString:s,func:n}=e,{sql:a,zod:r}=eS.A.functions.remove(n),{result:l}=await (0,e_.E)({projectRef:t,connectionString:s,sql:a,queryKey:["functions","delete",n.id.toString()]});return l}let t1=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>t0(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(tR.c.databaseFunctions(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to delete database function: ".concat(e.message)):t(e,s,n)},...s})};var t2=s(87304);let t4=e=>{let{func:t,visible:s,setVisible:a}=e,{project:r}=(0,g.Om)(),{name:l,schema:i}=null!=t?t:{},{mutate:o,isLoading:c}=t1({onSuccess:()=>{eb.oR.success("Successfully removed function ".concat(l)),a(!1)}});async function d(){return t?r?void o({func:t,projectRef:r.ref,connectionString:r.connectionString}):console.error("Project is required"):console.error("Function is required")}return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(t2.A,{variant:"warning",visible:s,onCancel:()=>a(!s),onConfirm:d,title:"Delete this function",loading:c,confirmLabel:"Delete function ".concat(l),confirmPlaceholder:"Type in name of function",confirmString:null!=l?l:"Unknown",text:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{children:"This will delete the function"})," ",(0,n.jsx)("span",{className:"text-bold text-foreground",children:l})," ",(0,n.jsx)("span",{children:"from the schema"})," ",(0,n.jsx)("span",{className:"text-bold text-foreground",children:i})]}),alert:{title:"You cannot recover this function once deleted."},"data-sentry-element":"TextConfirmModal","data-sentry-source-file":"DeleteFunction.tsx"})})};var t5=s(788),t3=s(65645),t6=s(68889),t8=s(70324),t7=s(23148),t9=s(68966);async function se(e){let{projectRef:t,connectionString:s,schema:n,name:a,description:r,values:l}=e,i='create type "'.concat(n,'"."').concat(a,'" as enum (').concat(l.map(e=>"'".concat(e,"'")).join(", "),");"),o=void 0!==r?'comment on type "'.concat(n,'"."').concat(a,"\" is '").concat(r,"';"):"",c=(0,t7.d)("".concat(i," ").concat(o)),{result:d}=await (0,e_.E)({projectRef:t,connectionString:s,sql:c});return d}let st=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>se(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(t9.K.list(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to create enumerated type: ".concat(e.message)):t(e,s,n)},...s})};var ss=s(43290);let sn=e=>{let{index:t,id:s,field:a,isDisabled:r=!1,onRemoveValue:l}=e;return(0,n.jsx)(t6.sx,{draggableId:s,index:t,isDragDisabled:r,"data-sentry-element":"Draggable","data-sentry-component":"EnumeratedTypeValueRow","data-sentry-source-file":"EnumeratedTypeValueRow.tsx",children:e=>(0,n.jsxs)("div",{ref:e.innerRef,...e.draggableProps,className:"flex items-center space-x-2 space-y-2",children:[(0,n.jsx)("div",{...e.dragHandleProps,className:"opacity-50 hover:opacity-100 transition ".concat(r?"text-foreground-lighter !cursor-default":"text-foreground"),children:(0,n.jsx)(ss.A,{size:16,strokeWidth:1.5})}),(0,n.jsx)(eL.p,{...a,className:"w-full"}),(0,n.jsx)(E.$,{type:"default",size:"small",disabled:r,icon:(0,n.jsx)(h.A,{strokeWidth:1.5,size:16}),className:"px-2",onClick:()=>l()})]})})},sa=[...tE.N1,...tE.AL,...tE.J_,...tE.aw,...tE.mL,...tE.J5,...tE.wB,"bigint","bigserial","bit","bit varying","boolean","box","bytea","char","character","character varying","cidr","circle","date","double precision","inet","int","integer","interval","line","lseg","macaddr","macaddr8","money","numeric","decimal","path","pg_lsn","pg_snapshot","point","polygon","real","smallint","smallserial","serial","time with timezone","timestamp with timezone","tsquery","tsvector","txid_snapshot","xml"];var sr=s(77877);let sl=e=>{let{visible:t,onClose:s,schema:a}=e,r={name:"",description:"",values:[{value:""}]},l=(0,y.useRef)(null),{project:i}=(0,g.Om)(),{mutate:o,isLoading:d}=st({onSuccess:(e,t)=>{eb.oR.success('Successfully created type "'.concat(t.name,'"')),b()}});(0,y.useEffect)(()=>{m.reset(r)},[t]);let u=eN.Ik({name:eN.Yj().min(1,"Please provide a name for your enumerated type").refine(e=>!sa.includes(e),{message:"Name cannot be a native Postgres data type"}).default(""),description:eN.Yj().default("").optional(),values:eN.Ik({value:eN.Yj().min(1,"Please provide a value")}).array().default([])}),m=(0,ev.mN)({resolver:(0,eg.u)(u),defaultValues:r}),{fields:x,append:h,remove:p,move:j}=(0,ev.jz)({name:"values",control:m.control}),v=e=>{e.destination&&j(e.source.index,e.destination.index)},b=()=>{m.reset(r),s()};return(0,n.jsx)(eR.Ay,{loading:d,visible:t,onCancel:b,header:"Create a new enumerated type",confirmText:"Create type",onConfirm:()=>{l.current&&l.current.click()},"data-sentry-element":"SidePanel","data-sentry-component":"CreateEnumeratedTypeSidePanel","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(eR.Ay.Content,{className:"py-4","data-sentry-element":"unknown","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(eT.lV,{...m,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:(0,n.jsxs)("form",{className:"space-y-4",onSubmit:m.handleSubmit(e=>{var t;return(null==i?void 0:i.ref)===void 0?console.error("Project ref required"):(null==i?void 0:i.connectionString)===void 0?console.error("Project connectionString required"):void o({projectRef:i.ref,connectionString:i.connectionString,schema:a,name:e.name,description:null==(t=e.description)?void 0:t.replaceAll("'","''"),values:e.values.filter(e=>e.value.length>0).map(e=>e.value.trim())})}),children:[(0,n.jsx)(eT.zB,{control:m.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{children:[(0,n.jsx)(eT.lR,{children:"Name"}),(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(eL.p,{...t})}),(0,n.jsx)(eT.C5,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx"}),(0,n.jsx)(eT.zB,{control:m.control,name:"description",render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{children:[(0,n.jsx)(eT.lR,{children:"Description"}),(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(eL.p,{...t})}),(0,n.jsx)(eT.Rr,{children:"Optional"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx"}),(0,n.jsx)(t6.JY,{onDragEnd:e=>v(e),"data-sentry-element":"DragDropContext","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(t6.gL,{droppableId:"enum_type_values_droppable","data-sentry-element":"Droppable","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:e=>(0,n.jsxs)("div",{ref:e.innerRef,children:[x.map((e,t)=>(0,n.jsx)(eT.zB,{control:m.control,name:"values.".concat(t,".value"),render:s=>{let{field:a}=s;return(0,n.jsxs)(eT.eI,{children:[(0,n.jsx)(eT.lR,{className:(0,ei.cn)(0!==t&&"sr-only"),children:"Values"}),0===t&&(0,n.jsxs)(t8.Fc,{children:[(0,n.jsx)(e0.A,{strokeWidth:1.5}),(0,n.jsx)(t8.XL,{children:"After creation, values cannot be deleted or sorted"}),(0,n.jsxs)(t8.TN,{children:[(0,n.jsx)("p",{className:"!leading-normal track",children:"You will need to delete and recreate the enumerated type with the updated values instead."}),(0,n.jsx)(E.$,{asChild:!0,type:"default",icon:(0,n.jsx)(sr.A,{strokeWidth:1.5}),className:"mt-2",children:(0,n.jsx)(f(),{href:"https://www.postgresql.org/message-id/21012.1459434338%40sss.pgh.pa.us",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]}),(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(sn,{index:t,id:e.id,field:a,isDisabled:x.length<2,onRemoveValue:()=>p(t)})}),(0,n.jsx)(eT.C5,{className:"ml-6"})]})}},e.id)),e.placeholder]})})}),(0,n.jsx)(E.$,{type:"default",icon:(0,n.jsx)(c.A,{strokeWidth:1.5}),onClick:()=>h({value:""}),"data-sentry-element":"Button","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:"Add value"}),(0,n.jsx)(E.$,{ref:l,htmlType:"submit",type:"default",className:"hidden","data-sentry-element":"Button","data-sentry-source-file":"CreateEnumeratedTypeSidePanel.tsx",children:"Update"})]})})})})};async function si(e){let{projectRef:t,connectionString:s,name:n,schema:a}=e,r="drop type if exists ".concat(a,'."').concat(n,'"'),{result:l}=await (0,e_.E)({projectRef:t,connectionString:s,sql:r});return l}let so=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>si(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(t9.K.list(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to create enumerated type: ".concat(e.message)):t(e,s,n)},...s})},sc=e=>{let{visible:t,selectedEnumeratedType:s,onClose:a}=e,{project:r}=(0,g.Om)(),{mutate:l,isLoading:i}=so({onSuccess:()=>{eb.oR.success('Successfully deleted "'.concat(s.name,'"')),a()}}),o=()=>void 0===s?console.error("No enumerated type selected"):(null==r?void 0:r.ref)===void 0?console.error("Project ref required"):(null==r?void 0:r.connectionString)===void 0?console.error("Project connectionString required"):void l({projectRef:null==r?void 0:r.ref,connectionString:null==r?void 0:r.connectionString,name:s.name,schema:s.schema});return(0,n.jsxs)(e7.A,{variant:"destructive",size:"medium",loading:i,visible:t,title:(0,n.jsxs)(n.Fragment,{children:["Confirm to delete enumerated type"," ",(0,n.jsx)("code",{className:"text-sm",children:null==s?void 0:s.name})]}),confirmLabel:"Confirm delete",confirmLabelLoading:"Deleting...",onCancel:a,onConfirm:()=>o(),alert:{title:"This action cannot be undone",description:"You will need to re-create the enumerated type if you want to revert the deletion."},"data-sentry-element":"ConfirmationModal","data-sentry-component":"DeleteEnumeratedTypeModal","data-sentry-source-file":"DeleteEnumeratedTypeModal.tsx",children:[(0,n.jsx)("p",{className:"text-sm",children:"Before deleting this enumerated type, consider:"}),(0,n.jsx)("ul",{className:"space-y-2 mt-2 text-sm text-foreground-light",children:(0,n.jsx)("li",{className:"list-disc ml-6",children:"This enumerated type is no longer in use in any tables or functions"})})]})};async function sd(e){let{projectRef:t,connectionString:s,schema:n,name:a,description:r,values:l=[]}=e,i=[];a.original!==a.updated&&i.push('alter type "'.concat(n,'"."').concat(a.original,'" rename to "').concat(a.updated,'";')),l.length>0&&l.forEach((e,t)=>{if(e.isNew)if(0===t){let t=l.find(e=>!e.isNew);i.push('alter type "'.concat(n,'"."').concat(a.updated,"\" add value '").concat(e.updated,"' before '").concat(null==t?void 0:t.original,"';"))}else i.push('alter type "'.concat(n,'"."').concat(a.updated,"\" add value '").concat(e.updated,"' after '").concat(l[t-1].updated,"';"));else e.original!==e.updated&&i.push('alter type "'.concat(n,'"."').concat(a.updated,"\" rename value '").concat(e.original,"' to '").concat(e.updated,"';"))}),void 0!==r&&i.push('comment on type "'.concat(n,'"."').concat(a.updated,"\" is '").concat(r,"';"));let o=(0,t7.d)(i.join(" ")),{result:c}=await (0,e_.E)({projectRef:t,connectionString:s,sql:o});return c}let su=function(){let{onSuccess:e,onError:t,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=(0,eA.jE)();return(0,eC.n)(e=>sd(e),{async onSuccess(t,s,a){let{projectRef:r}=s;await n.invalidateQueries(t9.K.list(r)),await (null==e?void 0:e(t,s,a))},async onError(e,s,n){void 0===t?eb.oR.error("Failed to add value to enumerated type: ".concat(e.message)):t(e,s,n)},...s})},sm=e=>{var t;let{visible:s,selectedEnumeratedType:a,onClose:r}=e,l=(0,y.useRef)(null),{project:i}=(0,g.Om)(),{mutate:o,isLoading:d}=su({onSuccess:(e,t)=>{eb.oR.success('Successfully updated type "'.concat(t.name.updated,'"')),r()}}),u=eN.Ik({name:eN.Yj().min(1,"Please provide a name for your enumerated type").default(""),description:eN.Yj().default("").optional(),values:eN.Ik({isNew:eN.zM(),originalValue:eN.Yj(),updatedValue:eN.Yj().min(1,"Please provide a value")}).array().default([])}),m=(0,ev.mN)({resolver:(0,eg.u)(u),defaultValues:{name:"",description:"",values:[{isNew:!0,originalValue:"",updatedValue:""}]}}),{fields:x,append:h,remove:p,move:j}=(0,ev.jz)({name:"values",control:m.control}),v=e=>{e.destination&&j(e.source.index,e.destination.index)},b=(null!=(t=null==a?void 0:a.enums)?t:[]).map(e=>({isNew:!1,originalValue:e,updatedValue:e}));return(0,y.useEffect)(()=>{if(void 0!==a){var e;m.reset({name:a.name,description:null!=(e=a.comment)?e:"",values:b})}void 0==a&&m.reset({values:b})},[a]),(0,n.jsx)(eR.Ay,{loading:d,visible:s,onCancel:r,header:'Update type "'.concat(null==a?void 0:a.name,'"'),confirmText:"Update type",onConfirm:()=>{l.current&&l.current.click()},"data-sentry-element":"SidePanel","data-sentry-component":"EditEnumeratedTypeSidePanel","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(eR.Ay.Content,{className:"py-4","data-sentry-element":"unknown","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(eT.lV,{...m,"data-sentry-element":"Form_Shadcn_","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:(0,n.jsxs)("form",{className:"space-y-4",onSubmit:m.handleSubmit(e=>{var t;if((null==i?void 0:i.ref)===void 0)return console.error("Project ref required");if((null==i?void 0:i.connectionString)===void 0)return console.error("Project connectionString required");if(void 0===a)return console.error("selectedEnumeratedType required");let s={schema:a.schema,name:{original:a.name,updated:e.name},values:e.values.filter(e=>0!==e.updatedValue.length).map(e=>({original:e.originalValue,updated:e.updatedValue.trim(),isNew:e.isNew})),...e.description!==a.comment?{description:null==(t=e.description)?void 0:t.replaceAll("'","''")}:{}};o({projectRef:i.ref,connectionString:i.connectionString,...s})}),children:[(0,n.jsx)(eT.zB,{control:m.control,name:"name",render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{children:[(0,n.jsx)(eT.lR,{children:"Name"}),(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(eL.p,{...t})}),(0,n.jsx)(eT.C5,{})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx"}),(0,n.jsx)(eT.zB,{control:m.control,name:"description",render:e=>{let{field:t}=e;return(0,n.jsxs)(eT.eI,{children:[(0,n.jsx)(eT.lR,{children:"Description"}),(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(eL.p,{...t})}),(0,n.jsx)(eT.Rr,{children:"Optional"})]})},"data-sentry-element":"FormField_Shadcn_","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx"}),(0,n.jsx)(t6.JY,{onDragEnd:e=>v(e),"data-sentry-element":"DragDropContext","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:(0,n.jsx)(t6.gL,{droppableId:"enum_type_values_droppable","data-sentry-element":"Droppable","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:e=>(0,n.jsxs)("div",{ref:e.innerRef,children:[x.map((e,t)=>(0,n.jsx)(eT.zB,{control:m.control,name:"values.".concat(t,".updatedValue"),render:s=>{let{field:a}=s;return(0,n.jsxs)(eT.eI,{children:[(0,n.jsx)(eT.lR,{className:(0,ei.cn)(0!==t&&"sr-only"),children:"Values"}),0===t&&(0,n.jsxs)(t8.Fc,{children:[(0,n.jsx)(e0.A,{strokeWidth:1.5}),(0,n.jsx)(t8.XL,{children:"Existing values cannot be deleted or sorted"}),(0,n.jsxs)(t8.TN,{children:[(0,n.jsx)("p",{className:"!leading-normal track",children:"You will need to delete and recreate the enumerated type with the updated values instead."}),(0,n.jsx)(E.$,{asChild:!0,type:"default",icon:(0,n.jsx)(sr.A,{strokeWidth:1.5}),className:"mt-2",children:(0,n.jsx)(f(),{href:"https://www.postgresql.org/message-id/21012.1459434338%40sss.pgh.pa.us",target:"_blank",rel:"noreferrer",children:"Learn more"})})]})]}),(0,n.jsx)(eT.MJ,{children:(0,n.jsx)(sn,{index:t,id:e.id,field:a,isDisabled:!e.isNew,onRemoveValue:()=>p(t)})}),(0,n.jsx)(eT.C5,{className:"ml-6"})]})}},e.id)),e.placeholder]})})}),(0,n.jsx)(E.$,{type:"default",icon:(0,n.jsx)(c.A,{strokeWidth:1.5}),onClick:()=>h({isNew:!0,originalValue:"",updatedValue:""}),"data-sentry-element":"Button","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:"Add value"}),(0,n.jsx)(E.$,{ref:l,htmlType:"submit",type:"default",className:"hidden","data-sentry-element":"Button","data-sentry-source-file":"EditEnumeratedTypeSidePanel.tsx",children:"Update"})]})})})})},sx=()=>{let{project:e}=(0,g.Om)(),[t,s]=(0,y.useState)(""),{selectedSchema:a,setSelectedSchema:r}=(0,en.k)(),[l,i]=(0,y.useState)(!1),[c,d]=(0,y.useState)(),[u,p]=(0,y.useState)(),{data:f}=(0,t5.w$)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),{data:j,error:v,isLoading:w,isError:A,isSuccess:C}=(0,t3.p)({projectRef:null==e?void 0:e.ref,connectionString:null==e?void 0:e.connectionString}),_=(null!=j?j:[]).filter(e=>e.enums.length>0),L=t.length>0?_.filter(e=>e.schema===a&&e.name.toLowerCase().includes(t.toLowerCase())):_.filter(e=>e.schema===a),I=(null!=f?f:[]).filter(e=>{var t;return k.i.includes(null!=(t=null==e?void 0:e.name)?t:"")}),F=null==f?void 0:f.find(e=>e.name===a),D=I.some(e=>e.id===(null==F?void 0:F.id));return(0,n.jsxs)("div",{className:"space-y-4","data-sentry-component":"EnumeratedTypes","data-sentry-source-file":"EnumeratedTypes.tsx",children:[(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-2",children:[(0,n.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center gap-2",children:[(0,n.jsx)(V.A,{className:"w-full lg:w-[180px]",size:"tiny",showError:!1,selectedSchemaName:a,onSelectSchema:r,"data-sentry-element":"SchemaSelector","data-sentry-source-file":"EnumeratedTypes.tsx"}),(0,n.jsx)(R.A,{size:"tiny",value:t,className:"w-full lg:w-52",onChange:e=>s(e.target.value),placeholder:"Search for a type",icon:(0,n.jsx)(o.A,{size:14}),"data-sentry-element":"Input","data-sentry-source-file":"EnumeratedTypes.tsx"})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)(e1.A,{href:"https://www.postgresql.org/docs/current/datatype-enum.html","data-sentry-element":"DocsButton","data-sentry-source-file":"EnumeratedTypes.tsx"}),!D&&(0,n.jsx)(E.$,{className:"ml-auto flex-1",type:"primary",onClick:()=>i(!0),children:"Create type"})]})]}),D&&(0,n.jsx)(z.A,{schema:a,entity:"enumerated types"}),w&&(0,n.jsx)(S.y,{}),A&&(0,n.jsx)(N.A,{error:v,subject:"Failed to retrieve database enumerated types"}),C&&(0,n.jsx)(b.A,{head:[(0,n.jsx)(b.A.th,{children:"Schema"},"schema"),(0,n.jsx)(b.A.th,{children:"Name"},"name"),(0,n.jsx)(b.A.th,{children:"Values"},"values"),(0,n.jsx)(b.A.th,{},"actions")],body:(0,n.jsxs)(n.Fragment,{children:[0===L.length&&0===t.length&&(0,n.jsx)(b.A.tr,{children:(0,n.jsxs)(b.A.td,{colSpan:4,children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No enumerated types created yet"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['There are no enumerated types found in the schema "',a,'"']})]})}),0===L.length&&t.length>0&&(0,n.jsx)(b.A.tr,{children:(0,n.jsxs)(b.A.td,{colSpan:4,children:[(0,n.jsx)("p",{className:"text-sm text-foreground",children:"No results found"}),(0,n.jsxs)("p",{className:"text-sm text-foreground-light",children:['Your search for "',t,'" did not return any results']})]})}),L.length>0&&L.map(e=>(0,n.jsxs)(b.A.tr,{children:[(0,n.jsx)(b.A.td,{className:"w-20",children:(0,n.jsx)("p",{className:"w-20 truncate",children:e.schema})}),(0,n.jsx)(b.A.td,{children:e.name}),(0,n.jsx)(b.A.td,{children:e.enums.join(", ")}),(0,n.jsx)(b.A.td,{children:!D&&(0,n.jsx)("div",{className:"flex justify-end items-center space-x-2",children:(0,n.jsxs)(T.rI,{children:[(0,n.jsx)(T.ty,{asChild:!0,children:(0,n.jsx)(E.$,{type:"default",className:"px-1",icon:(0,n.jsx)(m.A,{})})}),(0,n.jsxs)(T.SQ,{side:"bottom",align:"end",className:"w-32",children:[(0,n.jsxs)(T._2,{className:"space-x-2",onClick:()=>d(e),children:[(0,n.jsx)(x.A,{size:14}),(0,n.jsx)("p",{children:"Update type"})]}),(0,n.jsxs)(T._2,{className:"space-x-2",onClick:()=>p(e),children:[(0,n.jsx)(h.A,{size:14}),(0,n.jsx)("p",{children:"Delete type"})]})]})]})})})]},e.id))]})}),(0,n.jsx)(sl,{visible:l,onClose:()=>i(!1),schema:a,"data-sentry-element":"CreateEnumeratedTypeSidePanel","data-sentry-source-file":"EnumeratedTypes.tsx"}),(0,n.jsx)(sm,{visible:void 0!==c,selectedEnumeratedType:c,onClose:()=>d(void 0),"data-sentry-element":"EditEnumeratedTypeSidePanel","data-sentry-source-file":"EnumeratedTypes.tsx"}),(0,n.jsx)(sc,{visible:void 0!==u,selectedEnumeratedType:u,onClose:()=>p(void 0),"data-sentry-element":"DeleteEnumeratedTypeModal","data-sentry-source-file":"EnumeratedTypes.tsx"})]})}},96485:(e,t,s)=>{"use strict";s.d(t,{tV:()=>d,_X:()=>c});var n=s(45874),a=s(56947),r=s(96557);let l={databaseRoles:e=>["projects",e,"database-roles"]},i=n.A.roles.list();async function o(e,t){let{projectRef:s,connectionString:n}=e,{result:a}=await (0,r.E)({projectRef:s,connectionString:n,sql:i.sql,queryKey:["database-roles"]},t);return a}let c=function(e){let{projectRef:t,connectionString:s}=e,{enabled:n=!0,...r}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return(0,a.I)(l.databaseRoles(t),e=>{let{signal:n}=e;return o({projectRef:t,connectionString:s},n)},{enabled:n&&void 0!==t,...r})};function d(e,t){return e.invalidateQueries(l.databaseRoles(t))}}}]);